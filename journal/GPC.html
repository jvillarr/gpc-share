<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>GPC - Cloudforms</title><link rel="stylesheet" href="./docbook-xsl.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.75.2" /></head><body><div xml:lang="en" class="book" title="GPC - Cloudforms" lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="idm5634560"></a>GPC - Cloudforms</h1></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="3"><b>Revision History</b></th></tr><tr><td align="left">Revision 1.0</td><td align="left">September  2014</td><td align="left">James Villarreal</td></tr><tr><td align="left" colspan="3">
      Adding formatting
    </td></tr></table></div></div></div><hr /></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#_document_information">1. Document Information</a></span></dt><dd><dl><dt><span class="section"><a href="#_originator">1.1. Originator</a></span></dt><dt><span class="section"><a href="#_owner">1.2. Owner</a></span></dt><dt><span class="section"><a href="#_copyright">1.3. Copyright</a></span></dt><dt><span class="section"><a href="#_distribution">1.4. Distribution</a></span></dt><dt><span class="section"><a href="#_confidentiality">1.5. Confidentiality</a></span></dt><dt><span class="section"><a href="#_additional_copies">1.6. Additional copies</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_project_approach">2. Project Approach</a></span></dt><dd><dl><dt><span class="section"><a href="#_objectives">2.1. Objectives</a></span></dt><dd><dl><dt><span class="section"><a href="#_project_scope">2.1.1. Project Scope:</a></span></dt><dt><span class="section"><a href="#_proposed_schedule">2.1.2. Proposed Schedule</a></span></dt></dl></dd><dt><span class="section"><a href="#_logistics">2.2. Logistics</a></span></dt><dt><span class="section"><a href="#_contact_information">2.3. Contact Information</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_cloudforms_poc">3. Cloudforms POC</a></span></dt><dd><dl><dt><span class="section"><a href="#_architecture">3.1. Architecture</a></span></dt><dt><span class="section"><a href="#_cloudforms_appliance_allocations">3.2. Cloudforms Appliance Allocations</a></span></dt><dd><dl><dt><span class="section"><a href="#_cfme_appliance_system_requirements">3.2.1. CFME Appliance System Requirements</a></span></dt></dl></dd><dt><span class="section"><a href="#_cfme_appliance_setup">3.3. CFME Appliance Setup</a></span></dt><dd><dl><dt><span class="section"><a href="#_initial_setup">3.3.1. Initial Setup</a></span></dt><dt><span class="section"><a href="#_network_configuration">3.3.2. Network Configuration</a></span></dt><dt><span class="section"><a href="#_hostname_configuration">3.3.3. Hostname Configuration</a></span></dt><dt><span class="section"><a href="#_database_configuration">3.3.4. Database Configuration</a></span></dt></dl></dd><dt><span class="section"><a href="#_smtp_configuration">3.4. SMTP Configuration</a></span></dt><dt><span class="section"><a href="#_database_backups">3.5. Database Backups</a></span></dt><dt><span class="section"><a href="#_access_url">3.6. Access URL</a></span></dt><dt><span class="section"><a href="#_vmware_service_account">3.7. VMware Service Account</a></span></dt><dt><span class="section"><a href="#_install_vmware_vddk">3.8. Install VMware VDDK</a></span></dt><dt><span class="section"><a href="#_associate_cloudforms_appliance_as_a_vm_within_vcenter_provider">3.9. Associate Cloudforms Appliance as a VM within vCenter Provider</a></span></dt><dt><span class="section"><a href="#_configure_ntp_server">3.10. Configure NTP Server</a></span></dt><dt><span class="section"><a href="#_configure_outgoing_e_mail_settings">3.11. Configure outgoing E-mail settings</a></span></dt><dt><span class="section"><a href="#_register_appliance">3.12. Register Appliance</a></span></dt><dd><dl><dt><span class="section"><a href="#_editing_customer_information">3.12.1. Editing Customer Information</a></span></dt></dl></dd><dt><span class="section"><a href="#_ad_integration">3.13. AD Integration</a></span></dt><dd><dl><dt><span class="section"><a href="#_go_to_the_ldap_configuration_page">3.13.1. Go to the LDAP Configuration Page:</a></span></dt><dt><span class="section"><a href="#_fill_out_the_ldap_settings">3.13.2. Fill out the LDAP Settings</a></span></dt></dl></dd><dt><span class="section"><a href="#_add_openstack_provider">3.14. Add Openstack Provider</a></span></dt><dt><span class="section"><a href="#_add_vmware_provider">3.15. Add VMware Provider</a></span></dt><dd><dl><dt><span class="section"><a href="#_infoblox_automate_overview">3.15.1. Infoblox Automate Overview</a></span></dt><dt><span class="section"><a href="#_methods">3.15.2. Methods:</a></span></dt><dt><span class="section"><a href="#_policies_yaml">3.15.3. Policies.yaml</a></span></dt><dt><span class="section"><a href="#_profiles_yaml">3.15.4. Profiles.yaml</a></span></dt><dt><span class="section"><a href="#_alerts_yaml">3.15.5. Alerts.yaml</a></span></dt></dl></dd><dt><span class="section"><a href="#_database_backup_procedure">3.16. Database Backup Procedure</a></span></dt><dd><dl><dt><span class="section"><a href="#_web_ui_single_run_database_backup">3.16.1. Web UI: Single Run Database Backup</a></span></dt><dt><span class="section"><a href="#_web_ui_scheduled_database_backup">3.16.2. Web UI: Scheduled Database Backup</a></span></dt><dt><span class="section"><a href="#_ssh_manual_database_backup">3.16.3. SSH: Manual Database Backup</a></span></dt></dl></dd><dt><span class="section"><a href="#_member_groups">3.17. Member Groups</a></span></dt><dd><dl><dt><span class="section"><a href="#_creating_importing_group_from_ldap_active_directory">3.17.1. Creating/Importing Group from LDAP/Active Directory</a></span></dt><dt><span class="section"><a href="#_adding_smart_management_tag_to_group">3.17.2. Adding Smart Management Tag to Group</a></span></dt><dt><span class="section"><a href="#_groups_created_during_engagement">3.17.3. Groups created during Engagement</a></span></dt></dl></dd><dt><span class="section"><a href="#_tag_taxonomy">3.18. Tag Taxonomy</a></span></dt><dd><dl><dt><span class="section"><a href="#_environment">3.18.1. Environment</a></span></dt><dt><span class="section"><a href="#_locations">3.18.2. Locations</a></span></dt><dt><span class="section"><a href="#_owners">3.18.3. Owners</a></span></dt><dt><span class="section"><a href="#_provisioning_scope">3.18.4. Provisioning Scope</a></span></dt><dt><span class="section"><a href="#_storage_types">3.18.5. Storage Types</a></span></dt><dt><span class="section"><a href="#_cost_center">3.18.6. Cost Center</a></span></dt><dt><span class="section"><a href="#_department">3.18.7. Department</a></span></dt><dt><span class="section"><a href="#_workload">3.18.8. Workload</a></span></dt><dt><span class="section"><a href="#_service_level">3.18.9. Service Level</a></span></dt><dt><span class="section"><a href="#_auto_approve_max_cpu">3.18.10. Auto Approve - Max CPU</a></span></dt><dt><span class="section"><a href="#_auto_approve_max_memory">3.18.11. Auto Approve - Max Memory</a></span></dt><dt><span class="section"><a href="#_auto_approve_retirement_days">3.18.12. Auto Approve - Retirement Days</a></span></dt><dt><span class="section"><a href="#_auto_approve_max_vm">3.18.13. Auto Approve - Max VM</a></span></dt><dt><span class="section"><a href="#_quota_max_memory">3.18.14. Quota - Max Memory</a></span></dt><dt><span class="section"><a href="#_quota_max_storage">3.18.15. Quota - Max Storage</a></span></dt><dt><span class="section"><a href="#_quota_max_cpu">3.18.16. Quota - Max CPU</a></span></dt></dl></dd><dt><span class="section"><a href="#_service_catalog">3.19. Service Catalog</a></span></dt><dd><dl><dt><span class="section"><a href="#_create_new_catalogs">3.19.1. Create new Catalogs</a></span></dt><dt><span class="section"><a href="#_create_new_catalog_item">3.19.2. Create New Catalog Item</a></span></dt><dt><span class="section"><a href="#_change_the_catalog_item_custom_image">3.19.3. Change the Catalog Item Custom Image</a></span></dt><dt><span class="section"><a href="#_create_new_catalog_bundle">3.19.4. Create New Catalog Bundle</a></span></dt></dl></dd><dt><span class="section"><a href="#_cloudforms_appendix">3.20. Cloudforms: Appendix</a></span></dt><dd><dl><dt><span class="section"><a href="#_datastore_import_file_ulink_url_cloudforms_automate_backups_namespace_mcicom_xml_namespace_mcicom_xml_ulink">3.20.1. Datastore Import File: namespace_MCICOM.xml</a></span></dt></dl></dd></dl></dd></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>2.1. <a href="#idp5616352">GPC Information</a></dt><dt>2.2. <a href="#idp5630736">Red Hat Contact Information</a></dt><dt>3.1. <a href="#idp5693168">Primary Interface Configuration</a></dt></dl></div><div class="chapter" title="Chapter 1. Document Information"><div class="titlepage"><div><div><h2 class="title"><a id="_document_information"></a>Chapter 1. Document Information</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#_originator">1.1. Originator</a></span></dt><dt><span class="section"><a href="#_owner">1.2. Owner</a></span></dt><dt><span class="section"><a href="#_copyright">1.3. Copyright</a></span></dt><dt><span class="section"><a href="#_distribution">1.4. Distribution</a></span></dt><dt><span class="section"><a href="#_confidentiality">1.5. Confidentiality</a></span></dt><dt><span class="section"><a href="#_additional_copies">1.6. Additional copies</a></span></dt></dl></div><div class="section" title="1.1. Originator"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_originator"></a>1.1. Originator</h2></div></div></div><p>Red Hat Consulting</p><p>James Villarreal</p></div><div class="section" title="1.2. Owner"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_owner"></a>1.2. Owner</h2></div></div></div><p>Red Hat Consulting – Confidential. Restricted distribution.</p></div><div class="section" title="1.3. Copyright"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_copyright"></a>1.3. Copyright</h2></div></div></div><p>This document contains proprietary information which is for exclusive use of Red Hat, Inc. and is not to be shared with personnel other than Red Hat, Inc.  This document, and any portion thereof, may not be copied, reproduced, photocopied, stored electronically on a retrieval system, or transmitted without the express written consent of the owner.</p><p>Red Hat Professional Services does not warrant this document to be free of errors or omissions.  Red Hat Professional Services reserves the right to make corrections, updates, revisions, or changes to the information contained herein.  Red Hat Professional Services does not warrant the material described herein to be free of patent infringement.</p><p>Unless provided otherwise in writing by RED HAT Professional Services, the information and programs described herein are provided “as is” without warranty of any kind, including but not limited to the implied warranties of merchantability and fitness for a particular purpose. In no event will RED HAT Professional Services, its officers, directors, or employees or affiliates of RED HAT Professional Services, their respective officers, directors, or employees be liable to any entity for any special, collateral, incidental, or consequential damages, including without any limitation, for any lost profits or lost savings, related or arising in any way from or out of the use or inability to use the information or programs set forth herein, even if it has been notified of the possibility of such damage by the purchaser or any third party.</p></div><div class="section" title="1.4. Distribution"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_distribution"></a>1.4. Distribution</h2></div></div></div><p>Do not forward or copy without written permission.</p><p>Copies of this document are restricted to the following:</p><p>Red Hat, Inc.</p><p>GPC</p></div><div class="section" title="1.5. Confidentiality"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_confidentiality"></a>1.5. Confidentiality</h2></div></div></div><p>All information supplied to GPC for the purpose of this project is to be considered Red Hat confidential.</p></div><div class="section" title="1.6. Additional copies"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_additional_copies"></a>1.6. Additional copies</h2></div></div></div><p>Further copies of this document can be obtained from:</p><p>James Villarreal</p></div></div><div class="chapter" title="Chapter 2. Project Approach"><div class="titlepage"><div><div><h2 class="title"><a id="_project_approach"></a>Chapter 2. Project Approach</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#_objectives">2.1. Objectives</a></span></dt><dd><dl><dt><span class="section"><a href="#_project_scope">2.1.1. Project Scope:</a></span></dt><dt><span class="section"><a href="#_proposed_schedule">2.1.2. Proposed Schedule</a></span></dt></dl></dd><dt><span class="section"><a href="#_logistics">2.2. Logistics</a></span></dt><dt><span class="section"><a href="#_contact_information">2.3. Contact Information</a></span></dt></dl></div><div class="section" title="2.1. Objectives"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_objectives"></a>2.1. Objectives</h2></div></div></div><div class="section" title="2.1.1. Project Scope:"><div class="titlepage"><div><div><h3 class="title"><a id="_project_scope"></a>2.1.1. Project Scope:</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
[ ] Installing up to three (3) CloudForms appliances for CloudForms provisioning and for remote calls from ServiceNow Service Catalog.
</li><li class="listitem">
[ ] Creating two (2) dashboards in CloudForms consisting of up to fifteen (15) reports in total showcasing Virtual Machine (VM) performance and capacity.
</li><li class="listitem">
[ ] Initializing CloudForms charge back rates with up to two (2) reports.
</li><li class="listitem">
[ ] Creating CloudForms categories ("tags") where appropriate.
</li><li class="listitem">
[ ] Integrating Active Directory for mapping groups to CloudForms user functions
</li><li class="listitem">
[ ] Setting up up Windows and Linux VM provisioning for a VMWare vSphere environment via the provisioning dialog based on Windows and Linux templates
</li><li class="listitem">
[ ] Creating a service catalog to provision Windows and Linux VMs including the following features:
</li><li class="listitem">
[ ] pre-provisioning methods to provision VMs in a folder based on CloudForms tags
</li><li class="listitem">
[ ] placement of VMs in specific VLANs using CloudForms tags
</li><li class="listitem">
[ ] creation of VM names based on tags and/or a combination of user-input variables
</li><li class="listitem">
[ ] acquisition of IP addresses from InfoBlox IP Address Management (IPAM)
</li><li class="listitem">
[ ] registration of new VMs with Active Directory
</li><li class="listitem">
[ ] leveraging VMWare VIX for post-execution steps for Windows and Linux
</li><li class="listitem">
[ ] Creating a dialog button and methods to remove Virtual Machines from inventory including the following features:
</li><li class="listitem">
[ ] powering off VMs
</li><li class="listitem">
[ ] moving VMs to new Virtual Center folders
</li><li class="listitem">
[ ] providing a dialog button to remove VMs from Virtual Center inventory, to remove VMs from Active Directory, and to
</li><li class="listitem">
[ ] release IP addresses from Infoblox
</li><li class="listitem">
[ ] Creating a ServiceNow Service Catalog interface to launch provisioning methods leveraging ServiceNow Service Catalog
</li><li class="listitem">
[ ] access and the ManageIQ plugin provided by ServiceNow.
</li><li class="listitem">
[ ] Integrating with one (1) VMWare vCenter Orchestrator (VCO) workflow leveraging REST APIs.
</li><li class="listitem">
[ ] Providing documentation of the installation and configuration of CloudForms in the form of an Engagement Journal
</li><li class="listitem">
[ ] Providing mentoring to client resources related to the CloudForms installation and configuration
</li></ul></div></div><div class="section" title="2.1.2. Proposed Schedule"><div class="titlepage"><div><div><h3 class="title"><a id="_proposed_schedule"></a>2.1.2. Proposed Schedule</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Duration
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
3 weeks, Sept 8 – Sept 26
</li></ul></div></li><li class="listitem"><p class="simpara">
Start Date
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Sept 8th, 2014
</li></ul></div></li><li class="listitem"><p class="simpara">
Travel Schedule
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
Week 1 (9/8 - 9/12)
</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
On-site support with 1 consultant and 1 DA
</li></ul></div></li><li class="listitem"><p class="simpara">
Week 2-3 (9/15 - 9/26)
</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
On-site support with 1 consultants (1 DA available as needed)
</li></ul></div></li></ul></div></li></ul></div></div></div><div class="section" title="2.2. Logistics"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_logistics"></a>2.2. Logistics</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Place of Performance
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
3100 Windy Hill Road Atlanta GA 30339
</li></ul></div></li><li class="listitem"><p class="simpara">
On-Site Customer Contact
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Jonathan Junkins: 770-850-2359
</li></ul></div></li><li class="listitem"><p class="simpara">
Security Requirements
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
None
</li></ul></div></li><li class="listitem"><p class="simpara">
Parking
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
[TBD]
</li></ul></div></li></ul></div></div><div class="section" title="2.3. Contact Information"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_contact_information"></a>2.3. Contact Information</h2></div></div></div><div class="table"><a id="idp5616352"></a><p class="title"><b>Table 2.1. GPC Information</b></p><div class="table-contents"><table summary="GPC Information" cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="106pt" /><col width="106pt" /><col width="106pt" /><col width="106pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> title </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Phone </th><th style="border-bottom: 1px solid ; " align="left" valign="top"> E-mail</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>Jonathan Junkins</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>Virtualization Architect</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>770.850.2539</p></td><td style="" align="left" valign="top"><p><a class="ulink" href="mailto:jonathan_junkins@genpt.com" target="_top">jonathan_junkins@genpt.com</a></p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp5630736"></a><p class="title"><b>Table 2.2. Red Hat Contact Information</b></p><div class="table-contents"><table summary="Red Hat Contact Information" cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="106pt" /><col width="106pt" /><col width="106pt" /><col width="106pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> title </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Phone </th><th style="border-bottom: 1px solid ; " align="left" valign="top"> E-mail</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Mathew Bolling</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Territory Services Manager</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>804-399-8154</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p><a class="ulink" href="mailto:mbolling@redhat.com" target="_top">mbolling@redhat.com</a></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Maria Barba</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Project Manager</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>919-604-1602</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p><a class="ulink" href="mailto:mbarilla@redhat.com" target="_top">mbarilla@redhat.com</a></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Vijay Checolu</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Domain Architect</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>732-666-2647</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p><a class="ulink" href="mailto:vchebolu@redhat.com" target="_top">vchebolu@redhat.com</a></p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>James Villareal</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>On-site Consultant</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>512-351-6842</p></td><td style="" align="left" valign="top"><p><a class="ulink" href="mailto:jvillarr@redhat.com" target="_top">jvillarr@redhat.com</a></p></td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="chapter" title="Chapter 3. Cloudforms POC"><div class="titlepage"><div><div><h2 class="title"><a id="_cloudforms_poc"></a>Chapter 3. Cloudforms POC</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#_architecture">3.1. Architecture</a></span></dt><dt><span class="section"><a href="#_cloudforms_appliance_allocations">3.2. Cloudforms Appliance Allocations</a></span></dt><dd><dl><dt><span class="section"><a href="#_cfme_appliance_system_requirements">3.2.1. CFME Appliance System Requirements</a></span></dt></dl></dd><dt><span class="section"><a href="#_cfme_appliance_setup">3.3. CFME Appliance Setup</a></span></dt><dd><dl><dt><span class="section"><a href="#_initial_setup">3.3.1. Initial Setup</a></span></dt><dt><span class="section"><a href="#_network_configuration">3.3.2. Network Configuration</a></span></dt><dt><span class="section"><a href="#_hostname_configuration">3.3.3. Hostname Configuration</a></span></dt><dt><span class="section"><a href="#_database_configuration">3.3.4. Database Configuration</a></span></dt></dl></dd><dt><span class="section"><a href="#_smtp_configuration">3.4. SMTP Configuration</a></span></dt><dt><span class="section"><a href="#_database_backups">3.5. Database Backups</a></span></dt><dt><span class="section"><a href="#_access_url">3.6. Access URL</a></span></dt><dt><span class="section"><a href="#_vmware_service_account">3.7. VMware Service Account</a></span></dt><dt><span class="section"><a href="#_install_vmware_vddk">3.8. Install VMware VDDK</a></span></dt><dt><span class="section"><a href="#_associate_cloudforms_appliance_as_a_vm_within_vcenter_provider">3.9. Associate Cloudforms Appliance as a VM within vCenter Provider</a></span></dt><dt><span class="section"><a href="#_configure_ntp_server">3.10. Configure NTP Server</a></span></dt><dt><span class="section"><a href="#_configure_outgoing_e_mail_settings">3.11. Configure outgoing E-mail settings</a></span></dt><dt><span class="section"><a href="#_register_appliance">3.12. Register Appliance</a></span></dt><dd><dl><dt><span class="section"><a href="#_editing_customer_information">3.12.1. Editing Customer Information</a></span></dt></dl></dd><dt><span class="section"><a href="#_ad_integration">3.13. AD Integration</a></span></dt><dd><dl><dt><span class="section"><a href="#_go_to_the_ldap_configuration_page">3.13.1. Go to the LDAP Configuration Page:</a></span></dt><dt><span class="section"><a href="#_fill_out_the_ldap_settings">3.13.2. Fill out the LDAP Settings</a></span></dt></dl></dd><dt><span class="section"><a href="#_add_openstack_provider">3.14. Add Openstack Provider</a></span></dt><dt><span class="section"><a href="#_add_vmware_provider">3.15. Add VMware Provider</a></span></dt><dd><dl><dt><span class="section"><a href="#_infoblox_automate_overview">3.15.1. Infoblox Automate Overview</a></span></dt><dt><span class="section"><a href="#_methods">3.15.2. Methods:</a></span></dt><dt><span class="section"><a href="#_policies_yaml">3.15.3. Policies.yaml</a></span></dt><dt><span class="section"><a href="#_profiles_yaml">3.15.4. Profiles.yaml</a></span></dt><dt><span class="section"><a href="#_alerts_yaml">3.15.5. Alerts.yaml</a></span></dt></dl></dd><dt><span class="section"><a href="#_database_backup_procedure">3.16. Database Backup Procedure</a></span></dt><dd><dl><dt><span class="section"><a href="#_web_ui_single_run_database_backup">3.16.1. Web UI: Single Run Database Backup</a></span></dt><dt><span class="section"><a href="#_web_ui_scheduled_database_backup">3.16.2. Web UI: Scheduled Database Backup</a></span></dt><dt><span class="section"><a href="#_ssh_manual_database_backup">3.16.3. SSH: Manual Database Backup</a></span></dt></dl></dd><dt><span class="section"><a href="#_member_groups">3.17. Member Groups</a></span></dt><dd><dl><dt><span class="section"><a href="#_creating_importing_group_from_ldap_active_directory">3.17.1. Creating/Importing Group from LDAP/Active Directory</a></span></dt><dt><span class="section"><a href="#_adding_smart_management_tag_to_group">3.17.2. Adding Smart Management Tag to Group</a></span></dt><dt><span class="section"><a href="#_groups_created_during_engagement">3.17.3. Groups created during Engagement</a></span></dt></dl></dd><dt><span class="section"><a href="#_tag_taxonomy">3.18. Tag Taxonomy</a></span></dt><dd><dl><dt><span class="section"><a href="#_environment">3.18.1. Environment</a></span></dt><dt><span class="section"><a href="#_locations">3.18.2. Locations</a></span></dt><dt><span class="section"><a href="#_owners">3.18.3. Owners</a></span></dt><dt><span class="section"><a href="#_provisioning_scope">3.18.4. Provisioning Scope</a></span></dt><dt><span class="section"><a href="#_storage_types">3.18.5. Storage Types</a></span></dt><dt><span class="section"><a href="#_cost_center">3.18.6. Cost Center</a></span></dt><dt><span class="section"><a href="#_department">3.18.7. Department</a></span></dt><dt><span class="section"><a href="#_workload">3.18.8. Workload</a></span></dt><dt><span class="section"><a href="#_service_level">3.18.9. Service Level</a></span></dt><dt><span class="section"><a href="#_auto_approve_max_cpu">3.18.10. Auto Approve - Max CPU</a></span></dt><dt><span class="section"><a href="#_auto_approve_max_memory">3.18.11. Auto Approve - Max Memory</a></span></dt><dt><span class="section"><a href="#_auto_approve_retirement_days">3.18.12. Auto Approve - Retirement Days</a></span></dt><dt><span class="section"><a href="#_auto_approve_max_vm">3.18.13. Auto Approve - Max VM</a></span></dt><dt><span class="section"><a href="#_quota_max_memory">3.18.14. Quota - Max Memory</a></span></dt><dt><span class="section"><a href="#_quota_max_storage">3.18.15. Quota - Max Storage</a></span></dt><dt><span class="section"><a href="#_quota_max_cpu">3.18.16. Quota - Max CPU</a></span></dt></dl></dd><dt><span class="section"><a href="#_service_catalog">3.19. Service Catalog</a></span></dt><dd><dl><dt><span class="section"><a href="#_create_new_catalogs">3.19.1. Create new Catalogs</a></span></dt><dt><span class="section"><a href="#_create_new_catalog_item">3.19.2. Create New Catalog Item</a></span></dt><dt><span class="section"><a href="#_change_the_catalog_item_custom_image">3.19.3. Change the Catalog Item Custom Image</a></span></dt><dt><span class="section"><a href="#_create_new_catalog_bundle">3.19.4. Create New Catalog Bundle</a></span></dt></dl></dd><dt><span class="section"><a href="#_cloudforms_appendix">3.20. Cloudforms: Appendix</a></span></dt><dd><dl><dt><span class="section"><a href="#_datastore_import_file_ulink_url_cloudforms_automate_backups_namespace_mcicom_xml_namespace_mcicom_xml_ulink">3.20.1. Datastore Import File: namespace_MCICOM.xml</a></span></dt></dl></dd></dl></div><div class="section" title="3.1. Architecture"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_architecture"></a>3.1. Architecture</h2></div></div></div><p>*The diagram below describes the capabilities of Red Hat CloudForms Management Engine. Its features are designed to work together to provide robust management and maintenance of your virtual infrastructure.</p><p title="Features"><b>Features. </b><span class="inlinemediaobject"><img src="../cloudforms/architecture/cloudforms_arch1.png" alt="../cloudforms/architecture/cloudforms_arch1.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
The architecture comprises the following components:
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
The CloudForms Management Engine Appliance (Appliance) which is supplied as a secure, high-performance, preconfigured virtual machine. It provides support for Secure Socket Layer (SSL) communications.
</li><li class="listitem">
The CloudForms Management Engine Server (Server) resides on the Appliance. It is the software layer that communicates between the SmartProxy and the Virtual Management Database. It includes support for Secure Socket Layer (SSL) communications.
</li><li class="listitem">
The Virtual Management Database (VMDB) resides either on the Appliance or another computer accessible to the Appliance. It is the definitive source of intelligence collected about your Virtual Infrastructure. It also holds status information regarding Appliance tasks.
</li><li class="listitem">
The CloudForms Management Engine Console (Console) is the Web interface used to view and control the Server and Appliance. It is consumed through Web 2.0 mash-ups and web services (WS Management) interfaces.
</li><li class="listitem">
The SmartProxy can reside on the Appliance or on an ESX Server. If not embedded in the Server, the SmartProxy can be deployed from the Appliance. Each storage location must have a SmartProxy with visibility to it. The SmartProxy acts on behalf of the Appliance communicating with it over HTTPS (SSL) on standard port 443.
</li></ul></div></li></ul></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Reference <a class="ulink" href="https://access.redhat.com/documentation/en-US/CloudForms/3.0/html/Management_Engine_5.2_Settings_And_Operations/Architecture2.html" target="_top">https://access.redhat.com/documentation/en-US/CloudForms/3.0/html/Management_Engine_5.2_Settings_And_Operations/Architecture2.html</a></p></td></tr></table></div></div><div class="section" title="3.2. Cloudforms Appliance Allocations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_cloudforms_appliance_allocations"></a>3.2. Cloudforms Appliance Allocations</h2></div></div></div><div class="section" title="3.2.1. CFME Appliance System Requirements"><div class="titlepage"><div><div><h3 class="title"><a id="_cfme_appliance_system_requirements"></a>3.2.1. CFME Appliance System Requirements</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
POC CFME Appliance:
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
3x CFME Appliance:
</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
4 vCPU
</li><li class="listitem">
6 GB of RAM
</li><li class="listitem">
1x 40 Root Vol Disk
</li><li class="listitem">
1x 107GB DB Disk
</li><li class="listitem">
1x Network Interface
</li></ul></div></li></ul></div></li></ul></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p><a class="ulink" href="../docs/Simplified-CFME-VMDB-Region-Zone-Global-Size-Estimator.ods" target="_top">Simplified-CFME-VMDB-Region-Zone-Global-Size-Estimator</a></p></td></tr></table></div></div></div><div class="section" title="3.3. CFME Appliance Setup"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_cfme_appliance_setup"></a>3.3. CFME Appliance Setup</h2></div></div></div><div class="section" title="3.3.1. Initial Setup"><div class="titlepage"><div><div><h3 class="title"><a id="_initial_setup"></a>3.3.1. Initial Setup</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Download the CFME appliance from the Red Hat Customer Portal (login required). The CFME appliance is available as an OVA (Open Virtualization Format) file from: Download Software &gt; Red Hat Enterprise Linux (v. 6 for 64-bit x86_64) &gt; Red Hat CloudForms Management Engine (v5.2) &gt; VMware Virtual Appliance.
</li><li class="listitem">
Upload the OVA file to the VMware Datastore and create the appliances virtual machines using this file. Convert the virtual machine into a template and use it to create all the appliances.
</li></ol></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>To increase performance, increase the default 4 vCPUs/6GB RAM appliance configuration to 4 vCPUs/8GB RAM for the Web UI appliance and 4 vCPUs/8GB RAM for the DB and the Worker appliances.</p></td></tr></table></div></div><div class="section" title="3.3.2. Network Configuration"><div class="titlepage"><div><div><h3 class="title"><a id="_network_configuration"></a>3.3.2. Network Configuration</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Once started, the appliances need to be configured with basic network settings using the virtual serial console in the VMware client. Login as <span class="strong"><strong>admin / smartvm</strong></span> and press Enter to go to the Advanced Settings menu.  Set Static Network Configuration, Set Hostname, Set Timezone, Date, and Time. When done entering the settings, select Summary Information to review.
</li><li class="listitem">
Host &amp; IP Allocations
</li></ul></div><div class="table"><a id="idp5693168"></a><p class="title"><b>Table 3.1. Primary Interface Configuration</b></p><div class="table-contents"><table summary="Primary Interface Configuration" cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="70pt" /><col width="70pt" /><col width="70pt" /><col width="70pt" /><col width="70pt" /><col width="70pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Host      </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top">   IP Address </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Netmask </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Gateway </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> DNS Server </th><th style="border-bottom: 1px solid ; " align="left" valign="top"> Notes</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>augpcpdrcfapp03</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.50.98</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>255.255.255.0</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.50.1</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.152.5, 10.6.152.5</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>CFME UI Appliance</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>augpcpdrcfapp03</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.50.99</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>255.255.255.0</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.50.1</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.152.5, 10.6.152.5</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>CFME Worker Appliance</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>augpcpdrcfapp02</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.50.100</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>255.255.255.0</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.50.1</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.5.152.5, 10.6.152.5</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>CFME Worker Appliance</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>augpcpdrcfapp01</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>10.5.128.217</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>255.255.254.0</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>10.5.128.1</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>10.5.152.5, 10.6.152.6</p></td><td style="" align="left" valign="top"><p>CFME DB Appliance</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section" title="3.3.3. Hostname Configuration"><div class="titlepage"><div><div><h3 class="title"><a id="_hostname_configuration"></a>3.3.3. Hostname Configuration</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
Select Option 4
</li><li class="listitem">
Set the hostname of the CFME appliance.  Refer to the table in Network Configuration section
</li></ol></div></div><div class="section" title="3.3.4. Database Configuration"><div class="titlepage"><div><div><h3 class="title"><a id="_database_configuration"></a>3.3.4. Database Configuration</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
With the new appliance the Database is not shipped configured by default. There will need to be a separate Database disk created outside of the appliance and then connected once the appliance has been started. In this case, after looking at where the current VM count and number of VM’s that will be coming over the next few years the Database has been sized to 100GB. This will allow for growth over the next few years.
</li></ul></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The database uses LVM and storage can be extended at a later time</p></td></tr></table></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
On the main console window select Option 10 (To Configure Database)
</li><li class="listitem">
Select 1) Internal
</li><li class="listitem">
Select 1) /dev/mapper/vg_data-lv_pg
</li><li class="listitem">
Input Region <span class="strong"><strong>10</strong></span> for the Region Selection
</li><li class="listitem">
Press <span class="strong"><strong>Enter</strong></span>
</li></ol></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="141pt" /><col width="141pt" /><col width="141pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Region Name  </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top">   Region #  </th><th style="border-bottom: 1px solid ; " align="left" valign="top"> Notes</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Region</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>POC to Production</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>DBRegion</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>99</p></td><td style="" align="left" valign="top"><p>Optional: When GPC decides to scale to have DB Replication</p></td></tr></tbody></table></div><p>Non-DB appliances configure an external database, using the DB appliance.</p></div></div><div class="section" title="3.4. SMTP Configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_smtp_configuration"></a>3.4. SMTP Configuration</h2></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>SMTP Server</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>smtp.genpt.com</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>email</p></td><td style="" align="left" valign="top"><p><a class="ulink" href="mailto:vmadmin@genpt.com" target="_top">vmadmin@genpt.com</a></p></td></tr></tbody></table></div></div><div class="section" title="3.5. Database Backups"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_database_backups"></a>3.5. Database Backups</h2></div></div></div><p>Database backups are scheduled to occur daily at 2AM CST. Backups are saved to an NFS volume.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>NFS Volume Location</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>nfs://10.1.130.3:/vol/cf_nfs_data1</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Frequency</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Daily</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>Time</p></td><td style="" align="left" valign="top"><p>02:00 CST</p></td></tr></tbody></table></div></div><div class="section" title="3.6. Access URL"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_access_url"></a>3.6. Access URL</h2></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="425pt" /></colgroup><thead><tr><th style="border-bottom: 1px solid ; " align="left" valign="top"> UI URL</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><a class="ulink" href="https://10.5.50.98" target="_top">https://10.5.50.98</a></p></td></tr></tbody></table></div></div><div class="section" title="3.7. VMware Service Account"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_vmware_service_account"></a>3.7. VMware Service Account</h2></div></div></div><div class="important" title="Important" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="./images/icons/important.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Need a CFME Service Account in order to access VMware vCenter and be able to provision and manage the vCenter environment from Cloudforms</p></td></tr></table></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>See the VMware documentation for instructions on how to create a role. This role will need to be associated with whatever credentials you enter for the Management System’s instance.</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
From the Global group, check:
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Cancel task
</li><li class="listitem">
Diagnostics
</li><li class="listitem">
Log Event
</li><li class="listitem">
Set custom attribute
</li><li class="listitem">
Settings
</li></ul></div></li><li class="listitem"><p class="simpara">
The entire set of privileges for the following groups should be checked.
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Alarms
</li><li class="listitem">
Datastores
</li><li class="listitem">
dvPort Group
</li><li class="listitem">
Host
</li><li class="listitem">
Network
</li><li class="listitem">
Resource
</li><li class="listitem">
Scheduled Task
</li><li class="listitem">
Tasks
</li><li class="listitem">
Virtual Machine
</li><li class="listitem">
vSphere Distributed Switch
</li></ul></div></li></ul></div><p>In addition, you must also have the following objects and new role in place:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Datacenter: At the Datacenter the CloudForms Management Engine (CFME) (formerly EVM) user/group must have at least the read-only role at the Datacenter level (Not Propagated) to be able to see the datacenter. Without this access, relationships cannot be made. Specifically, the datastores will not show up.
</li><li class="listitem">
Cluster: Each Cluster that the CFME needs access to must have the new role assigned and propagated.
</li><li class="listitem">
Folders: Each Folder that CFME needs access to must have the new role assigned and propagated.
</li><li class="listitem">
Datastores: Each Datastore that CFME needs access to must have the new role assigned and propagated.
</li><li class="listitem">
Networking: Each vLAN or Port Group that CFME needs access to must have the new role assigned and propagated.
</li></ul></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>For latest update on this section refer to <a class="ulink" href="https://access.redhat.com/site/articles/320543" target="_top">Creating Role for CFME in VMware</a> article in Customer Portal</p></td></tr></table></div></div><div class="section" title="3.8. Install VMware VDDK"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_install_vmware_vddk"></a>3.8. Install VMware VDDK</h2></div></div></div><p>The integration of the VMware VDDK (Virtual Disk Development Kit) optimizes the execution of SmartState Analysis on Virtual Machines and is required for CFME Appliances to successfully collect insight information within VMware vCenter. The VDDK can be downloaded from the VMware website with a valid customer account.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Download the VDDK 1.2.2 from VMware’s website at <a class="ulink" href="https://my.vmware.com" target="_top">https://my.vmware.com</a>
</li><li class="listitem">
Download the file VMware-vix-disklib-5.1.1-1042608.x86_64.tar.gz
</li><li class="listitem">
Copy the file to the /root folder of the CFME Appliances
</li><li class="listitem">
Start an SSH session into the CFME Appliance
</li><li class="listitem">
Run the following commands to extract and install vmware vddk, accept defaults during the installation process:
</li></ol></div><pre class="screen">cd /root
tar xvzf VMware-vix-disklib-5.1.1-1042608.x86_64.tar.gz
cd vmware-vix-disklib-distrib
./vmware-install.pl</pre><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Once the VDDK is installed, run the ldconfig command in order for EVM to find the newly installed vddk library.:
</li></ol></div><pre class="screen">ldconfig</pre><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Reboot the CloudForms Appliance. The VDDK is now installed on the CFME appliance.
</li></ol></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Reference: <a class="ulink" href="https://access.redhat.com/knowledge/articles/329683" target="_top">https://access.redhat.com/knowledge/articles/329683</a></p></td></tr></table></div></div><div class="section" title="3.9. Associate Cloudforms Appliance as a VM within vCenter Provider"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_associate_cloudforms_appliance_as_a_vm_within_vcenter_provider"></a>3.9. Associate Cloudforms Appliance as a VM within vCenter Provider</h2></div></div></div><p>In order for Cloudforms to know which appliance is which VM to execute certain jobs it needs to be associated
* Go to Infrastructure &gt; Virtual Machines &gt; Search for &lt;appliance name&gt; (i.e. c3pucfme1)  &gt; Click on VM
* In the VM object view Use the VM Configuration menu &gt; Select Edit Management Engine Relationship</p><p><span class="inlinemediaobject"><img src="../cloudforms/EVMrelationship/image1.png" alt="../cloudforms/EVMrelationship/image1.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Use the drop down menu to associate the EVM appliance that matches up with this VM.  (i.e. EVM10000000000001)
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/EVMrelationship/image2.png" alt="../cloudforms/EVMrelationship/image2.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click on Save
</li></ul></div></div><div class="section" title="3.10. Configure NTP Server"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_configure_ntp_server"></a>3.10. Configure NTP Server</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Go to Configure &gt; Configuration &gt; Select EVM Server &gt; Click on Server Tab &gt; Enter NTP Information
</li></ul></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="170pt" /><col width="170pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Label </th><th style="border-bottom: 1px solid ; " align="left" valign="top">  value</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>Servers</p></td><td style="" align="left" valign="top"><p>ntp.genpt.net</p></td></tr></tbody></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click on Save
</li></ul></div></div><div class="section" title="3.11. Configure outgoing E-mail settings"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_configure_outgoing_e_mail_settings"></a>3.11. Configure outgoing E-mail settings</h2></div></div></div><p>To use the email action in CloudForms Management Engine, you need to set an email address that you will have the emails sent from.</p><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>To be able to send any emails from the server, you must have the Notifier Server role enabled. You can test the settings without the role enabled.</p></td></tr></table></div><p><span class="inlinemediaobject"><img src="../cloudforms/email/image1.png" alt="../cloudforms/email/image1.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Environment Specific Settings:
</li></ul></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="127pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Label </th><th style="border-bottom: 1px solid ; " align="left" valign="top">  value</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Host</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>smtp.genpt.com</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Port</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>25</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Domain</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>genpt.com</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Start TLS Automatically</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>&lt;NOT checked&gt;</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>SSL Verify Mode</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>None</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Authentication</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>login</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>User Name</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>vmadmin</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Password</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>&lt;blank&gt;</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>From E-mail Address</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p><a class="ulink" href="mailto:vmadmin@genpt.com" target="_top">vmadmin@genpt.com</a></p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>Test E-mail Address</p></td><td style="" align="left" valign="top"><p></p></td></tr></tbody></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Use Host to specify the host name of the mail server.
</li><li class="listitem">
Use Port to specify the port for the mail server.
</li><li class="listitem">
Use Domain to specify domain name for the mail server.
</li><li class="listitem">
Check Start TLS Automatically if the mail server requires TLS.
</li><li class="listitem">
Select the appropriate SSL Verify Mode.
</li><li class="listitem">
Use the Authentication drop down to specify if you want to use login or plain authentication.
</li><li class="listitem">
Use User Name to specify the user name required for login authentication.
</li><li class="listitem">
Use Password to specify the password for login authentication.
</li><li class="listitem">
Use From Email Address to set the address you want to send the email from.
</li><li class="listitem">
Use To Email Address if you want to test your email settings.
</li><li class="listitem">
Click on Save
</li></ul></div></div><div class="section" title="3.12. Register Appliance"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_register_appliance"></a>3.12. Register Appliance</h2></div></div></div><div class="section" title="3.12.1. Editing Customer Information"><div class="titlepage"><div><div><h3 class="title"><a id="_editing_customer_information"></a>3.12.1. Editing Customer Information</h3></div></div></div><p>The Red Hat Updates page allows the user to edit customer information.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
To edit customer information
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Navigate to Configure → Configuration.
</li><li class="listitem">
Click on the Settings accordion, then Region, then click on the Red Hat Updates tab.
</li><li class="listitem">
Click Edit Registration in the Customer Information area
</li><li class="listitem"><p class="simpara">
The Customer Information area will display options to edit registration, User ID and Password.
</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
Register to field provides options for the Customer Portal, RHN Satellite v5 for Red Hat Satellite 5.x servers, and RHN Satellite v6 for Red Hat Satellite 6.x servers. If switching to RHN Satellite v5 or v6, the page will refresh and a prompt for a Server URL will be included in the Customer Information area.
</li><li class="listitem">
The HTTP Proxy area displays options to enable usage of the HTTP Proxy.
</li><li class="listitem">
The User ID and Password are the customer account details for the Customer Portal or Satellite.
</li></ul></div></li></ul></div></li></ul></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Reference <a class="ulink" href="https://access.redhat.com/documentation/en-US/CloudForms/3.0/html/Management_Engine_5.2_Installation_Guide/chap-Registering_and_Updating_CloudForms_Management_Engine.html" target="_top">https://access.redhat.com/documentation/en-US/CloudForms/3.0/html/Management_Engine_5.2_Installation_Guide/chap-Registering_and_Updating_CloudForms_Management_Engine.html</a></p></td></tr></table></div></div></div><div class="section" title="3.13. AD Integration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_ad_integration"></a>3.13. AD Integration</h2></div></div></div><div class="section" title="3.13.1. Go to the LDAP Configuration Page:"><div class="titlepage"><div><div><h3 class="title"><a id="_go_to_the_ldap_configuration_page"></a>3.13.1. Go to the LDAP Configuration Page:</h3></div></div></div><div class="section" title="3.13.1.1. Configure &gt; Settings &gt; Select EVM Server &gt; Select Authentication Tab"><div class="titlepage"><div><div><h4 class="title"><a id="_configure_gt_settings_gt_select_evm_server_gt_select_authentication_tab"></a>3.13.1.1. Configure &gt; Settings &gt; Select EVM Server &gt; Select Authentication Tab</h4></div></div></div><p><span class="inlinemediaobject"><img src="../cloudforms/LDAP/ldap_0.png" alt="../cloudforms/LDAP/ldap_0.png" /></span></p></div></div><div class="section" title="3.13.2. Fill out the LDAP Settings"><div class="titlepage"><div><div><h3 class="title"><a id="_fill_out_the_ldap_settings"></a>3.13.2. Fill out the LDAP Settings</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Set the Session Timeout and Mode
</li></ul></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="102pt" /><col width="237pt" /></colgroup><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Session Timeout:</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>[ 3 ]h [ 0 ]m</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>Mode:</p></td><td style="" align="left" valign="top"><p>LDAP</p></td></tr></tbody></table></div><p><span class="inlinemediaobject"><img src="../cloudforms/LDAP/ldap_2.png" alt="../cloudforms/LDAP/ldap_2.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Set the LDAP Settings
</li></ul></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="102pt" /><col width="237pt" /></colgroup><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>LDAP Host Names:</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>awgpcpdmadapp07.genpt.net</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>LDAP Port:</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>389</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>User Type:</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>User Principle Name</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>User Suffix: &lt;user&gt;@</p></td><td style="" align="left" valign="top"><p>genpt.net</p></td></tr></tbody></table></div><p><span class="inlinemediaobject"><img src="../cloudforms/LDAP/ldap_2.png" alt="../cloudforms/LDAP/ldap_2.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Set the Role Settings
</li></ul></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="102pt" /><col width="237pt" /></colgroup><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Get User Groups from LDAP</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>&lt;Checked&gt;</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Get Roles from Home Forest</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>&lt;Checked&gt;</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Follow Referrals</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>&lt;UnChecked&gt;</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Base DN:</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>DC=GENPT,DC=NET</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Bind DN:</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>svc_vmadmin</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>Bind Password:</p></td><td style="" align="left" valign="top"><p>&lt;See GPC’s for Password&gt;</p></td></tr></tbody></table></div><p><span class="inlinemediaobject"><img src="../cloudforms/LDAP/ldap_3.png" alt="../cloudforms/LDAP/ldap_3.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click [ Validate ]
</li><li class="listitem">
Click on Save button at the bottom right of the page
</li></ul></div></div></div><div class="section" title="3.14. Add Openstack Provider"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_add_openstack_provider"></a>3.14. Add Openstack Provider</h2></div></div></div><p>After initial installation and creation of a CloudForms Management Engine environment, add cloud providers with the following procedure.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Navigate to Clouds → Providers.
</li><li class="listitem">
Click (Configuration), then click (Add a New Cloud Provider).
</li><li class="listitem">
Enter a Name for the provider.
</li><li class="listitem">
Select the OpenStack in the Provider field
</li><li class="listitem"><p class="simpara">
Fill out the Credentials by typing in a User ID, Password, and a verification of this password (Verify Password).
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
If editing an OpenStack provider, use the AMQP subtab to provide credentials required for the Advanced Message Queuing Protocol service on your OpenStack Nova component.
</li></ul></div></li><li class="listitem">
Click Validate to validate the credentials.
</li><li class="listitem">
Click Add.
</li></ul></div></div><div class="section" title="3.15. Add VMware Provider"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_add_vmware_provider"></a>3.15. Add VMware Provider</h2></div></div></div><p>After initial installation and creation of a CloudForms Management Engine environment, add providers to the appliance with the following procedure.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Navigate to Infrastructure → Providers.
</li><li class="listitem">
Click (Configuration), then click (Add a New Infrastructure Provider).
</li><li class="listitem">
Type in the Name of the provider to add. The Name is how the device is labeled in the console.
</li><li class="listitem">
Select the Type of provider: VMware vCenter.
</li><li class="listitem">
Type in the Host Name, and IP Address of the provider to add.
</li><li class="listitem">
Type in a User ID and Password with administrator privileges to the provider. To refresh a provider, these credentials are required.
</li><li class="listitem">
Click Validate to confirm that the user and password connects.
</li><li class="listitem">
Click Save.
</li></ul></div><p title="VMware Provider Details"><b>VMware Provider Details. </b>|=
| Name | Dallas vCenter
| Type | VMware vCenter
| Host Name | ddpvc4.genpt.net
| IP Address | 10.6.128.49
| Zone | WK-Zone
| User | mcip\cf.cloud.svc
| Password | &lt;See GPC for Password&gt;
|=</p><div class="section" title="3.15.1. Infoblox Automate Overview"><div class="titlepage"><div><div><h3 class="title"><a id="_infoblox_automate_overview"></a>3.15.1. Infoblox Automate Overview</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">
/MCICOM
</span></dt><dd><div class="variablelist"><dl><dt><span class="term">
/Integration
</span></dt><dd><div class="variablelist"><dl><dt><span class="term">
/RapidClone
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Instances:
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Dialog_Storage_Controller
</li><li class="listitem">
Dialog_VM_Sizing_CPU
</li><li class="listitem">
Dialog_VM_Sizing_Memory
</li><li class="listitem">
Execute_Rapid_Clone
</li><li class="listitem">
Rapid_Clone_Email_Complete
</li><li class="listitem">
Retrieve_Clone_Source
</li><li class="listitem">
Retrieve_Clone_Source_Path
</li><li class="listitem">
Retrieve_Customization_Specification
</li><li class="listitem">
Retrieve_Datastore_List
</li><li class="listitem">
Retrieve_Destination_Folder
</li><li class="listitem">
Retrieve_Destination_Host
</li><li class="listitem">
Retrieve_Storage_Controller
</li></ul></div></li><li class="listitem">
Class Schema:
</li></ul></div></dd></dl></div></dd></dl></div></dd></dl></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /><col width="28pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Type </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Data Type </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Default Value </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Display Name </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Description </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Sub </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Collect </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Message </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> On Entry </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> On Exit </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> On Error </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Collect </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Max Retries </th><th style="border-bottom: 1px solid ; " align="left" valign="top"> Max Time</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>servername</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Attribute</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>String</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>mcimgmt1.mcis.usmc.mil</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>username</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Attribute</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>String</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>MCIS\jose</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>password</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Attribute</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Password</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>controller_ip</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Attribute</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>String</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10.2.100.19</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>controller_username</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Attribute</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>String</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>vsc.netapp.svc</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>controller_password</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Attribute</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Password</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>action</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Attribute</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>String</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p></p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>method1</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Method</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>String</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p></p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>method2</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>Method</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>String</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>[x]</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>create</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p></p></td><td style="" align="left" valign="top"><p></p></td></tr></tbody></table></div></div><div class="section" title="3.15.2. Methods:"><div class="titlepage"><div><div><h3 class="title"><a id="_methods"></a>3.15.2. Methods:</h3></div></div></div><p>Import Control Policies, Profiles, Alerts
* Go to Control &gt; Import/Export
* Click on "Browse" and select the local file to upload
* Click Upload
* Next page will populate showing you all of the items that will be imported
* Click on "Commit"</p><p>Do the previous steps for each of the files in the next 3 sections.</p></div><div class="section" title="3.15.3. Policies.yaml"><div class="titlepage"><div><div><h3 class="title"><a id="_policies_yaml"></a>3.15.3. Policies.yaml</h3></div></div></div><p>Link: <a class="ulink" href="../cloudforms/Control_Import/Policies.yaml" target="_top">Policies.yaml</a></p><p>Source:</p><pre class="screen">---
- MiqPolicy:
    name: 427a4378-6519-11df-b637-005056a435be
    description: ! 'Analysis: Post Provisioning'
    expression:
    towhat: Vm
    guid: 427a4378-6519-11df-b637-005056a435be
    created_by: admin
    updated_by: admin
    notes: This policy triggers a vm analysis of any newly provisioned VM
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_provisioned
        description: VM Provision Complete
        guid: 2a17a20a-3e8e-11df-9fe2-005056a435be
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_analyze
        description: Initiate SmartState Analysis for VM
        guid: 5cbe1082-ce35-11de-a117-005056b0503e
        action_type: default
        options: {}
    Condition: []
- MiqPolicy:
    name: ! 'Do Not Analyze '
    description: ! 'Analysis: Prevent Analysis of Selected VMs'
    expression:
    towhat: Vm
    guid: 3a7959c0-2866-11de-af2a-0050568026c2
    created_by:
    updated_by: admin
    notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not Analyze '
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      failure_synchronous: true
      MiqEvent:
        name: request_vm_scan
        description: VM Analysis Request
        guid: e3292c46-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: prevent
        description: Prevent current event from proceeding
        guid: d885a118-519b-11e0-8d82-005056af0000
        action_type: default
        options: {}
    Condition:
    - name: Do Not Analyze
      description: VM classified as DO_NOT_ANALYZE
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            tag: Vm.managed-exclusions
            value: do_not_analyze
        context_type:
      towhat: Vm
      file_mtime:
      guid: 39ff4444-08e2-11de-829f-005056a164b2
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000001
      notes:
- MiqPolicy:
    name: 782068f8-44ee-11e0-99a6-00505688000a
    description: ! 'Analysis: VDI Login'
    expression:
    towhat: Vm
    guid: 782068f8-44ee-11e0-99a6-00505688000a
    created_by: admin
    updated_by: admin
    notes: This policy triggers an analysis of a VDI session when a user logs in to
      that session
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_vdi_login_session
        description: VDI Login Session
        guid: 15fc3cce-448a-11e0-9ad1-00505688000a
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_analyze
        description: Initiate SmartState Analysis for VM
        guid: 5cbe1082-ce35-11de-a117-005056b0503e
        action_type: default
        options: {}
    Condition: []
- MiqPolicy:
    name: 467f80ce-4808-11df-badc-005056a7121f
    description: ! 'Analysis: VM Configuration Only Profile'
    expression:
    towhat: Vm
    guid: 467f80ce-4808-11df-badc-005056a7121f
    created_by: admin
    updated_by: admin
    notes: ! 'This policy assigns an analysis profile that only gathers vm configuration
      data. Note: the specified action requires that you create an analysis profile
      that only scans vm configuration data. Once it has been created, associate it
      with the specified action'
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_start
        description: VM Analysis Start
        guid: 057b9baa-519c-11e0-8d82-005056af0000
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: b52a86f0-4807-11df-badc-005056a7121f
        description: ! 'Profile: VM configuration only'
        guid: b52a86f0-4807-11df-badc-005056a7121f
        action_type: assign_scan_profile
        options:
          :scan_item_set_name: vm configuration only
    Condition: []
- MiqPolicy:
    name: 2f2a1a1c-4806-11df-badc-005056a7121f
    description: ! 'Analysis: VM Reconfiguration'
    expression:
    towhat: Vm
    guid: 2f2a1a1c-4806-11df-badc-005056a7121f
    created_by: admin
    updated_by: admin
    notes: Performs an analysis on any vm that has been reconfigured
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_analyze
        description: Initiate SmartState Analysis for VM
        guid: 5cbe1082-ce35-11de-a117-005056b0503e
        action_type: default
        options: {}
    Condition: []
- MiqPolicy:
    name: d658fe5c-de2c-11e1-9088-005056af009e
    description: Collect Logged on User Info
    expression:
    towhat: Vm
    guid: d658fe5c-de2c-11e1-9088-005056af009e
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: f7b8361e-1139-11e1-9333-005056af009e
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: {}
    Condition:
    - name: ab61c97a-de2e-11e1-9088-005056af009e
      description: Check files starting with nb
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkcount:
              ! '&gt;=':
                value: '1'
                field: &lt;count&gt;
            search:
              INCLUDES:
                value: nb
                field: Vm.filesystems-name
        context_type:
      towhat: Vm
      file_mtime:
      guid: ab61c97a-de2e-11e1-9088-005056af009e
      filename:
      applies_to_exp:
      miq_policy_id: 5
      notes:
- MiqPolicy:
    name: c66e6d58-d2fc-11de-b4f6-0050568a547d
    description: ! 'Configuration: Host - DMZ Fully Collapsed Advanced Settings'
    expression:
    towhat: Host
    guid: c66e6d58-d2fc-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policy verifies designated host advanced settings values to ensure
      that they meet DMZ requirements
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_scan_complete
        description: Host Analysis Complete
        guid: ffcfb368-455d-11de-86a0-005056a81f62
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    Condition:
    - name: 1ea32d10-d2fd-11de-b4f6-0050568a547d
      description: host - dmz - advanced settings - ssl
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: 'true'
                field: Host.advanced_settings-value
            search:
              =:
                value: Config.Defaults.security.host.ruissl
                field: Host.advanced_settings-name
      towhat: Host
      file_mtime:
      guid: 1ea32d10-d2fd-11de-b4f6-0050568a547d
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000013
      notes:
- MiqPolicy:
    name: 8a8f247a-480a-11df-badc-005056a7121f
    description: ! 'Configuration: VM - CPU Reservation &gt; 500Mhz'
    expression:
    towhat: Vm
    guid: 8a8f247a-480a-11df-badc-005056a7121f
    created_by: admin
    updated_by: admin
    notes: Sends an email if CPU reservation is set to a value greater than 500Mhz
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: f7b8361e-1139-11e1-9333-005056af009e
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 5189755e-480a-11df-badc-005056a7121f
        description: Alert - CPU Reservation &gt; 500Mhz
        guid: 5189755e-480a-11df-badc-005056a7121f
        action_type: evaluate_alerts
        options:
          :alert_guids:
          - ca26a9c6-4802-11df-badc-005056a7121f
    Condition: []
- MiqPolicy:
    name: 6adebf82-d2e4-11de-b4f6-0050568a547d
    description: ! 'Configuration: VM - DMZ  Fully Collapsed  Network'
    expression:
    towhat: Vm
    guid: 6adebf82-d2e4-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: ! 'created by: Rod Moore

      purpose: validates vm vlan configuration'
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    Condition:
    - name: 278843f0-d2e6-11de-b4f6-0050568a547d
      description: vm - vlan - webserver
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                IS NOT NULL:
                  field: Vm.lans-created_on
              search:
                INCLUDES:
                  value: External
                  field: Vm.lans-name
          - CONTAINS:
              tag: Vm.managed-function
              value: web_server
      towhat: Vm
      file_mtime:
      guid: 278843f0-d2e6-11de-b4f6-0050568a547d
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000015
      notes:
- MiqPolicy:
    name: 39fbf6bc-d2fa-11de-b4f6-0050568a547d
    description: ! 'Configuration: VM - DMZ Fully Collapsed Windows Services'
    expression:
    towhat: Vm
    guid: 39fbf6bc-d2fa-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policies verifies that certain services are disabled on DMZ vms
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    Condition:
    - name: ed4daf4e-d2fa-11de-b4f6-0050568a547d
      description: dmz - windows alerter - disabled
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          =:
            regkey: HKLM\SYSTEM\CurrentControlSet\Services\Alerter
            regval: Start
            value: 4
      towhat: Vm
      file_mtime:
      guid: ed4daf4e-d2fa-11de-b4f6-0050568a547d
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000016
      notes:
    - name: 469a8766-d2fb-11de-b4f6-0050568a547d
      description: dmz - windows messenger - disabled
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          =:
            regkey: HKLM\SYSTEM\CurrentControlSet\Services\Messenger
            regval: Start
            value: 4
      towhat: Vm
      file_mtime:
      guid: 469a8766-d2fb-11de-b4f6-0050568a547d
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000016
      notes:
    - name: 7f648a84-d2fa-11de-b4f6-0050568a547d
      description: dmz - windows automatic update - disabled
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          =:
            regkey: HKLM\SYSTEM\CurrentControlSet\Services\wuauserv
            regval: Start
            value: 4
      towhat: Vm
      file_mtime:
      guid: 7f648a84-d2fa-11de-b4f6-0050568a547d
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000016
      notes:
- MiqPolicy:
    name: de3af0f2-d2f0-11de-b4f6-0050568a547d
    description: ! 'Configuration: VM - Internal Network'
    expression:
    towhat: Vm
    guid: de3af0f2-d2f0-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policy shutdown application or database vms that are incorrectly configured
      to access the dmz network
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    Condition:
    - name: 020dd9c2-d2f1-11de-b4f6-0050568a547d
      description: vm - internal vlan check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                IS NOT NULL:
                  field: Vm.lans-created_on
              search:
                INCLUDES:
                  value: Internal
                  field: Vm.lans-name
          - or:
            - CONTAINS:
                tag: Vm.managed-function
                value: application_servers
            - CONTAINS:
                tag: Vm.managed-function
                value: database
      towhat: Vm
      file_mtime:
      guid: 020dd9c2-d2f1-11de-b4f6-0050568a547d
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000014
      notes:
- MiqPolicy:
    name: 56c4d50e-3069-11de-971a-005056a12545
    description: DISA ESX Server STIG - ESX1170 requires IAO/SA to remove or disable
      all unused hardware on VM
    expression:
    towhat: Vm
    guid: 56c4d50e-3069-11de-971a-005056a12545
    created_by:
    updated_by:
    notes:
    active: true
    mode: control
    MiqPolicyContent: []
    Condition:
    - name: 627379ac-3067-11de-971a-005056a12545
      description: ! 'ESX1170: CAT II - Guest OS remove all unused hardware'
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkcount:
                =:
                  value: 0
                  field: &lt;count&gt;
              search:
                INCLUDES:
                  value: floppy
                  field: Vm.hardware.disks-device_type
          - FIND:
              checkcount:
                =:
                  value: 0
                  field: &lt;count&gt;
              search:
                INCLUDES:
                  value: cdrom
                  field: Vm.hardware.disks-device_type
      towhat: Vm
      file_mtime:
      guid: 627379ac-3067-11de-971a-005056a12545
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000010
      notes:
- MiqPolicy:
    name: 69b1559e-3068-11de-971a-005056a12545
    description: DISA ESX Server STIG requires that the Virtual Machine Administrator
      be responsible for the following
    expression:
    towhat: Vm
    guid: 69b1559e-3068-11de-971a-005056a12545
    created_by:
    updated_by:
    notes:
    active: true
    mode: control
    MiqPolicyContent: []
    Condition:
    - name: ed826874-3066-11de-971a-005056a12545
      description: ! 'ESX1030: CAT II - Test and Development VMs must be seperated
        from Production VMs'
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkcount:
                ! '&gt;=':
                  value: 1
                  field: &lt;count&gt;
              search:
                STARTS WITH:
                  value: '192.168'
                  field: Vm.hardware.networks-ipaddress
          - CONTAINS:
              tag: Vm.managed-environment
              value: prod
      towhat: Vm
      file_mtime:
      guid: ed826874-3066-11de-971a-005056a12545
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000011
      notes:
    - name: 28e35e32-3067-11de-971a-005056a12545
      description: ! 'ESX0940: CAT II - prevent use of nonpersistent disk mode'
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkcount:
              =:
                value: 0
                field: &lt;count&gt;
            search:
              INCLUDES:
                value: nonpersistent
                field: Vm.hardware.disks-mode
      towhat: Vm
      file_mtime:
      guid: 28e35e32-3067-11de-971a-005056a12545
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000011
      notes:
- MiqPolicy:
    name: de9aa7ec-3069-11de-971a-005056a12545
    description: DISA Information Assurance Vulnerability Alert - MS08-67
    expression:
    towhat: Vm
    guid: de9aa7ec-3069-11de-971a-005056a12545
    created_by:
    updated_by:
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    Condition:
    - name: 7e492e4c-3067-11de-971a-005056a12545
      description: IAVA - MS08-067 for Windows 2000 Service Pack 4
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkall:
                STARTS WITH:
                  value: 5.00.2195.7203
                  field: Vm.filesystems-file_version
              search:
                =:
                  value: c:/winnt/system32/netapi32.dll
                  field: Vm.filesystems-name
          - KEY EXISTS:
              regkey: HKLM\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB958644\Filelist
      towhat: Vm
      file_mtime:
      guid: 7e492e4c-3067-11de-971a-005056a12545
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          and:
          - STARTS WITH:
              value: Microsoft Windows 2000
              field: Vm.operating_system-product_name
          - =:
              value: Service Pack 4
              field: Vm.operating_system-service_pack
      miq_policy_id: 10000000000012
      notes:
    - name: 8b0d83d0-3067-11de-971a-005056a12545
      description: IAVA - MS08-067 for Windows Server 2003 Service Pack 1 &amp; 2
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - and:
            - =:
                value: Service Pack 1
                field: Vm.operating_system-service_pack
            - FIND:
                checkall:
                  STARTS WITH:
                    value: 5.2.3790.3229
                    field: Vm.filesystems-file_version
                search:
                  =:
                    value: c:/windows/system32/netapi32.dll
                    field: Vm.filesystems-name
          - and:
            - =:
                value: Service Pack 2
                field: Vm.operating_system-service_pack
            - FIND:
                checkall:
                  STARTS WITH:
                    value: 5.2.3790.4392
                    field: Vm.filesystems-file_version
                search:
                  =:
                    value: c:/windows/system32/netapi32.dll
                    field: Vm.filesystems-name
      towhat: Vm
      file_mtime:
      guid: 8b0d83d0-3067-11de-971a-005056a12545
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          and:
          - STARTS WITH:
              value: Microsoft Windows Server 2003
              field: Vm.operating_system-product_name
          - or:
            - =:
                value: Service Pack 1
                field: Vm.operating_system-service_pack
            - =:
                value: Service Pack 2
                field: Vm.operating_system-service_pack
      miq_policy_id: 10000000000012
      notes:
    - name: 9482beb2-3067-11de-971a-005056a12545
      description: IAVA - MS08-067 for Windows XP Service Pack 2 &amp; 3
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkall:
                STARTS WITH:
                  value: 5.1.2600.3462
                  field: Vm.filesystems-file_version
              search:
                =:
                  value: c:/windows/system32/netapi32.dll
                  field: Vm.filesystems-name
          - KEY EXISTS:
              regkey: HKLM\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB958644\Filelist
      towhat: Vm
      file_mtime:
      guid: 9482beb2-3067-11de-971a-005056a12545
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          and:
          - STARTS WITH:
              value: Microsoft Windows XP
              field: Vm.operating_system-product_name
          - or:
            - =:
                value: Service Pack 2
                field: Vm.operating_system-service_pack
            - =:
                value: Service Pack 3
                field: Vm.operating_system-service_pack
      miq_policy_id: 10000000000012
      notes:
- MiqPolicy:
    name: 69fbd202-8ba3-11e0-b8fc-005056a40e59
    description: DMZ - Shutdown VM after Analysis if it has more than 1 NIC
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: 'on'
          field: Vm-power_state
      context_type:
    towhat: Vm
    guid: 69fbd202-8ba3-11e0-b8fc-005056a40e59
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: f7b8361e-1139-11e1-9333-005056af009e
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: f7b8361e-1139-11e1-9333-005056af009e
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: evm_event
        description: Show EVM Event on Timeline
        guid: 16b1810c-44e8-11e0-acda-005056a40e59
        action_type: default
        options: {}
    Condition:
    - name: efcf3702-8b9e-11e0-b8fc-005056a40e59
      description: DMZ - VM has more than 1 NIC
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          ! '&gt;':
            count: Vm.hardware.nics
            value: '1'
        context_type:
      towhat: Vm
      file_mtime:
      guid: efcf3702-8b9e-11e0-b8fc-005056a40e59
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000077
      notes:
- MiqPolicy:
    name: 0de66508-8b9f-11e0-b8fc-005056a40e59
    description: DMZ - Shutdown VM after Starting if it has more than 1 NIC
    expression:
    towhat: Vm
    guid: 0de66508-8b9f-11e0-b8fc-005056a40e59
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: evm_event
        description: Show EVM Event on Timeline
        guid: 16b1810c-44e8-11e0-acda-005056a40e59
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: d91bbabc-b0be-11e1-b0dc-005056b057a8
        description: ! 'VM Attribute: Allowed NIC Count Exceeded'
        guid: d91bbabc-b0be-11e1-b0dc-005056b057a8
        action_type: set_custom_attribute
        options:
          :attribute: EVM Policy
          :value: Allowed NIC Limit Exceeded
    Condition:
    - name: efcf3702-8b9e-11e0-b8fc-005056a40e59
      description: DMZ - VM has more than 1 NIC
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          ! '&gt;':
            count: Vm.hardware.nics
            value: '1'
        context_type:
      towhat: Vm
      file_mtime:
      guid: efcf3702-8b9e-11e0-b8fc-005056a40e59
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000077
      notes:
- MiqPolicy:
    name: 0f2cc826-fa4b-11de-83ca-005056ba0614
    description: Directory Service Used for Authentication for sudo
    expression:
    towhat: Host
    guid: 0f2cc826-fa4b-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that sudo is configured to use a directory for user
      authentication.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 684b2a60-fa4b-11de-83ca-005056ba0614
      description: Directory Service used for sudo authentication
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*auth\s+required\s+.*pam_stack\.so\s+service=system-auth
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/pam.d/sudo
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 684b2a60-fa4b-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000053
      notes: ! 'This condition verifies that the line "auth required pam_stack.so
        service=system-auth" exists in /etc/pam.d/sudo. '
- MiqPolicy:
    name: 1c4c7772-a7fb-11e0-abed-005056af0000
    description: Do Not Analyze Active VDI VMs
    expression:
    towhat: Vm
    guid: 1c4c7772-a7fb-11e0-abed-005056af0000
    created_by: admin
    updated_by: admin
    notes: This policy prevents analysis of a vm that has an active user session
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_start
        description: VM Analysis Start
        guid: 057b9baa-519c-11e0-8d82-005056af0000
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: prevent
        description: Prevent current event from proceeding
        guid: d885a118-519b-11e0-8d82-005056af0000
        action_type: default
        options: {}
    Condition:
    - name: 0a50f750-a7fb-11e0-abed-005056af0000
      description: VM has an active session
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: 'true'
            field: Vm-has_active_vdi_session
        context_type:
      towhat: Vm
      file_mtime:
      guid: 0a50f750-a7fb-11e0-abed-005056af0000
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000007
      notes:
- MiqPolicy:
    name: af2d74ea-fa39-11de-83ca-005056ba0614
    description: Firewall - Incoming Security Level
    expression:
    towhat: Host
    guid: af2d74ea-fa39-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that only a defined set of incoming TCP and UDP Ports
      are open.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: b4a0843a-fa43-11de-83ca-005056ba0614
      description: Valid Incoming UDP Ports
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: '427'
            field: Host-enabled_udp_inbound_ports
      towhat: Host
      file_mtime:
      guid: b4a0843a-fa43-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000021
      notes: This condition verifies that the only open incoming UDP port is 427.
    - name: 03529e9e-f961-11de-9e9d-0050568a07c7
      description: Valid Incoming TCP Ports
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: '902,80,443,427,5989,22,5988'
            field: Host-enabled_tcp_inbound_ports
      towhat: Host
      file_mtime:
      guid: 03529e9e-f961-11de-9e9d-0050568a07c7
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000021
      notes: This condition verifies that the only open incoming TCP ports are 22,80,427,443,902,5988,and
        5989.
- MiqPolicy:
    name: edaf1082-fa54-11de-83ca-005056ba0614
    description: Firewall - Outgoing NTP Port
    expression:
    towhat: Host
    guid: edaf1082-fa54-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates that the Firewall is configured properly for NTP
      support.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 1cb7f0ba-fa55-11de-83ca-005056ba0614
      description: Valid NTP Outgoing UDP Port
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          INCLUDES ANY:
            value: '123'
            field: Host-enabled_udp_outbound_ports
      towhat: Host
      file_mtime:
      guid: 1cb7f0ba-fa55-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000052
      notes: This condition verifies that the outgoing UDP port required by NTP (port
        123) is open.
- MiqPolicy:
    name: 04db603c-fa3a-11de-83ca-005056ba0614
    description: Firewall - Outgoing Security Level
    expression:
    towhat: Host
    guid: 04db603c-fa3a-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that only a defined set of outgoing TCP and UDP Ports
      are open.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: f0afd7d6-fa3a-11de-83ca-005056ba0614
      description: Valid Outgoing TCP Ports
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: '902,427,443,27000,27010'
            field: Host-enabled_tcp_outbound_ports
      towhat: Host
      file_mtime:
      guid: f0afd7d6-fa3a-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000020
      notes: This condition verifies that the only open outgoing TCP ports are 427,443,902,27000,
        and 27010.
    - name: 1778fb28-fa44-11de-83ca-005056ba0614
      description: Valid Outgoing UDP Ports
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: '427,123,902'
            field: Host-enabled_udp_outbound_ports
      towhat: Host
      file_mtime:
      guid: 1778fb28-fa44-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000020
      notes: This condition verifies that the only open outgoing UDP ports are 123,427,
        and 902.
- MiqPolicy:
    name: 2d6bfc2c-fa3b-11de-83ca-005056ba0614
    description: Limit Log Size
    expression:
    towhat: Vm
    guid: 2d6bfc2c-fa3b-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 8b9cf076-fa3b-11de-83ca-005056ba0614
      description: Log Size Limit &lt;= 100KB
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              &lt;=:
                value: '100000'
                field: Vm.advanced_settings-value
            search:
              =:
                value: log.rotateSize
                field: Vm.advanced_settings-name
      towhat: Vm
      file_mtime:
      guid: 8b9cf076-fa3b-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000061
      notes:
- MiqPolicy:
    name: f1af8b44-fa3b-11de-83ca-005056ba0614
    description: Limit Number of Log Files
    expression:
    towhat: Vm
    guid: f1af8b44-fa3b-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: f2ad72ac-fa3d-11de-83ca-005056ba0614
      description: Number of Log Files to Keep &lt;= 10
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              &lt;=:
                value: '10'
                field: Vm.advanced_settings-value
            search:
              =:
                value: log.keepOld
                field: Vm.advanced_settings-name
      towhat: Vm
      file_mtime:
      guid: f2ad72ac-fa3d-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000060
      notes:
- MiqPolicy:
    name: 2cd1b736-fa52-11de-83ca-005056ba0614
    description: Limit Software and Services Running in Service Console
    expression:
    towhat: Host
    guid: 2cd1b736-fa52-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates that only an approved list of services are enabled
      at boot time on an ESX host.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: c4c80bfa-fa55-11de-83ca-005056ba0614
      description: Default Services Running in Service Console
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: crond, firewall, gpm, ipmi, irqbalance, mgmt-vmware, microcode_ctl,
              mptctlnode, network, ntpd, pegasus, portmap, random, rawdevices, sshd,
              syslog, vmware, vmware-autostart, vmware-late, vmware-vmkauthd, vmware-vpxa,
              vmware-webAccess, wsman, xinetd
            field: Host-enabled_run_level_3_services
      towhat: Host
      file_mtime:
      guid: c4c80bfa-fa55-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000051
      notes: This conditions validates that a defined list of services are enabled
        with the ESX host is booted with networking support (run level 3). This list
        includes the generic services included in ESX. Additional hardware specific
        services can be added to the expression.
- MiqPolicy:
    name: 8cecc84c-fa46-11de-83ca-005056ba0614
    description: Limit su Access to root Account
    expression:
    towhat: Host
    guid: 8cecc84c-fa46-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates that only members of the group wheel can access the
      su command.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 63b243fc-fa47-11de-83ca-005056ba0614
      description: Only members of wheel group can execute su command
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*auth\s+required\s+.*pam_wheel\.so\s+use_uid
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/pam.d/su
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 63b243fc-fa47-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000050
      notes: This condition validates that the file /etc/pam.d/su contains a variation
        of the string "auth required pam_wheel.so use_uid".
- MiqPolicy:
    name: c79821fa-fa53-11de-83ca-005056ba0614
    description: Limit vmkernel Size
    expression:
    towhat: Host
    guid: c79821fa-fa53-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy checks the vmkernel log is limited to a specified size.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: be9722e0-fa53-11de-83ca-005056ba0614
      description: vmkernel Log Size &lt;= 4096KB
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmkernel
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: be9722e0-fa53-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000049
      notes: This condition verifies that the file /etc/logrotate.d/vmkernel is configured
        to limit the associated log to 4096KB.
- MiqPolicy:
    name: fc63df74-fa52-11de-83ca-005056ba0614
    description: Limit vmksummary Size
    expression:
    towhat: Host
    guid: fc63df74-fa52-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy checks the vmksummary log is limited to a specified size.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: def33840-fa52-11de-83ca-005056ba0614
      description: vmksummary Log Size &lt;= 4096KB
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmksummary
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: def33840-fa52-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000056
      notes: This condition verifies that the file /etc/logrotate.d/vmksummary is
        configured to limit the associated log to 4096KB.
- MiqPolicy:
    name: 79548666-fa51-11de-83ca-005056ba0614
    description: Limit vmkwarning Size
    expression:
    towhat: Host
    guid: 79548666-fa51-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy checks the vmkwarning log is limited to a specified size.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 14d35e46-fa52-11de-83ca-005056ba0614
      description: vmkwarning Log Size &lt;= 4096KB
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmkwarning
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 14d35e46-fa52-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000048
      notes: This condition verifies that the file /etc/logrotate.d/vmkwarning is
        configured to limit the associated log to 4096KB.
- MiqPolicy:
    name: b218c83c-c01c-11e3-b785-001a4a0f459e
    description: MyNew VM Control Policy
    expression:
    towhat: Vm
    guid: b218c83c-c01c-11e3-b785-001a4a0f459e
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: vm_retired
        description: VM Retired
        guid: e363d8aa-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: {}
    Condition: []
- MiqPolicy:
    name: 61b355f2-fee1-11de-83dd-005056ba5e76
    description: Network - Forged Transmits Must Be Disabled
    expression:
    towhat: Host
    guid: 61b355f2-fee1-11de-83dd-005056ba5e76
    created_by: admin
    updated_by: admin
    notes: This policy insures that forged transmits are disabled on both vLans and
      vSwitches.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: f246e3e0-fee1-11de-83dd-005056ba5e76
      description: Forged Transmits Disabled in vLan
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'false'
              field: Host.lans-forged_transmits
      towhat: Host
      file_mtime:
      guid: f246e3e0-fee1-11de-83dd-005056ba5e76
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000022
      notes: This condition verifies that forged transmits are disabled on vlans.
    - name: a3ac5774-fee1-11de-83dd-005056ba5e76
      description: Forged Transmits Disabled in vSwitch
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'false'
              field: Host.switches-forged_transmits
      towhat: Host
      file_mtime:
      guid: a3ac5774-fee1-11de-83dd-005056ba5e76
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000022
      notes: This condition verifies that forged transmits are disabled on vSwitches.
- MiqPolicy:
    name: de683aa6-fedf-11de-83dd-005056ba5e76
    description: Network - Mac Changes not Allowed
    expression:
    towhat: Host
    guid: de683aa6-fedf-11de-83dd-005056ba5e76
    created_by: admin
    updated_by: admin
    notes: This policy checks that MAC changes are not allowed on vSwitches and vLans.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 0a6eb332-fee0-11de-83dd-005056ba5e76
      description: Mac Changes Disabled in vSwitches
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'false'
              field: Host.switches-mac_changes
      towhat: Host
      file_mtime:
      guid: 0a6eb332-fee0-11de-83dd-005056ba5e76
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000028
      notes: This condition verifies that MAC changes are not allowed on vSwitches.
    - name: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
      description: Mac Changes Disabled in vLans
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'false'
              field: Host.lans-mac_changes
      towhat: Host
      file_mtime:
      guid: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000028
      notes: This condition verifies that MAC changes are not allowed on vLans.
- MiqPolicy:
    name: 7cc14778-fe0f-11de-83dd-005056ba5e76
    description: Network - Promiscuous Mode Setting Not Disabled
    expression:
    towhat: Host
    guid: 7cc14778-fe0f-11de-83dd-005056ba5e76
    created_by: admin
    updated_by: admin
    notes: Check the Host VLan setting for Promiscuous Mode which should be disabled.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 2045b314-fe58-11de-83dd-005056ba5e76
      description: Check Host vSwitch - Promiscuous Mode Must Not Be Enable
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'true'
              field: Host.switches-allow_promiscuous
      towhat: Host
      file_mtime:
      guid: 2045b314-fe58-11de-83dd-005056ba5e76
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000029
      notes: This condition verifies that vSwitches do not allow Promiscuous mode
        via inheritance.
    - name: 80e5ff5e-fe16-11de-83dd-005056ba5e76
      description: Check Host Port - Promiscuous Mode Must Not Be Enabled
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'true'
              field: Host.lans-computed_allow_promiscuous
      towhat: Host
      file_mtime:
      guid: 80e5ff5e-fe16-11de-83dd-005056ba5e76
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000029
      notes: This condition verifies that vLans do not allow Promiscuous mode via
        inheritance.
- MiqPolicy:
    name: Configuration Policy Restrict Cloning SQL Server
    description: ! 'Operational: Prevent Cloning of Database VMs'
    expression:
    towhat: Vm
    guid: 39fdeba0-2866-11de-af2a-0050568026c2
    created_by:
    updated_by: admin
    notes: prevents cloning of vms with a workload tag value of database
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_clone_start
        description: VM Clone Start
        guid: e30f6720-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: cancel_task
        description: Cancel vCenter Task
        guid: e49bfee6-1e1e-11de-8918-0050568005db
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: vm_clone_start
        description: VM Clone Start
        guid: e30f6720-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: SendEmail
        description: SendEmail
        guid: abcf406c-02cd-11de-86d4-005056903dbc
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :from: evmadmin@manageiq.com
          :to: evm_demo@manageiq.com
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: vm_clone_start
        description: VM Clone Start
        guid: e30f6720-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 4468f036-0b6d-11df-bd07-005056a7121f
        description: VM Attribute - Prevent Clone of SQL Server
        guid: 4468f036-0b6d-11df-bd07-005056a7121f
        action_type: set_custom_attribute
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :value: Clone Prevented for SQL Server VM
          :attribute: EVM Policy
    Condition:
    - name: VMs running SQL Server
      description: VMs with Workload - Database
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            tag: Vm.managed-function
            value: database
        context_type:
      towhat: Vm
      file_mtime:
      guid: 121ecf62-01c6-11de-a701-005056903dbc
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000064
      notes:
- MiqPolicy:
    name: Automation Policy - Scope VM Retirement Warning,  ResponseExecute Automation
      Model
    description: ! 'Operational: Retirement Warning'
    expression:
    towhat: Vm
    guid: 39621392-2866-11de-af2a-0050568026c2
    created_by:
    updated_by: admin
    notes: This policy raises an automation event when a retirement warning event
      is raised
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      failure_synchronous: true
      MiqEvent:
        name: vm_retire_warn
        description: VM Retirement Warning
        guid: 97c85330-fe93-11dd-b5e1-005056903dbc
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: {}
    Condition: []
- MiqPolicy:
    name: Automation Policy - Scope VM Retired Response Execute Automation Model
    description: ! 'Operational: Vm Retired'
    expression:
    towhat: Vm
    guid: 397700ae-2866-11de-af2a-0050568026c2
    created_by:
    updated_by: admin
    notes: This policy raises an automation event when a vm retirement event is raised
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      failure_synchronous: true
      MiqEvent:
        name: vm_retired
        description: VM Retired
        guid: e363d8aa-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: {}
    Condition: []
- MiqPolicy:
    name: 2f9fad14-fa4e-11de-83ca-005056ba0614
    description: Password Aging - Default Maximum
    expression:
    towhat: Host
    guid: 2f9fad14-fa4e-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates the ESX host's maximum password age configuration.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: a4a0e740-fa4e-11de-83ca-005056ba0614
      description: Default Maximum Password Age &lt;= 90days
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PASS_MAX_DAYS\s+([0-9]|[1-8][0-9]|90)
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/login.defs
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: a4a0e740-fa4e-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000047
      notes: This condition checks the file /etc/login.defs and verifies that the
        PASS_MAX_DAYS parameter's value is 90 days or greater.
- MiqPolicy:
    name: 32b26f2c-fa4f-11de-83ca-005056ba0614
    description: Password Aging - Default Minimum
    expression:
    towhat: Host
    guid: 32b26f2c-fa4f-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates the ESX host's minimum password age configuration.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 79d39ad4-fa4f-11de-83ca-005056ba0614
      description: Default Minimum Password Age &gt;= 0
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PASS_MIN_DAYS\s+\d+
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/login.defs
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 79d39ad4-fa4f-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000059
      notes: This condition checks the file /etc/login.defs and verifies that the
        PASS_MIN_DAYS parameter's value is greater than or equal to 0 days.
- MiqPolicy:
    name: 305e6832-fa51-11de-83ca-005056ba0614
    description: Password Complexity - Minimum Length
    expression:
    towhat: Host
    guid: 305e6832-fa51-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies the minimum password length.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: c0ba559e-fa51-11de-83ca-005056ba0614
      description: Minimum Password Length &gt;= 8
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PASS_MIN_LEN\s+([8-9]|[1-9][0-9]+)
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/login.defs
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: c0ba559e-fa51-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000057
      notes: This condition checks the file /etc/login.defs and verifies that the
        PASS_MIN_LEN parameter's value  is 8 or greater.
- MiqPolicy:
    name: 40b796dc-fa50-11de-83ca-005056ba0614
    description: Password Expiration Warning Default
    expression:
    towhat: Host
    guid: 40b796dc-fa50-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies the default setting for password expiration warning.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 0e842bde-fa51-11de-83ca-005056ba0614
      description: Password Expiration Warning Default &gt;= 7days
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PASS_WARN_AGE\s+([7-9]|[1-9][0-9]+)
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/login.defs
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 0e842bde-fa51-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000046
      notes: This condition checks the file /etc/login.defs and verifies that PASS_WARN_AGE
        parameter's value is set to 7 or greater.
- MiqPolicy:
    name: e6f082ba-fa4c-11de-83ca-005056ba0614
    description: Password checking enabled for sudo
    expression:
    towhat: Host
    guid: e6f082ba-fa4c-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that password checking is enabled for sudo.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 3d2074e2-fa4d-11de-83ca-005056ba0614
      description: NOPASSWD does not exist in sudoers file
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION DOES NOT MATCH:
                value: /^[^#]*NOPASSWD/i
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/sudoers
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 3d2074e2-fa4d-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000058
      notes: This condition check the file /etc/sudoers and verifies that it does
        not contain the word NOPASSWORD on an uncommented line.
- MiqPolicy:
    name: c5d44cb2-4734-11df-b577-005056a7121f
    description: ! 'Patch: MS10-008 Required'
    expression: !ruby/object:MiqExpression
      exp:
        CONTAINS:
          tag: Vm.managed-environment
          value: prod
      context_type:
    towhat: Vm
    guid: c5d44cb2-4734-11df-b577-005056a7121f
    created_by: admin
    updated_by: admin
    notes: Prevents a VM that does not have MS10-008 installed from running in the
      virtual environment. It's scope limits it to vms tagged as production
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: SendEmail
        description: SendEmail
        guid: abcf406c-02cd-11de-86d4-005056903dbc
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :from: evmadmin@manageiq.com
          :to: evm_demo@manageiq.com
    - qualifier: failure
      failure_sequence: 3
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 722d25cc-56dc-11df-bb16-005056a7121f
        description: VM Attribute - Fails patch policy
        guid: 722d25cc-56dc-11df-bb16-005056a7121f
        action_type: set_custom_attribute
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :value: Failed Windows Required Patch Policy
          :attribute: EVM Policy
    Condition:
    - name: a3089008-4734-11df-b577-005056a7121f
      description: Verify KB978262 is installed
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            value: KB978262
            field: Vm.patches-name
        context_type:
      towhat: Vm
      file_mtime:
      guid: a3089008-4734-11df-b577-005056a7121f
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000071
      notes:
- MiqPolicy:
    name: e4c93c82-fa3a-11de-83ca-005056ba0614
    description: Permissions - /etc/grub.conf
    expression:
    towhat: Host
    guid: e4c93c82-fa3a-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that editing the server's boot process requires root
      level authority.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: d2adb400-fa3b-11de-83ca-005056ba0614
      description: Permissions - /etc/grub.conf
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  value: '0600'
                  field: Host.filesystems-permissions
              search:
                =:
                  value: /etc/grub.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                =:
                  value: root
                  field: Host.filesystems-owner
              search:
                =:
                  value: /etc/grub.conf
                  field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: d2adb400-fa3b-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000027
      notes: This condition verifies that the file /etc/grub.conf's permissions are
        set to 0600 and is owned by root.
- MiqPolicy:
    name: 7ea7db8c-fa46-11de-83ca-005056ba0614
    description: Permissions - /etc/snmp/snmpd.conf
    expression:
    towhat: Host
    guid: 7ea7db8c-fa46-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy ensures that access to SNMP configuration parameters are limited
      to the root user.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: ebb24a50-fa46-11de-83ca-005056ba0614
      description: Permissions - /etc/snmp/snmpd.conf
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  value: '0700'
                  field: Host.filesystems-permissions
              search:
                =:
                  value: /etc/snmp/snmpd.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                =:
                  value: root
                  field: Host.filesystems-owner
              search:
                =:
                  value: /etc/snmp/snmpd.conf
                  field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: ebb24a50-fa46-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000045
      notes: This condition verifies that the permissions of /etc/snmp/snmpd.conf
        are 0700 and is owned by root.
- MiqPolicy:
    name: 7408efa8-21b3-11e2-a38c-0050568b19a3
    description: Power-Off Virtual Machines
    expression:
    towhat: Vm
    guid: 7408efa8-21b3-11e2-a38c-0050568b19a3
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    Condition:
    - name: d514b2fa-21b3-11e2-a38c-0050568b19a3
      description: VM with Workload Tag Messaging
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          !binary "Q09OVEFJTlM=":
            !binary "dGFn": Vm.managed-function
            !binary "dmFsdWU=": messaging
        context_type:
      towhat: Vm
      file_mtime:
      guid: d514b2fa-21b3-11e2-a38c-0050568b19a3
      filename:
      applies_to_exp:
      miq_policy_id:
      notes:
- MiqPolicy:
    name: f4f0e916-bbd5-11e1-a4a4-005056b25af6
    description: Prevent PowerOn of Quarantined VM
    expression:
    towhat: Vm
    guid: f4f0e916-bbd5-11e1-a4a4-005056b25af6
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: request_vm_start
        description: VM Power On Request
        guid: 48b02c4a-ae7c-11e1-a76f-005056b25af6
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    Condition:
    - name: 1cbc27da-bbd6-11e1-ac0c-005056b25af6
      description: VM Tagged as Do Not PowerOn
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            tag: Vm.managed-exclusions
            value: do_not_power_on
        context_type:
      towhat: Vm
      file_mtime:
      guid: 1cbc27da-bbd6-11e1-ac0c-005056b25af6
      filename:
      applies_to_exp:
      miq_policy_id:
      notes:
- MiqPolicy:
    name: eb84f288-fa39-11de-83ca-005056ba0614
    description: Protect Root File System Filling /home
    expression:
    towhat: Host
    guid: eb84f288-fa39-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the /home directory is mounted on a different
      partition than the root filesystem.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 62447a1a-fa3a-11de-83ca-005056ba0614
      description: Protect Root File System Filling /home
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^[^#]*\/home
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/fstab
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 62447a1a-fa3a-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000019
      notes: This condition verifies that the file /etc/fstab has an uncommented line
        that references the directory /home.
- MiqPolicy:
    name: a128d356-fa36-11de-83ca-005056ba0614
    description: Protect Root File System Filling /tmp
    expression:
    towhat: Host
    guid: a128d356-fa36-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the /tmp directory is mounted on a different
      partition than the root filesystem.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 267dd9de-fa37-11de-83ca-005056ba0614
      description: Protect Root File System Filling  /tmp
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^[^#]*\/tmp
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/fstab
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 267dd9de-fa37-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000044
      notes: This condition verifies that the file /etc/fstab has an uncommented line
        that references the directory /tmp.
- MiqPolicy:
    name: 854d45aa-fa3a-11de-83ca-005056ba0614
    description: Protect Root File System Filling /var/log
    expression:
    towhat: Host
    guid: 854d45aa-fa3a-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the /var/log directory is mounted on a different
      partition than the root filesystem.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: a84173e2-fa3a-11de-83ca-005056ba0614
      description: Protect Root File System Filling /var/log
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^[^#]*\/var\/log
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/fstab
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: a84173e2-fa3a-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000055
      notes: This condition verifies that the file /etc/fstab has an uncommented line
        that references the directory /var/log.
- MiqPolicy:
    name: 57189108-d1d3-11e1-9ede-005056af009e
    description: Record Last RDP User
    expression:
    towhat: Vm
    guid: 57189108-d1d3-11e1-9ede-005056af009e
    created_by: admin
    updated_by: admin
    notes: ! 'When a user logs on to the VM through an RDP session, the file c:\rdp_login\rdp.log
      is automatically created by the logon script.


      A analysis profile should be set to retrieve this file and its content.


      This policy will automatically raise an automate event so the content of the
      file can be parsed and elements set as custom attributes of the VM '
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: f7b8361e-1139-11e1-9333-005056af009e
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: {}
    Condition:
    - name: 5a4c3456-de30-11e1-9088-005056af009e
      description: Check for files starting with rep
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkcount:
              ! '&gt;=':
                field: &lt;count&gt;
                value: '1'
            search:
              INCLUDES:
                field: Vm.filesystems-name
                value: rdp
        context_type:
      towhat: Vm
      file_mtime:
      guid: 5a4c3456-de30-11e1-9088-005056af009e
      filename:
      applies_to_exp:
      miq_policy_id: 4
      notes:
- MiqPolicy:
    name: 5ce6be9a-fa4c-11de-83ca-005056ba0614
    description: Require users to enter own password - no ROOTPW entry
    expression:
    towhat: Host
    guid: 5ce6be9a-fa4c-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that when the sudo command is used, each user is prompted
      for their password and not the root password.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: a791b882-fa4c-11de-83ca-005056ba0614
      description: ROOTPW does not exist in sudoers file
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION DOES NOT MATCH:
                value: /^[^#]*ROOTPW/i
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/sudoers
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: a791b882-fa4c-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000043
      notes: This condition check the file /etc/sudoers and verifies that it does
        not contain the word ROOTPW on an uncommented line.
- MiqPolicy:
    name: a3a56370-c015-11e3-b785-001a4a0f459e
    description: Retirement of VM
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Vm-retired
          value: 'true'
      context_type:
    towhat: Vm
    guid: a3a56370-c015-11e3-b785-001a4a0f459e
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: vm_retired
        description: VM Retired
        guid: e363d8aa-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_retire
        description: Retire Virtual Machine
        guid: 047c677e-431c-11e3-91d5-001a4a0f459e
        action_type: default
        options: {}
    Condition: []
- MiqPolicy:
    name: eb0151ea-fa47-11de-83ca-005056ba0614
    description: Root Login on console should be Disabled
    expression:
    towhat: Host
    guid: eb0151ea-fa47-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the root account cannot directly login via the
      console.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 571e6e76-fa48-11de-83ca-005056ba0614
      description: File /etc/securetty should be empty
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: '0'
                field: Host.filesystems-size
            search:
              =:
                value: /etc/securetty
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 571e6e76-fa48-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000026
      notes: This condition checks the file /etc/securetty and verifies that it's
        empty by checking for a 0KB file size.
- MiqPolicy:
    name: c63b0560-fa45-11de-83ca-005056ba0614
    description: Root Login via SSH should be Disabled
    expression:
    towhat: Host
    guid: c63b0560-fa45-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the root account cannot login to the host via
      SSH.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 4435b6d6-fa46-11de-83ca-005056ba0614
      description: PermitRootLogin = no in sshd_config file
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PermitRootLogin\s+no
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ssh/sshd_config
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 4435b6d6-fa46-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000042
      notes: This condition checks the file /etc/ssh/sshd_config and verifies that
        the PermitRootLogin parameter's value is set to no.
- MiqPolicy:
    name: 24b92088-399c-11de-ae27-005056a11a54
    description: Service Level Gold - RAM must be 1GB and 1 vCPU - off
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: gold
        - =:
            value: 'off'
            field: Vm-power_state
      context_type:
    towhat: Vm
    guid: 24b92088-399c-11de-ae27-005056a11a54
    created_by:
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of gold has
      1vCPU and 1GB of memory. If not it changes the vm to these values. This policy
      is used on a powered off vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_RAM_1GB
        description: Set VM RAM to 1GB
        guid: 2d8445f2-9aec-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 1024
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_CPU_1
        description: Set VM CPU to 1
        guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '1'
    Condition:
    - name: 1c6ec35e-3908-11de-b6d5-005056a11a54
      description: Service Level Gold - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 1024
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 1
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime:
      guid: 1c6ec35e-3908-11de-b6d5-005056a11a54
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000069
      notes:
- MiqPolicy:
    name: 7a91f3ac-3908-11de-b6d5-005056a11a54
    description: Service Level Gold - RAM must be 1GB and 1 vCPU - on
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: gold
        - =:
            value: 'on'
            field: Vm-power_state
      context_type:
    towhat: Vm
    guid: 7a91f3ac-3908-11de-b6d5-005056a11a54
    created_by:
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of gold has
      1vCPU and 1GB of memory. If not it changes the vm to these values. This policy
      is used on a powered on vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_RAM_1GB
        description: Set VM RAM to 1GB
        guid: 2d8445f2-9aec-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 1024
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_CPU_1
        description: Set VM CPU to 1
        guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '1'
    - qualifier: success
      success_sequence: 4
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_start
        description: Start Virtual Machine
        guid: 55b5a422-3348-11de-bde2-005056a170fa
        action_type: default
        options: {}
    Condition:
    - name: 1c6ec35e-3908-11de-b6d5-005056a11a54
      description: Service Level Gold - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 1024
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 1
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime:
      guid: 1c6ec35e-3908-11de-b6d5-005056a11a54
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000069
      notes:
- MiqPolicy:
    name: b265c970-3908-11de-b6d5-005056a11a54
    description: Service Level Platinum - RAM must be 2GB and 2 vCPUs - off
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: platinum
        - =:
            value: 'off'
            field: Vm-power_state
      context_type:
    towhat: Vm
    guid: b265c970-3908-11de-b6d5-005056a11a54
    created_by:
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of platinum
      has 2 vCPUs and 2GB of memory. If not it changes the vm to these values. This
      policy is used on a powered off vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_RAM_2GB
        description: Set VM RAM to 2GB
        guid: cf1570b2-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 2048
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_CPU_2
        description: Set VM CPU to 2
        guid: e2c3d64e-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '2'
    Condition:
    - name: 34218558-3909-11de-b6d5-005056a11a54
      description: Service Level Platinum - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 2048
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 2
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime:
      guid: 34218558-3909-11de-b6d5-005056a11a54
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000070
      notes:
- MiqPolicy:
    name: 4cb4d05c-3909-11de-b6d5-005056a11a54
    description: Service Level Platinum - RAM must be 2GB and 2 vCPUs - on
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: platinum
        - =:
            value: 'on'
            field: Vm-power_state
      context_type:
    towhat: Vm
    guid: 4cb4d05c-3909-11de-b6d5-005056a11a54
    created_by:
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of platinum
      has 2 vCPUs and 2GB of memory. If not it changes the vm to these values. This
      policy is used on a powered on vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_RAM_2GB
        description: Set VM RAM to 2GB
        guid: cf1570b2-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 2048
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_CPU_2
        description: Set VM CPU to 2
        guid: e2c3d64e-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '2'
    - qualifier: success
      success_sequence: 4
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_start
        description: Start Virtual Machine
        guid: 55b5a422-3348-11de-bde2-005056a170fa
        action_type: default
        options: {}
    Condition:
    - name: 34218558-3909-11de-b6d5-005056a11a54
      description: Service Level Platinum - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 2048
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 2
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime:
      guid: 34218558-3909-11de-b6d5-005056a11a54
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000070
      notes:
- MiqPolicy:
    name: Service Level Policy Verify Virtual Hardware - Silver Level
    description: Service Level Silver - RAM must be 512MB and 1 vCPU - off
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: silver
        - =:
            value: 'off'
            field: Vm-power_state
      context_type:
    towhat: Vm
    guid: 3659b8bc-2866-11de-af2a-0050568026c2
    created_by:
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of silver has
      1 vCPU and 512MB of memory. If not it changes the vm to these values. This policy
      is used on a powered off vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_CPU_1
        description: Set VM CPU to 1
        guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '1'
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_RAM_512MB
        description: Set VM RAM to 512MB
        guid: bab04cb4-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 512
    Condition:
    - name: Service Level Validation Silver - Powered Off
      description: Service Level Silver - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 512
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 1
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime:
      guid: 531575ae-9b1c-11dd-bbd7-005056ac7d2c
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000068
      notes:
- MiqPolicy:
    name: d16643b6-3905-11de-b6d5-005056a11a54
    description: Service Level Silver - RAM must be 512MB and 1 vCPU - on
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: silver
        - =:
            value: 'on'
            field: Vm-power_state
      context_type:
    towhat: Vm
    guid: d16643b6-3905-11de-b6d5-005056a11a54
    created_by:
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of silver has
      1 vCPU and 512MB of memory. If not it changes the vm to these values. This policy
      is used on a powered on vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_RAM_512MB
        description: Set VM RAM to 512MB
        guid: bab04cb4-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 512
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: VM_CPU_1
        description: Set VM CPU to 1
        guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '1'
    - qualifier: success
      success_sequence: 4
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_start
        description: Start Virtual Machine
        guid: 55b5a422-3348-11de-bde2-005056a170fa
        action_type: default
        options: {}
    Condition:
    - name: Service Level Validation Silver - Powered Off
      description: Service Level Silver - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 512
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 1
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime:
      guid: 531575ae-9b1c-11dd-bbd7-005056ac7d2c
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000068
      notes:
- MiqPolicy:
    name: 498f5330-fa4b-11de-83ca-005056ba0614
    description: Settings -  Remote syslog Logging
    expression:
    towhat: Host
    guid: 498f5330-fa4b-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that syslog is configured to utilize a remote server.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: ee09af6e-fa4b-11de-83ca-005056ba0614
      description: Verify syslog Utilizes a Remote Host
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: /^[^#*]\s*.*@/
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/syslog.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: ee09af6e-fa4b-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000025
      notes: This condition checks the file /etc/syslog.conf and verifies the existence
        of the @ parameter, which is used to specify the use of a remote server.
- MiqPolicy:
    name: c340f524-fa3e-11de-83ca-005056ba0614
    description: Settings - /etc/grub.conf
    expression:
    towhat: Host
    guid: c340f524-fa3e-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that a password is required in order to edit the server's
      boot process.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 1f18225a-fa3f-11de-83ca-005056ba0614
      description: Verify /etc/grub.conf Settings
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*password\s\-\-md5
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/grub.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 1f18225a-fa3f-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000041
      notes: This condition check the file /etc/grub.conf and verifies that the parameter
        "password --md5" exists.
- MiqPolicy:
    name: e3f6428c-a85a-11e3-9c44-001a4a0f459e
    description: Settings - /etc/resolv.conf
    expression: !ruby/object:MiqExpression
      exp:
        FIND:
          search:
            =:
              field: Vm.filesystems-name
              value: resolv.conf
          checkall:
            =:
              field: Vm.filesystems-contents_available
              value: 'true'
      context_type:
    towhat: Vm
    guid: e3f6428c-a85a-11e3-9c44-001a4a0f459e
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: log
        description: Generate log message
        guid: 04771f80-431c-11e3-91d5-001a4a0f459e
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      success_synchronous: true
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: c26b7988-a860-11e3-9c44-001a4a0f459e
        description: resolv.conf
        guid: c26b7988-a860-11e3-9c44-001a4a0f459e
        action_type: custom_automation
        options:
          :ae_request: resolvsend
          :ae_message: create
    - qualifier: failure
      failure_sequence: 1
      failure_synchronous: true
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: log
        description: Generate log message
        guid: 04771f80-431c-11e3-91d5-001a4a0f459e
        action_type: default
        options: {}
    Condition: []
- MiqPolicy:
    name: 6576a074-fa48-11de-83ca-005056ba0614
    description: Settings - /etc/sudoers
    expression:
    towhat: Host
    guid: 6576a074-fa48-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that sudo is configured to use syslog for logging.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: ade186c6-fa48-11de-83ca-005056ba0614
      description: Verify sudo is Logging via syslog
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*Defaults\s+syslog\=
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/sudoers
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: ade186c6-fa48-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000040
      notes: This condition check the file /etc/sudoers and verifies that the parameter
        "Defaults syslog=" exists.
- MiqPolicy:
    name: ab373d88-fa4a-11de-83ca-005056ba0614
    description: Settings - Display Logs on Different Terminals
    expression:
    towhat: Host
    guid: ab373d88-fa4a-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that critical, error, and warning level log messages
      are directed to distinct terminals.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: f383ec6c-fa4a-11de-83ca-005056ba0614
      description: Verify Different Logs Displayed on Different Terminals
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*\*\.crit\s+\/dev\/tty
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/syslog.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*\*\.err\s+\/dev\/tty
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/syslog.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*\*\.warning\s+\/dev\/tty
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/syslog.conf
                  field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: f383ec6c-fa4a-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000024
      notes: This condition checks the file /etc/syslog.conf has three seperate parameters
        defined for critical, error, and warning level log messages. These parameters
        specify the tty will display the specified log messages.
- MiqPolicy:
    name: 4b188948-fa45-11de-83ca-005056ba0614
    description: Settings - SNMP Read Only Access
    expression:
    towhat: Host
    guid: 4b188948-fa45-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that SNMP is configured to only allow read-only access.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: e328c720-fa45-11de-83ca-005056ba0614
      description: SNMP Configured for Read-only Access
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*rocommunity
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/snmp/snmpd.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  value: ^\s*rwcommunity
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/snmp/snmpd.conf
                  field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: e328c720-fa45-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000054
      notes: This condition checks the file /etc/snmp/snmpd.conf and verfies that
        the rocommunity parameter is defined and the rwcommunity parameter is not.
- MiqPolicy:
    name: 0864fae6-fa54-11de-83ca-005056ba0614
    description: Settings - vmkernel Compress Option
    expression:
    towhat: Host
    guid: 0864fae6-fa54-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the vmkernel log is compressed by default.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: fe7378be-fa53-11de-83ca-005056ba0614
      description: Verify Compression Enabled in vmkernel
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: \s+compress
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmkernel
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: fe7378be-fa53-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000039
      notes: This condition checks the file /etc/logrotate.d/vmkernel and verifies
        that the option compress is enabled.
- MiqPolicy:
    name: 6353b57e-fa53-11de-83ca-005056ba0614
    description: Settings - vmksummary Compress Option
    expression:
    towhat: Host
    guid: 6353b57e-fa53-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the vmksummary log is compressed by default.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 510f7286-fa53-11de-83ca-005056ba0614
      description: Verify Compression Enabled in vmksummary
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: \s+compress
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmksummary
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 510f7286-fa53-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000038
      notes: This condition checks the file /etc/logrotate.d/vmksummary and verifies
        that the option compress is enabled.
- MiqPolicy:
    name: 4614d62e-fa52-11de-83ca-005056ba0614
    description: Settings - vmkwarning Compress Option
    expression:
    towhat: Host
    guid: 4614d62e-fa52-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the vmkwarning log is compressed by default.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: a51cbaba-fa52-11de-83ca-005056ba0614
      description: Verify Compression Enabled in vmkwarning
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: \s+compress
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmkwarning
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: a51cbaba-fa52-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000037
      notes: This condition checks the file /etc/logrotate.d/vmkwarning and verifies
        that the option compress is enabled.
- MiqPolicy:
    name: 994efe7e-18e6-11e0-88b4-005056a7184a
    description: ! 'Snapshots: Delete based on Count'
    expression:
    towhat: Vm
    guid: 994efe7e-18e6-11e0-88b4-005056a7184a
    created_by: admin
    updated_by: admin
    notes: This policy deletes the most recent snapshot when more that 2 snapshots
      exists
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_snapshot_complete
        description: VM Snapshot Create Complete
        guid: 7eb82802-135e-11e0-8706-005056a7184a
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: delete_most_recent_snapshot
        description: Delete Most Recent Snapshot
        guid: 7f6e2f8a-135e-11e0-8706-005056a7184a
        action_type: default
        options: {}
    Condition:
    - name: 992035fc-18e7-11e0-88b4-005056a7184a
      description: Check for more than 2 snapshots
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          ! '&gt;':
            value: '2'
            field: Vm-v_total_snapshots
        context_type:
      towhat: Vm
      file_mtime:
      guid: 992035fc-18e7-11e0-88b4-005056a7184a
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000075
      notes: Checks to see if more than 2 snapshots exist
- MiqPolicy:
    name: cf87e7fc-99d8-11e1-a4bf-005056b057a8
    description: ! 'Snapshots: limit to max of 2'
    expression:
    towhat: Vm
    guid: cf87e7fc-99d8-11e1-a4bf-005056b057a8
    created_by: admin
    updated_by: admin
    notes: This policy prevents a vm from starting if there are more than 2 snapshots.
      If this number is exceeded, the vm is not allowed to start and the vm annotations
      are updated in the VC
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 8d6ebd90-99d9-11e1-a4bf-005056b057a8
        description: ! 'VM Attribute: Max Snapshots'
        guid: 8d6ebd90-99d9-11e1-a4bf-005056b057a8
        action_type: set_custom_attribute
        options:
          :value: Snapshot Limit Exceeded
          :attribute: EVM Policy
    Condition:
    - name: 9db4783a-99d8-11e1-a4bf-005056b057a8
      description: Snapshot Count &gt;=3
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          ! '&gt;=':
            count: Vm.snapshots
            value: '3'
        context_type:
      towhat: Vm
      file_mtime:
      guid: 9db4783a-99d8-11e1-a4bf-005056b057a8
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000079
      notes: This condition checks to see if 3 or more snapshots exist
- MiqPolicy:
    name: 98557866-d2ee-11de-b4f6-0050568a547d
    description: ! 'Tag: Host Workload - DMZ'
    expression:
    towhat: Host
    guid: 98557866-d2ee-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policy will automatically apply a DMZ tag to a host if it has access
      to the external vlan
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: host_scan_complete
        description: Host Analysis Complete
        guid: ffcfb368-455d-11de-86a0-005056a81f62
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 330828a4-d2ef-11de-b4f6-0050568a547d
        description: Tag as DMZ
        guid: 330828a4-d2ef-11de-b4f6-0050568a547d
        action_type: tag
        options:
          :tags:
          - /managed/network_location/dmz
    Condition:
    - name: ed3edf84-d2ee-11de-b4f6-0050568a547d
      description: Host - DMZ vlan check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              IS NOT NULL:
                field: Host.lans-created_on
            search:
              INCLUDES:
                value: External
                field: Host.lans-name
      towhat: Host
      file_mtime:
      guid: ed3edf84-d2ee-11de-b4f6-0050568a547d
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000017
      notes:
- MiqPolicy:
    name: 0c2517d8-1ea2-11e0-8e71-005056910000
    description: ! 'Tag: VM Inherit Cluster Location Tag'
    expression:
    towhat: Vm
    guid: 0c2517d8-1ea2-11e0-8e71-005056910000
    created_by: admin
    updated_by: admin
    notes: This policy allows a vm to inherit the location tag of it's parent cluster
      on creation or completion of analysis
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_create
        description: VM Create Complete
        guid: 4c0b4f12-37c0-11df-b567-005056a40709
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 60e5d690-1ea2-11e0-8e71-005056910000
        description: ! 'Tag: Inherit Cluster Location Tag'
        guid: 60e5d690-1ea2-11e0-8e71-005056910000
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - location
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: f7b8361e-1139-11e1-9333-005056af009e
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 60e5d690-1ea2-11e0-8e71-005056910000
        description: ! 'Tag: Inherit Cluster Location Tag'
        guid: 60e5d690-1ea2-11e0-8e71-005056910000
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - location
    Condition: []
- MiqPolicy:
    name: 66fbec86-d2ef-11de-b4f6-0050568a547d
    description: ! 'Tag: VM Workload - DMZ'
    expression:
    towhat: Vm
    guid: 66fbec86-d2ef-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policy will automatically apply a DMZ tag to a vm if it has access
      to the external vlan
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: f7b8361e-1139-11e1-9333-005056af009e
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: 330828a4-d2ef-11de-b4f6-0050568a547d
        description: Tag as DMZ
        guid: 330828a4-d2ef-11de-b4f6-0050568a547d
        action_type: tag
        options:
          :tags:
          - /managed/network_location/dmz
    Condition:
    - name: 8a975658-d2ef-11de-b4f6-0050568a547d
      description: VM - DMZ check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              IS NOT NULL:
                field: Vm.lans-created_on
            search:
              INCLUDES:
                value: External
                field: Vm.lans-name
      towhat: Vm
      file_mtime:
      guid: 8a975658-d2ef-11de-b4f6-0050568a547d
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000018
      notes:
- MiqPolicy:
    name: 07cea762-3d1b-11df-a7e9-005056a40709
    description: ! 'Tag: VM if Analysis not successful'
    expression:
    towhat: Vm
    guid: 07cea762-3d1b-11df-a7e9-005056a40709
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_abort
        description: VM Analysis Failure
        guid: 4c48a6fa-37c0-11df-b567-005056a40709
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: fc7f2dde-3d22-11df-a7e9-005056a40709
        description: Tag VM that Fails Analysis
        guid: fc7f2dde-3d22-11df-a7e9-005056a40709
        action_type: tag
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          - :value: ''
            :oid: ''
            :var_type: &lt;None&gt;
          :tags:
          - /managed/operations/analysis_failed
    Condition: []
- MiqPolicy:
    name: 0ce6cf38-3d2d-11df-a7e9-005056a40709
    description: ! 'Tag: VM on Successful Analysis'
    expression:
    towhat: Vm
    guid: 0ce6cf38-3d2d-11df-a7e9-005056a40709
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: f7b8361e-1139-11e1-9333-005056af009e
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: cd2f3222-3d2c-11df-a7e9-005056a40709
        description: Tag VM after Successful Analysis
        guid: cd2f3222-3d2c-11df-a7e9-005056a40709
        action_type: tag
        options:
          :tags:
          - /managed/operations/analysis_success
    Condition: []
- MiqPolicy:
    name: b968f0a0-3d2e-11df-a7e9-005056a40709
    description: ! 'Tag: VM that Requires Analysis'
    expression:
    towhat: Vm
    guid: b968f0a0-3d2e-11df-a7e9-005056a40709
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: a4ccd026-3d2e-11df-a7e9-005056a40709
        description: Tag VM that Requires Analysis
        guid: a4ccd026-3d2e-11df-a7e9-005056a40709
        action_type: tag
        options:
          :tags:
          - /managed/operations/analysis_required
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_create
        description: VM Create Complete
        guid: 4c0b4f12-37c0-11df-b567-005056a40709
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: a4ccd026-3d2e-11df-a7e9-005056a40709
        description: Tag VM that Requires Analysis
        guid: a4ccd026-3d2e-11df-a7e9-005056a40709
        action_type: tag
        options:
          :tags:
          - /managed/operations/analysis_required
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_reset
        description: VM Reset
        guid: 4c1b8a3a-37c0-11df-b567-005056a40709
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: a4ccd026-3d2e-11df-a7e9-005056a40709
        description: Tag VM that Requires Analysis
        guid: a4ccd026-3d2e-11df-a7e9-005056a40709
        action_type: tag
        options:
          :tags:
          - /managed/operations/analysis_required
    Condition: []
- MiqPolicy:
    name: ccadf9fa-fa56-11de-83ca-005056ba0614
    description: Time Keeping - NTP Configured to Use Loopback Adapter
    expression:
    towhat: Host
    guid: ccadf9fa-fa56-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that NTP performs all name resolutions via a loopback
      network.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 2b9bb8b2-fa57-11de-83ca-005056ba0614
      description: NTP Configured to Use Loopback Adapter
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*restrict\s+127\.0\.0\.1
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 2b9bb8b2-fa57-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000036
      notes: This condition checks the file /etc/ntp.conf and verifies that the restrict
        parameter's value is set to 127.0.0.1.
- MiqPolicy:
    name: ebc02cea-fa57-11de-83ca-005056ba0614
    description: Time Keeping - Restrict Access for Machines without Loopback
    expression:
    towhat: Host
    guid: ebc02cea-fa57-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that only non-loopback machines can access the NTP
      service.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: ddc26260-fa58-11de-83ca-005056ba0614
      description: Access Restricted for Machines without Loopback
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*restrict\s+default\s+kod\s+nomodify\s+notrap
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: ddc26260-fa58-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000035
      notes: This condition checks the file /etc/ntp.conf and verifies that the line
        "restrict default kod nomodify notrap" exists.
- MiqPolicy:
    name: 3819638c-fa57-11de-83ca-005056ba0614
    description: Timekeeping - Drift Enabled
    expression:
    towhat: Host
    guid: 3819638c-fa57-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that NTP's driftfile support is enabled.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 71fae5da-fa57-11de-83ca-005056ba0614
      description: Verify NTP Uses a Driftfile
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*driftfile\s+\/var\/lib\/ntp\/drift
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 71fae5da-fa57-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000034
      notes: This condition checks the file /etc/ntp.conf and verifies that the driftfile
        parameter exists.
- MiqPolicy:
    name: c4396f3a-fa55-11de-83ca-005056ba0614
    description: Timekeeping - Minimum of 3 NTP Servers Defined in hosts
    expression:
    towhat: Host
    guid: c4396f3a-fa55-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that a minimum of 3 NTP servers are defined in the
      local hosts file.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 2698c39c-fa56-11de-83ca-005056ba0614
      description: Verify 3 NTP Servers Defined in hosts File
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              RUBY:
                value: ! "count = 0\ncontext.each_line { |line|                              #
                  Break up the input by lines\n  count += 1 if line =~ /^[^#]*NTP/i
                  \  # Increment Count if line matches our regular expression\n}\nreturn
                  true if count &gt;= 3\nreturn false\n"
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/hosts
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 2698c39c-fa56-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000033
      notes: ! 'This conditions checks the file /etc/hosts and veries that there are
        at least 3 uncommented lines that reference ntp servers. The included expression
        can be modified to match the appropriate values for the ntp servers for your
        environment.

'
- MiqPolicy:
    name: a6c2a51e-fa57-11de-83ca-005056ba0614
    description: Timekeeping - Minimum of 3 NTP Servers Defined in ntp.conf
    expression:
    towhat: Host
    guid: a6c2a51e-fa57-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that a minimum of 3 servers are defined in the NTP
      configuration.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 03c821bc-fa58-11de-83ca-005056ba0614
      description: Verify 3 NTP Servers Defined in ntp.conf
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              RUBY:
                value: ! "count = 0\ncontext.each_line { |line|                              #
                  Break up the input by lines\n  count += 1 if line =~ /^[^#]*server\\s+[0-9A-Za-z]+/
                  \  # Increment Count if line matches our regular expression\n}\nreturn
                  true if count &gt;= 3\nreturn false"
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 03c821bc-fa58-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000032
      notes: This condition checks the file /etc/ntp.conf and verifies that a minimum
        of three ntp servers are defined.
- MiqPolicy:
    name: 8d4a7bee-fa56-11de-83ca-005056ba0614
    description: Timekeeping - Minimum of 3 NTP Servers defined in step-tickers
    expression:
    towhat: Host
    guid: 8d4a7bee-fa56-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that a minimum of 3 servers are defined in the NTP
      step-tickers configuration.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 0806448a-fa57-11de-83ca-005056ba0614
      description: Verify 3 NTP Servers Defined in step-tickers File
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              RUBY:
                value: ! "count = 0\ncontext.each_line { |line|                              #
                  Break up the input by lines\n  count += 1 if line =~ /^[^#]*server\\s+[0-9A-Za-z]+/
                  \  # Increment Count if line matches our regular expression\n}\nreturn
                  true if count &gt;= 3\nreturn false\n"
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp/step-tickers
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 0806448a-fa57-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000023
      notes: This condition checks the file /etc/ntp/step-tickers and verifies that
        a minimum of three ntp servers are defined.
- MiqPolicy:
    name: 4ed279b2-fa55-11de-83ca-005056ba0614
    description: Timekeeping - NTP Service Running
    expression:
    towhat: Host
    guid: 4ed279b2-fa55-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the NTP servers is configured to automatically
      start.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 9a08d21e-fa55-11de-83ca-005056ba0614
      description: Verify NTP is Running
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              INCLUDES:
                value: '3'
                field: Host.host_services-enable_run_levels
            search:
              =:
                value: ntpd
                field: Host.host_services-name
      towhat: Host
      file_mtime:
      guid: 9a08d21e-fa55-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000031
      notes: This condition verifies that the run level of the service ntpd is set
        to three.
- MiqPolicy:
    name: a8e0ef7c-fa48-11de-83ca-005056ba0614
    description: Use sudo aliases
    expression:
    towhat: Host
    guid: a8e0ef7c-fa48-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that user aliases are enabled in the configuration
      of the sudo command.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 99496ebc-fa49-11de-83ca-005056ba0614
      description: Aliases are being used for sudo authorization
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*User_Alias
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/sudoers
                field: Host.filesystems-name
      towhat: Host
      file_mtime:
      guid: 99496ebc-fa49-11de-83ca-005056ba0614
      filename:
      applies_to_exp:
      miq_policy_id: 10000000000030
      notes: This condition checks the file /etc/sudoers and verifies that the parameter
        "User_Alias" is defined.
- MiqPolicy:
    name: 2cd19756-c1ec-11e1-ae68-000c29cc1a4c
    description: VMWare SHG v4.x &amp; v5.x - VMX01 - Prevent virtual disk shrinking.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: VMware
          field: Vm-vendor
      context_type:
    towhat: Vm
    guid: 2cd19756-c1ec-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMWare SHG v4.x &amp; v5.x - VMX01 - Prevent virtual disk shrinking. R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 11564bce-c1ed-11e1-ae68-000c29cc1a4c
      description: VMWare SHG v4.x - VMX01 - Prevent virtual disk shrinking
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.diskShrink.disable
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.diskWiper.disable
        context_type:
      towhat: Vm
      file_mtime:
      guid: 11564bce-c1ed-11e1-ae68-000c29cc1a4c
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            value: '4'
            field: Vm.host-vmm_version
        context_type:
      miq_policy_id: 13
      notes: VMWare SHG v4.x - VMX01 - Prevent virtual disk shrinking R1
    - name: d4bd19f4-d7d6-11e1-b3e5-000c2999f7f1
      description: VMWare SHG v5.x - VMX01 - Prevent virtual disk shrinking
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              =:
                field: Vm.advanced_settings-value
                value: 'true'
            search:
              =:
                field: Vm.advanced_settings-name
                value: isolation.tools.diskWiper.disable
        context_type:
      towhat: Vm
      file_mtime:
      guid: d4bd19f4-d7d6-11e1-b3e5-000c2999f7f1
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Vm.host-vmm_version
            value: '5'
        context_type:
      miq_policy_id: 13
      notes: VMWare SHG v5.x - VMX01 - Prevent virtual disk shrinking R1
- MiqPolicy:
    name: 774404fc-c1c1-11e1-ae68-000c29cc1a4c
    description: VMWare SHG v4.x &amp; v5.x - VMX22 - Avoid using independent nonpersistent
      disks.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: VMware
          field: Vm-vendor
      context_type:
    towhat: Vm
    guid: 774404fc-c1c1-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMWare SHG v4.x &amp; v5.x - VMX22 - Avoid using independent nonpersistent
      disks.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: b6c3548e-c1c1-11e1-ae68-000c29cc1a4c
      description: VMWare SHG v4.x &amp; v5.x - VMX22 - Avoid using independent nonpersistent
        disks.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkcount:
              =:
                value: '0'
                field: &lt;count&gt;
            search:
              INCLUDES:
                value: independent_nonpersistent
                field: Vm.hardware.disks-mode
        context_type:
      towhat: Vm
      file_mtime:
      guid: b6c3548e-c1c1-11e1-ae68-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 3
      notes: VMWare SHG v4.x &amp; v5.x - VMX22 - Avoid using independent nonpersistent
        disks. R1
- MiqPolicy:
    name: 5e3a568e-cfe3-11e1-986c-000c29cc1a4c
    description: VMWare SHG v4.x &amp; v5.x - VSH05 - Install VMware vCenter Server using
      a service account
    expression: !ruby/object:MiqExpression
      exp:
        CONTAINS:
          field: Vm.win32_services-name
          value: vpxd
      context_type:
    towhat: Vm
    guid: 5e3a568e-cfe3-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMWare SHG v4.x &amp; v5.x - VSH05 - Install VMware vCenter Server using a
      service account R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 9e841928-cfe8-11e1-986c-000c29cc1a4c
      description: VMWare SHG v4.x &amp; v5.x - VSH05 - Install VMware vCenter Server
        using a service account
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION DOES NOT MATCH:
                field: Vm.win32_services-object_name
                value: \bLocalSystem
            search:
              =:
                field: Vm.win32_services-name
                value: vpxd
        context_type:
      towhat: Vm
      file_mtime:
      guid: 9e841928-cfe8-11e1-986c-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 4
      notes: VMWare SHG v4.x &amp; v5.x - VSH05 - Install VMware vCenter Server using
        a service account R1
- MiqPolicy:
    name: 17fce8ee-c39f-11e1-aed6-000c29cc1a4c
    description: VMware SHG - VMX24 - Disable certain unexposed features.
    expression:
    towhat: Vm
    guid: 17fce8ee-c39f-11e1-aed6-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG - VMX24 - Disable certain unexposed features.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 98427d34-c39f-11e1-aed6-000c29cc1a4c
      description: Disable certain unexposed features
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.unity.push.update.disable
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.ghi.launchmenu.change
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.memSchedFakeSampleStats.disable
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.getCreds.disable
        context_type:
      towhat: Vm
      file_mtime:
      guid: 98427d34-c39f-11e1-aed6-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 1
      notes:
- MiqPolicy:
    name: e5871bee-d435-11e1-9935-000c2999f7f1
    description: VMware SHG v4.x &amp; v5.x - HCN05 - Disable DCUI to prevent all local
      administrative control
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: ESXi
          field: Host-vmm_product
      context_type:
    towhat: Host
    guid: e5871bee-d435-11e1-9935-000c2999f7f1
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x &amp; v5.x - HCN05 - Disable DCUI to prevent all local administrative
      control R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 0f6761b2-d436-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x &amp; v5.x - HCN05 - Disable DCUI to prevent all local
        administrative control
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: 'false'
                field: Host.host_services-running
            search:
              =:
                value: DCUI
                field: Host.host_services-name
        context_type:
      towhat: Host
      file_mtime:
      guid: 0f6761b2-d436-11e1-9935-000c2999f7f1
      filename:
      applies_to_exp:
      miq_policy_id: 14
      notes: VMware SHG v4.x &amp; v5.x - HCN05 - Disable DCUI to prevent all local administrative
        control R1
- MiqPolicy:
    name: 3a2acbde-d434-11e1-9935-000c2999f7f1
    description: VMware SHG v4.x &amp; v5.x - HCN06 - Disable Tech Support Mode unless
      needed for diagnostics and break-fix
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type:
    towhat: Host
    guid: 3a2acbde-d434-11e1-9935-000c2999f7f1
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x &amp; v5.x - HCN06 - Disable Tech Support Mode unless needed
      for diagnostics and break-fix R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: e35c1be0-d434-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x &amp; v5.x - HCN06 - Disable Tech Support Mode unless
        needed for diagnostics and break-fix
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                field: Host.host_services-running
                value: 'false'
            search:
              =:
                field: Host.host_services-name
                value: TSM
        context_type:
      towhat: Host
      file_mtime:
      guid: e35c1be0-d434-11e1-9935-000c2999f7f1
      filename:
      applies_to_exp:
      miq_policy_id: 15
      notes: VMware SHG v4.x &amp; v5.x - HCN06 - Disable Tech Support Mode unless needed
        for diagnostics and break-fix R1
- MiqPolicy:
    name: 36021318-d435-11e1-9935-000c2999f7f1
    description: VMware SHG v4.x &amp; v5.x - HCN07 - Set a timeout for Tech Support Mode.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type:
    towhat: Host
    guid: 36021318-d435-11e1-9935-000c2999f7f1
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x &amp; v5.x - HCN07 - Set a timeout for Tech Support Mode. R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 9f3b5376-d435-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x - HCN07 - Set a timeout for Tech Support Mode.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            FIND:
              checkall:
                =:
                  field: Host.advanced_settings-value
                  value: '0'
              search:
                =:
                  field: Host.advanced_settings-name
                  value: UserVars.TSMTimeOut
        context_type:
      towhat: Host
      file_mtime:
      guid: 9f3b5376-d435-11e1-9935-000c2999f7f1
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Host-vmm_version
            value: '4'
        context_type:
      miq_policy_id: 5
      notes: VMware SHG v4.x - HCN07 - Set a timeout for Tech Support Mode. R1
    - name: fc017d86-d7cf-11e1-b3e5-000c2999f7f1
      description: VMware SHG v5.x - HCN07 - Set a timeout for Tech Support Mode.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            FIND:
              checkall:
                =:
                  value: '0'
                  field: Host.advanced_settings-value
              search:
                =:
                  value: UserVars.ESXiShellTimeOut
                  field: Host.advanced_settings-name
        context_type:
      towhat: Host
      file_mtime:
      guid: fc017d86-d7cf-11e1-b3e5-000c2999f7f1
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            value: '5'
            field: Host-vmm_version
        context_type:
      miq_policy_id: 5
      notes: VMware SHG v5.x - HCN07 - Set a timeout for Tech Support Mode. R1
- MiqPolicy:
    name: 4dadd9bc-d443-11e1-9935-000c2999f7f1
    description: VMware SHG v4.x &amp; v5.x - HLG01 - Remote syslog should be configured
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: ESXi
          field: Host-vmm_product
      context_type:
    towhat: Host
    guid: 4dadd9bc-d443-11e1-9935-000c2999f7f1
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x &amp; v5.x - HLG01 - Remote syslog should be configured
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: b60247d2-d443-11e1-9935-000c2999f7f1
      description: VMware SHG v5.x - HLG01 - Remote syslog should be configured
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              IS NOT EMPTY:
                value: ''
                field: Host.advanced_settings-value
            search:
              =:
                value: Syslog.global.logHost
                field: Host.advanced_settings-name
        context_type:
      towhat: Host
      file_mtime:
      guid: b60247d2-d443-11e1-9935-000c2999f7f1
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Host-vmm_version
            value: '5'
        context_type:
      miq_policy_id: 6
      notes: VMware SHG - HLG01 - Remote syslog should be configured VERSION 5.x ONLY
        R1
    - name: 456a882a-d7ce-11e1-b3e5-000c2999f7f1
      description: VMware SHG v4.x - HLG01 - Remote syslog should be configured
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              IS NOT EMPTY:
                field: Host.advanced_settings-value
                value: ''
            search:
              =:
                field: Host.advanced_settings-name
                value: Syslog.Remote.Hostname
        context_type:
      towhat: Host
      file_mtime:
      guid: 456a882a-d7ce-11e1-b3e5-000c2999f7f1
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Host-vmm_version
            value: '4'
        context_type:
      miq_policy_id: 6
      notes: VMware SHG - HLG01 - Remote syslog should be configured VERSION 4.x ONLY
        R1
- MiqPolicy:
    name: 197d032e-d016-11e1-986c-000c29cc1a4c
    description: ! "VMware SHG v4.x &amp; v5.x - NCN03 - Ensure that the â\x80\x9CMAC
      Address Changeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: ESXi
          field: Host-vmm_product
      context_type:
    towhat: Host
    guid: 197d032e-d016-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: ! "VMware SHG v4.x &amp; v5.x - NCN03 - Ensure that the â\x80\x9CMAC Address
      Changeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D R1"
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 3531486e-d016-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x &amp; v5.x - NCN03 - Ensure that the â\x80\x9CMAC
        Address Changeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: 'false'
                field: Host.lans-mac_changes
            search:
              IS NOT NULL:
                value: ''
                field: Host.lans-name
        context_type:
      towhat: Host
      file_mtime:
      guid: 3531486e-d016-11e1-986c-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 7
      notes: ! "VMware SHG v4.x &amp; v5.x - NCN03 - Ensure that the â\x80\x9CMAC Address
        Changeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D R1"
- MiqPolicy:
    name: e4d7e0e6-d00e-11e1-986c-000c29cc1a4c
    description: ! "VMware SHG v4.x &amp; v5.x - NCN04 - Ensure that the â\x80\x9CForged
      Transmitsâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type:
    towhat: Host
    guid: e4d7e0e6-d00e-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: ! "VMware SHG v4.x &amp; v5.x - NCN04 - Ensure that the â\x80\x9CForged Transmitsâ\x80\x9D
      policy is set to â\x80\x9Creject.â\x80\x9D R1"
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: ed54d6d8-d00f-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x &amp; v5.x - NCN04 - Ensure that the â\x80\x9CForged
        Transmitsâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: 'false'
                field: Host.lans-forged_transmits
            search:
              IS NOT NULL:
                value: ''
                field: Host.lans-name
        context_type:
      towhat: Host
      file_mtime:
      guid: ed54d6d8-d00f-11e1-986c-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 8
      notes: ! "VMware SHG v4.x &amp; v5.x - NCN04 - Ensure that the â\x80\x9CForged Transmitsâ\x80\x9D
        policy is set to â\x80\x9Creject.â\x80\x9D R1"
- MiqPolicy:
    name: d7ed01f4-d00e-11e1-986c-000c29cc1a4c
    description: ! "VMware SHG v4.x &amp; v5.x - NCN05 -Ensure that the â\x80\x9CPromiscuous
      Modeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type:
    towhat: Host
    guid: d7ed01f4-d00e-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: ! "VMware SHG v4.x &amp; v5.x - NCN05 -Ensure that the â\x80\x9CPromiscuous
      Modeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D R1"
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: abb1772c-d00f-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x &amp; v5.x - NCN05 -Ensure that the â\x80\x9CPromiscuous
        Modeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                field: Host.lans-allow_promiscuous
                value: 'false'
            search:
              IS NOT NULL:
                field: Host.lans-name
                value: ''
        context_type:
      towhat: Host
      file_mtime:
      guid: abb1772c-d00f-11e1-986c-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 9
      notes: ! "VMware SHG v4.x &amp; v5.x - NCN05 -Ensure that the â\x80\x9CPromiscuous
        Modeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D R1"
- MiqPolicy:
    name: 86c84f3a-d005-11e1-986c-000c29cc1a4c
    description: VMware SHG v4.x &amp; v5.x - NCN10 - Ensure that port groups are configured
      with a clear network label
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type:
    towhat: Host
    guid: 86c84f3a-d005-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x &amp; v5.x - NCN10 - Ensure that port groups are configured
      with a clear network label R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: e1c666a0-d006-11e1-986c-000c29cc1a4c
      description: VMware SHG v4.x &amp; v5.x - NCN10 - Ensure that port groups are configured
        with a clear network label
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - FIND:
              checkcount:
                =:
                  field: &lt;count&gt;
                  value: '0'
              search:
                IS NULL:
                  field: Host.lans-name
                  value: ''
          - FIND:
              checkcount:
                =:
                  value: '0'
                  field: &lt;count&gt;
              search:
                IS EMPTY:
                  value: ''
                  field: Host.lans-name
        context_type:
      towhat: Host
      file_mtime:
      guid: e1c666a0-d006-11e1-986c-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 11
      notes: VMware SHG v4.x &amp; v5.x - NCN10 - Ensure that port groups are configured
        with a clear network label R1
- MiqPolicy:
    name: cee396f8-c1f0-11e1-ae68-000c29cc1a4c
    description: VMware SHG v4.x &amp; v5.x - VMX02 - Prevent other users from spying
      on administrator remote consoles.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: VMware
          field: Vm-vendor
      context_type:
    towhat: Vm
    guid: cee396f8-c1f0-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x &amp; v5.x - VMX02 - Prevent other users from spying on administrator
      remote consoles.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 71089c6c-c1f1-11e1-ae68-000c29cc1a4c
      description: VMware SHG v4.x &amp; v5.x - VMX02 - Prevent other users from spying
        on administrator remote consoles.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              =:
                value: '1'
                field: Vm.advanced_settings-value
            search:
              =:
                value: RemoteDisplay.maxConnections
                field: Vm.advanced_settings-name
        context_type:
      towhat: Vm
      file_mtime:
      guid: 71089c6c-c1f1-11e1-ae68-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 2
      notes: VMware SHG v4.x &amp; v5.x - VMX02 - Prevent other users from spying on administrator
        remote consoles. R1
- MiqPolicy:
    name: 1d60a788-c1f3-11e1-ae68-000c29cc1a4c
    description: VMware SHG v4.x &amp; v5.x - VMX11 Prevent unauthorized removal, connection
      and modification of devices
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - =:
            field: Vm-vendor
            value: VMware
        - STARTS WITH:
            value: '5'
            field: Vm.host-vmm_version
      context_type:
    towhat: Vm
    guid: 1d60a788-c1f3-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x &amp; v5.x - VMX11 Prevent unauthorized removal, connection
      and modification of devices
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 728e7050-c1f3-11e1-ae68-000c29cc1a4c
      description: VMware SHG v5.x - VMX11 Prevent unauthorized removal, connection
        and modification of devices
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              =:
                value: 'true'
                field: Vm.advanced_settings-value
            search:
              =:
                value: isolation.device.connectable.disable
                field: Vm.advanced_settings-name
        context_type:
      towhat: Vm
      file_mtime:
      guid: 728e7050-c1f3-11e1-ae68-000c29cc1a4c
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Vm.host-vmm_version
            value: '5'
        context_type:
      miq_policy_id: 12
      notes: VMware SHG v5.x - VMX11 Prevent unauthorized removal, connection and
        modification of devices R1
    - name: aaa64a08-d7d8-11e1-b3e5-000c2999f7f1
      description: VMware SHG v4.x - VMX11 Prevent unauthorized removal, connection
        and modification of devices
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  value: 'true'
                  field: Vm.advanced_settings-value
              search:
                =:
                  value: isolation.device.connectable.disable
                  field: Vm.advanced_settings-name
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.device.edit.disable
        context_type:
      towhat: Vm
      file_mtime:
      guid: aaa64a08-d7d8-11e1-b3e5-000c2999f7f1
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            value: '4'
            field: Vm.host-vmm_version
        context_type:
      miq_policy_id: 12
      notes: VMware SHG v4.x - VMX11 Prevent unauthorized removal, connection and
        modification of devices R1
- MiqPolicy:
    name: 769b4b1e-c1f8-11e1-ae68-000c29cc1a4c
    description: VMware SHG v4.x &amp; v5.x - VMX30 - Disable remote operations within
      the guest.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: VMware
          field: Vm-vendor
      context_type:
    towhat: Vm
    guid: 769b4b1e-c1f8-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x &amp; v5.x - VMX30 - Disable remote operations within the guest.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 8b7f39d2-c1f8-11e1-ae68-000c29cc1a4c
      description: VMware SHG v4.x - VMX30 - Disable remote operations within the
        guest.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              =:
                field: Vm.advanced_settings-value
                value: 'false'
            search:
              =:
                field: Vm.advanced_settings-name
                value: guest.commands.enabled
        context_type:
      towhat: Vm
      file_mtime:
      guid: 8b7f39d2-c1f8-11e1-ae68-000c29cc1a4c
      filename:
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            value: '4'
            field: Vm.host-vmm_version
        context_type:
      miq_policy_id: 16
      notes: VMware SHG v4.x - VMX30 - Disable remote operations within the guest.
        R1
- MiqPolicy:
    name: e99a4c3e-d00b-11e1-986c-000c29cc1a4c
    description: VMware SHG v4x. &amp; v5.x - NCN11 - Ensure that all vSwitches have a
      clear network label.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: ESXi
          field: Host-vmm_product
      context_type:
    towhat: Host
    guid: e99a4c3e-d00b-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4x. &amp; v5.x - NCN11 - Ensure that all vSwitches have a clear
      network label. R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: {}
    Condition:
    - name: 5ca4abca-d00c-11e1-986c-000c29cc1a4c
      description: VMware SHG v4x. &amp; v5.x - NCN11 - Ensure that all vSwitches have
        a clear network label.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - FIND:
              checkall:
                IS NOT NULL:
                  value: ''
                  field: Host.hardware.ports-device_name
              search:
                =:
                  value: ethernet
                  field: Host.hardware.ports-device_type
          - FIND:
              checkall:
                IS NOT EMPTY:
                  field: Host.hardware.ports-device_name
                  value: ''
              search:
                =:
                  field: Host.hardware.ports-device_type
                  value: ethernet
        context_type:
      towhat: Host
      file_mtime:
      guid: 5ca4abca-d00c-11e1-986c-000c29cc1a4c
      filename:
      applies_to_exp:
      miq_policy_id: 10
      notes: VMware SHG v4x. &amp; v5.x - NCN11 - Ensure that all vSwitches have a clear
        network label. R1
- MiqPolicy:
    name: d4640a18-e15d-11e1-acfa-005056b25af6
    description: powervm
    expression:
    towhat: Vm
    guid: d4640a18-e15d-11e1-acfa-005056b25af6
    created_by: admin
    updated_by: admin
    notes:
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 404b4630-21a8-11e2-b47a-0050568b19a3
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: b0138b70-e15d-11e1-8744-005056b25af6
        description: powerVM
        guid: b0138b70-e15d-11e1-8744-005056b25af6
        action_type: custom_automation
        options:
          :ae_message: create
          :ae_request: powerVM
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_poweroff
        description: VM Power Off
        guid: 48beeadc-ae7c-11e1-a76f-005056b25af6
        event_type: Default
        definition:
        default:
        enabled:
      MiqAction:
        name: b0138b70-e15d-11e1-8744-005056b25af6
        description: powerVM
        guid: b0138b70-e15d-11e1-8744-005056b25af6
        action_type: custom_automation
        options:
          :ae_message: create
          :ae_request: powerVM
    Condition: []</pre></div><div class="section" title="3.15.4. Profiles.yaml"><div class="titlepage"><div><div><h3 class="title"><a id="_profiles_yaml"></a>3.15.4. Profiles.yaml</h3></div></div></div><p>Link: <a class="ulink" href="../cloudforms/Control_Import/Profiles.yaml" target="_top">Profiles.yaml</a></p><p>Source:</p><pre class="screen">---
- MiqPolicySet:
    name: 612b936c-3d2d-11df-a7e9-005056a40709
    description: ! 'ACTIVE - Analysis: Manage VMs'
    set_type: MiqPolicySet
    guid: 612b936c-3d2d-11df-a7e9-005056a40709
    read_only:
    set_data:
      :notes: ! '1)Create a new Tag Category called Operations (Show in EVM Console
        and Single Value)

        2)Create the following Tags under this new Operations Category (analysis_failed,
        analysis_required, analysis_success)

        3)Create Global Filters for VMs for Analysis Failed and Analysis Required
        to easily find tagged VMs.

        4)Set up a Schedule to run as desired that will process the VMs that currently
        match the Global Filter. Ex: Analyze all VMs that are tagged with "Analysis
        Required".


'
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 07cea762-3d1b-11df-a7e9-005056a40709
      description: ! 'Tag: VM if Analysis not successful'
      expression:
      towhat: Vm
      guid: 07cea762-3d1b-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_abort
          description: VM Analysis Failure
          guid: 4c48a6fa-37c0-11df-b567-005056a40709
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: fc7f2dde-3d22-11df-a7e9-005056a40709
          description: Tag VM that Fails Analysis
          guid: fc7f2dde-3d22-11df-a7e9-005056a40709
          action_type: tag
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :tags:
            - /managed/operations/analysis_failed
      Condition: []
    - name: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      description: ! 'Tag: VM on Successful Analysis'
      expression:
      towhat: Vm
      guid: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: cd2f3222-3d2c-11df-a7e9-005056a40709
          description: Tag VM after Successful Analysis
          guid: cd2f3222-3d2c-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_success
      Condition: []
    - name: b968f0a0-3d2e-11df-a7e9-005056a40709
      description: ! 'Tag: VM that Requires Analysis'
      expression:
      towhat: Vm
      guid: b968f0a0-3d2e-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reset
          description: VM Reset
          guid: 4c1b8a3a-37c0-11df-b567-005056a40709
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      Condition: []
    - name: ! 'Do Not Analyze '
      description: ! 'Analysis: Prevent Analysis of Selected VMs'
      expression:
      towhat: Vm
      guid: 3a7959c0-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not
        Analyze '
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: request_vm_scan
          description: VM Analysis Request
          guid: e3292c46-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: {}
      Condition:
      - name: Do Not Analyze
        description: VM classified as DO_NOT_ANALYZE
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-exclusions
              value: do_not_analyze
          context_type:
        towhat: Vm
        file_mtime:
        guid: 39ff4444-08e2-11de-829f-005056a164b2
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000001
        notes:
- MiqPolicySet:
    name: 74de8372-bbd6-11e1-a4a4-005056b25af6
    description: ACTIVE - Prevent PowerOn of Quarantined VMs
    set_type: MiqPolicySet
    guid: 74de8372-bbd6-11e1-a4a4-005056b25af6
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: f4f0e916-bbd5-11e1-a4a4-005056b25af6
      description: Prevent PowerOn of Quarantined VM
      expression:
      towhat: Vm
      guid: f4f0e916-bbd5-11e1-a4a4-005056b25af6
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: request_vm_start
          description: VM Power On Request
          guid: 48b02c4a-ae7c-11e1-a76f-005056b25af6
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      Condition:
      - name: 1cbc27da-bbd6-11e1-ac0c-005056b25af6
        description: VM Tagged as Do Not PowerOn
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-exclusions
              value: do_not_power_on
          context_type:
        towhat: Vm
        file_mtime:
        guid: 1cbc27da-bbd6-11e1-ac0c-005056b25af6
        filename:
        applies_to_exp:
        miq_policy_id:
        notes:
- MiqPolicySet:
    name: 3a78daca-99da-11e1-a4bf-005056b057a8
    description: ! 'ACTIVE - Snapshot Management: Max of 2'
    set_type: MiqPolicySet
    guid: 3a78daca-99da-11e1-a4bf-005056b057a8
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: cf87e7fc-99d8-11e1-a4bf-005056b057a8
      description: ! 'Snapshots: limit to max of 2'
      expression:
      towhat: Vm
      guid: cf87e7fc-99d8-11e1-a4bf-005056b057a8
      created_by: admin
      updated_by: admin
      notes: This policy prevents a vm from starting if there are more than 2 snapshots.
        If this number is exceeded, the vm is not allowed to start and the vm annotations
        are updated in the VC
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 8d6ebd90-99d9-11e1-a4bf-005056b057a8
          description: ! 'VM Attribute: Max Snapshots'
          guid: 8d6ebd90-99d9-11e1-a4bf-005056b057a8
          action_type: set_custom_attribute
          options:
            :value: Snapshot Limit Exceeded
            :attribute: EVM Policy
      Condition:
      - name: 9db4783a-99d8-11e1-a4bf-005056b057a8
        description: Snapshot Count &gt;=3
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '&gt;=':
              count: Vm.snapshots
              value: '3'
          context_type:
        towhat: Vm
        file_mtime:
        guid: 9db4783a-99d8-11e1-a4bf-005056b057a8
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000079
        notes: This condition checks to see if 3 or more snapshots exist
- MiqPolicySet:
    name: 98eea278-8b9f-11e0-b8fc-005056a40e59
    description: ACTIVE - VMs in DMZ NIC Check
    set_type: MiqPolicySet
    guid: 98eea278-8b9f-11e0-b8fc-005056a40e59
    read_only:
    set_data:
      :notes: This Policy Profile will check VM Network Adapter count and if &gt; 1 will
        Stop the VM. This will happen after VM Analysis is Complete or when the VM
        is Powered On.
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 69fbd202-8ba3-11e0-b8fc-005056a40e59
      description: DMZ - Shutdown VM after Analysis if it has more than 1 NIC
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: 'on'
            field: Vm-power_state
        context_type:
      towhat: Vm
      guid: 69fbd202-8ba3-11e0-b8fc-005056a40e59
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: evm_event
          description: Show EVM Event on Timeline
          guid: 16b1810c-44e8-11e0-acda-005056a40e59
          action_type: default
          options: {}
      Condition:
      - name: efcf3702-8b9e-11e0-b8fc-005056a40e59
        description: DMZ - VM has more than 1 NIC
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '&gt;':
              count: Vm.hardware.nics
              value: '1'
          context_type:
        towhat: Vm
        file_mtime:
        guid: efcf3702-8b9e-11e0-b8fc-005056a40e59
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000077
        notes:
    - name: 0de66508-8b9f-11e0-b8fc-005056a40e59
      description: DMZ - Shutdown VM after Starting if it has more than 1 NIC
      expression:
      towhat: Vm
      guid: 0de66508-8b9f-11e0-b8fc-005056a40e59
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: evm_event
          description: Show EVM Event on Timeline
          guid: 16b1810c-44e8-11e0-acda-005056a40e59
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: d91bbabc-b0be-11e1-b0dc-005056b057a8
          description: ! 'VM Attribute: Allowed NIC Count Exceeded'
          guid: d91bbabc-b0be-11e1-b0dc-005056b057a8
          action_type: set_custom_attribute
          options:
            :attribute: EVM Policy
            :value: Allowed NIC Limit Exceeded
      Condition:
      - name: efcf3702-8b9e-11e0-b8fc-005056a40e59
        description: DMZ - VM has more than 1 NIC
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '&gt;':
              count: Vm.hardware.nics
              value: '1'
          context_type:
        towhat: Vm
        file_mtime:
        guid: efcf3702-8b9e-11e0-b8fc-005056a40e59
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000077
        notes:
- MiqPolicySet:
    name: 820849ce-a7fb-11e0-abed-005056af0000
    description: ! 'Analysis: Do Not Analyze Active VDI VMs'
    set_type: MiqPolicySet
    guid: 820849ce-a7fb-11e0-abed-005056af0000
    read_only:
    set_data:
      :notes: This policy profile checks to see if a VDI vm is being actively used
        by a user. If a user is currently connected to the session, it will prevent
        the vm from being analyzed
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 1c4c7772-a7fb-11e0-abed-005056af0000
      description: Do Not Analyze Active VDI VMs
      expression:
      towhat: Vm
      guid: 1c4c7772-a7fb-11e0-abed-005056af0000
      created_by: admin
      updated_by: admin
      notes: This policy prevents analysis of a vm that has an active user session
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_start
          description: VM Analysis Start
          guid: 057b9baa-519c-11e0-8d82-005056af0000
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: {}
      Condition:
      - name: 0a50f750-a7fb-11e0-abed-005056af0000
        description: VM has an active session
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            =:
              value: 'true'
              field: Vm-has_active_vdi_session
          context_type:
        towhat: Vm
        file_mtime:
        guid: 0a50f750-a7fb-11e0-abed-005056af0000
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000007
        notes:
- MiqPolicySet:
    name: 43e76af6-3f8e-11e0-aaa0-00505688000a
    description: ! 'Analysis: Exclude Specially Tagged VMs'
    set_type: MiqPolicySet
    guid: 43e76af6-3f8e-11e0-aaa0-00505688000a
    read_only:
    set_data:
      :notes: Prevents the analysis of vms tagged as do not analyze
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: ! 'Do Not Analyze '
      description: ! 'Analysis: Prevent Analysis of Selected VMs'
      expression:
      towhat: Vm
      guid: 3a7959c0-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not
        Analyze '
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: request_vm_scan
          description: VM Analysis Request
          guid: e3292c46-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: {}
      Condition:
      - name: Do Not Analyze
        description: VM classified as DO_NOT_ANALYZE
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-exclusions
              value: do_not_analyze
          context_type:
        towhat: Vm
        file_mtime:
        guid: 39ff4444-08e2-11de-829f-005056a164b2
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000001
        notes:
- MiqPolicySet:
    name: 3872a0e8-50bc-11e0-880e-00505688000a
    description: ! 'Analysis: On VM Reconfiguration'
    set_type: MiqPolicySet
    guid: 3872a0e8-50bc-11e0-880e-00505688000a
    read_only:
    set_data:
      :notes: Triggers a VM analysis when a VM is reconfigured
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 2f2a1a1c-4806-11df-badc-005056a7121f
      description: ! 'Analysis: VM Reconfiguration'
      expression:
      towhat: Vm
      guid: 2f2a1a1c-4806-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Performs an analysis on any vm that has been reconfigured
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: {}
      Condition: []
- MiqPolicySet:
    name: 079d2408-44ef-11e0-99a6-00505688000a
    description: ! 'Analysis: VDI Login'
    set_type: MiqPolicySet
    guid: 079d2408-44ef-11e0-99a6-00505688000a
    read_only:
    set_data:
      :notes: This policy profile automatically analyzes a VDI session when a user
        logs in to it.
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 782068f8-44ee-11e0-99a6-00505688000a
      description: ! 'Analysis: VDI Login'
      expression:
      towhat: Vm
      guid: 782068f8-44ee-11e0-99a6-00505688000a
      created_by: admin
      updated_by: admin
      notes: This policy triggers an analysis of a VDI session when a user logs in
        to that session
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_vdi_login_session
          description: VDI Login Session
          guid: 15fc3cce-448a-11e0-9ad1-00505688000a
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: {}
      Condition: []
- MiqPolicySet:
    name: aa699b96-de34-11e1-9088-005056af009e
    description: Collect VDI User Information
    set_type: MiqPolicySet
    guid: aa699b96-de34-11e1-9088-005056af009e
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 57189108-d1d3-11e1-9ede-005056af009e
      description: Record Last RDP User
      expression:
      towhat: Vm
      guid: 57189108-d1d3-11e1-9ede-005056af009e
      created_by: admin
      updated_by: admin
      notes: ! 'When a user logs on to the VM through an RDP session, the file c:\rdp_login\rdp.log
        is automatically created by the logon script.


        A analysis profile should be set to retrieve this file and its content.


        This policy will automatically raise an automate event so the content of the
        file can be parsed and elements set as custom attributes of the VM '
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: e7da3b7a-1139-11e1-9333-005056af009e
          action_type: default
          options: {}
      Condition:
      - name: 5a4c3456-de30-11e1-9088-005056af009e
        description: Check for files starting with rep
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkcount:
                ! '&gt;=':
                  field: &lt;count&gt;
                  value: '1'
              search:
                INCLUDES:
                  field: Vm.filesystems-name
                  value: rdp
          context_type:
        towhat: Vm
        file_mtime:
        guid: 5a4c3456-de30-11e1-9088-005056af009e
        filename:
        applies_to_exp:
        miq_policy_id: 4
        notes:
    - name: d658fe5c-de2c-11e1-9088-005056af009e
      description: Collect Logged on User Info
      expression:
      towhat: Vm
      guid: d658fe5c-de2c-11e1-9088-005056af009e
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: e7da3b7a-1139-11e1-9333-005056af009e
          action_type: default
          options: {}
      Condition:
      - name: ab61c97a-de2e-11e1-9088-005056af009e
        description: Check files starting with nb
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkcount:
                ! '&gt;=':
                  value: '1'
                  field: &lt;count&gt;
              search:
                INCLUDES:
                  value: nb
                  field: Vm.filesystems-name
          context_type:
        towhat: Vm
        file_mtime:
        guid: ab61c97a-de2e-11e1-9088-005056af009e
        filename:
        applies_to_exp:
        miq_policy_id: 5
        notes:
- MiqPolicySet:
    name: e4bcd3de-2480-11e2-b7d5-005056b25af6
    description: ! 'Compliance Hosts: November 2012'
    set_type: MiqPolicySet
    guid: e4bcd3de-2480-11e2-b7d5-005056b25af6
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: de683aa6-fedf-11de-83dd-005056ba5e76
      description: Network - Mac Changes not Allowed
      expression:
      towhat: Host
      guid: de683aa6-fedf-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: This policy checks that MAC changes are not allowed on vSwitches and
        vLans.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 0a6eb332-fee0-11de-83dd-005056ba5e76
        description: Mac Changes Disabled in vSwitches
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.switches-mac_changes
        towhat: Host
        file_mtime:
        guid: 0a6eb332-fee0-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000028
        notes: This condition verifies that MAC changes are not allowed on vSwitches.
      - name: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
        description: Mac Changes Disabled in vLans
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.lans-mac_changes
        towhat: Host
        file_mtime:
        guid: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000028
        notes: This condition verifies that MAC changes are not allowed on vLans.
    - name: 61b355f2-fee1-11de-83dd-005056ba5e76
      description: Network - Forged Transmits Must Be Disabled
      expression:
      towhat: Host
      guid: 61b355f2-fee1-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: This policy insures that forged transmits are disabled on both vLans
        and vSwitches.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: f246e3e0-fee1-11de-83dd-005056ba5e76
        description: Forged Transmits Disabled in vLan
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.lans-forged_transmits
        towhat: Host
        file_mtime:
        guid: f246e3e0-fee1-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000022
        notes: This condition verifies that forged transmits are disabled on vlans.
      - name: a3ac5774-fee1-11de-83dd-005056ba5e76
        description: Forged Transmits Disabled in vSwitch
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.switches-forged_transmits
        towhat: Host
        file_mtime:
        guid: a3ac5774-fee1-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000022
        notes: This condition verifies that forged transmits are disabled on vSwitches.
- MiqPolicySet:
    name: 587352f0-fb88-11de-a067-005056ba0614
    description: ! 'Compliance: Hosts'
    set_type: MiqPolicySet
    guid: 587352f0-fb88-11de-a067-005056ba0614
    read_only:
    set_data:
      :notes: This policy profile validates that an ESX host meets the standard defined
        in VMWare's security hardening documentation
    mode: pr
    owner_type:
    owner_id:
    MiqPolicy:
    - name: eb84f288-fa39-11de-83ca-005056ba0614
      description: Protect Root File System Filling /home
      expression:
      towhat: Host
      guid: eb84f288-fa39-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /home directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 62447a1a-fa3a-11de-83ca-005056ba0614
        description: Protect Root File System Filling /home
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^[^#]*\/home
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/fstab
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 62447a1a-fa3a-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000019
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /home.
    - name: 04db603c-fa3a-11de-83ca-005056ba0614
      description: Firewall - Outgoing Security Level
      expression:
      towhat: Host
      guid: 04db603c-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only a defined set of outgoing TCP and UDP
        Ports are open.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: f0afd7d6-fa3a-11de-83ca-005056ba0614
        description: Valid Outgoing TCP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '902,427,443,27000,27010'
              field: Host-enabled_tcp_outbound_ports
        towhat: Host
        file_mtime:
        guid: f0afd7d6-fa3a-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000020
        notes: This condition verifies that the only open outgoing TCP ports are 427,443,902,27000,
          and 27010.
      - name: 1778fb28-fa44-11de-83ca-005056ba0614
        description: Valid Outgoing UDP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '427,123,902'
              field: Host-enabled_udp_outbound_ports
        towhat: Host
        file_mtime:
        guid: 1778fb28-fa44-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000020
        notes: This condition verifies that the only open outgoing UDP ports are 123,427,
          and 902.
    - name: af2d74ea-fa39-11de-83ca-005056ba0614
      description: Firewall - Incoming Security Level
      expression:
      towhat: Host
      guid: af2d74ea-fa39-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only a defined set of incoming TCP and UDP
        Ports are open.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: b4a0843a-fa43-11de-83ca-005056ba0614
        description: Valid Incoming UDP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '427'
              field: Host-enabled_udp_inbound_ports
        towhat: Host
        file_mtime:
        guid: b4a0843a-fa43-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000021
        notes: This condition verifies that the only open incoming UDP port is 427.
      - name: 03529e9e-f961-11de-9e9d-0050568a07c7
        description: Valid Incoming TCP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '902,80,443,427,5989,22,5988'
              field: Host-enabled_tcp_inbound_ports
        towhat: Host
        file_mtime:
        guid: 03529e9e-f961-11de-9e9d-0050568a07c7
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000021
        notes: This condition verifies that the only open incoming TCP ports are 22,80,427,443,902,5988,and
          5989.
    - name: 61b355f2-fee1-11de-83dd-005056ba5e76
      description: Network - Forged Transmits Must Be Disabled
      expression:
      towhat: Host
      guid: 61b355f2-fee1-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: This policy insures that forged transmits are disabled on both vLans
        and vSwitches.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: f246e3e0-fee1-11de-83dd-005056ba5e76
        description: Forged Transmits Disabled in vLan
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.lans-forged_transmits
        towhat: Host
        file_mtime:
        guid: f246e3e0-fee1-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000022
        notes: This condition verifies that forged transmits are disabled on vlans.
      - name: a3ac5774-fee1-11de-83dd-005056ba5e76
        description: Forged Transmits Disabled in vSwitch
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.switches-forged_transmits
        towhat: Host
        file_mtime:
        guid: a3ac5774-fee1-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000022
        notes: This condition verifies that forged transmits are disabled on vSwitches.
    - name: 8d4a7bee-fa56-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers defined in step-tickers
      expression:
      towhat: Host
      guid: 8d4a7bee-fa56-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 servers are defined in the NTP
        step-tickers configuration.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 0806448a-fa57-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in step-tickers File
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  value: ! "count = 0\ncontext.each_line { |line|                              #
                    Break up the input by lines\n  count += 1 if line =~ /^[^#]*server\\s+[0-9A-Za-z]+/
                    \  # Increment Count if line matches our regular expression\n}\nreturn
                    true if count &gt;= 3\nreturn false\n"
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/ntp/step-tickers
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 0806448a-fa57-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000023
        notes: This condition checks the file /etc/ntp/step-tickers and verifies that
          a minimum of three ntp servers are defined.
    - name: ab373d88-fa4a-11de-83ca-005056ba0614
      description: Settings - Display Logs on Different Terminals
      expression:
      towhat: Host
      guid: ab373d88-fa4a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that critical, error, and warning level log messages
        are directed to distinct terminals.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: f383ec6c-fa4a-11de-83ca-005056ba0614
        description: Verify Different Logs Displayed on Different Terminals
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    value: ^\s*\*\.crit\s+\/dev\/tty
                    field: Host.filesystems-contents
                search:
                  =:
                    value: /etc/syslog.conf
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    value: ^\s*\*\.err\s+\/dev\/tty
                    field: Host.filesystems-contents
                search:
                  =:
                    value: /etc/syslog.conf
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    value: ^\s*\*\.warning\s+\/dev\/tty
                    field: Host.filesystems-contents
                search:
                  =:
                    value: /etc/syslog.conf
                    field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: f383ec6c-fa4a-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000024
        notes: This condition checks the file /etc/syslog.conf has three seperate
          parameters defined for critical, error, and warning level log messages.
          These parameters specify the tty will display the specified log messages.
    - name: 498f5330-fa4b-11de-83ca-005056ba0614
      description: Settings -  Remote syslog Logging
      expression:
      towhat: Host
      guid: 498f5330-fa4b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that syslog is configured to utilize a remote server.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: ee09af6e-fa4b-11de-83ca-005056ba0614
        description: Verify syslog Utilizes a Remote Host
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: /^[^#*]\s*.*@/
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/syslog.conf
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: ee09af6e-fa4b-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000025
        notes: This condition checks the file /etc/syslog.conf and verifies the existence
          of the @ parameter, which is used to specify the use of a remote server.
    - name: eb0151ea-fa47-11de-83ca-005056ba0614
      description: Root Login on console should be Disabled
      expression:
      towhat: Host
      guid: eb0151ea-fa47-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the root account cannot directly login via
        the console.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 571e6e76-fa48-11de-83ca-005056ba0614
        description: File /etc/securetty should be empty
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  value: '0'
                  field: Host.filesystems-size
              search:
                =:
                  value: /etc/securetty
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 571e6e76-fa48-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000026
        notes: This condition checks the file /etc/securetty and verifies that it's
          empty by checking for a 0KB file size.
    - name: e4c93c82-fa3a-11de-83ca-005056ba0614
      description: Permissions - /etc/grub.conf
      expression:
      towhat: Host
      guid: e4c93c82-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that editing the server's boot process requires
        root level authority.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: d2adb400-fa3b-11de-83ca-005056ba0614
        description: Permissions - /etc/grub.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  =:
                    value: '0600'
                    field: Host.filesystems-permissions
                search:
                  =:
                    value: /etc/grub.conf
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  =:
                    value: root
                    field: Host.filesystems-owner
                search:
                  =:
                    value: /etc/grub.conf
                    field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: d2adb400-fa3b-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000027
        notes: This condition verifies that the file /etc/grub.conf's permissions
          are set to 0600 and is owned by root.
    - name: de683aa6-fedf-11de-83dd-005056ba5e76
      description: Network - Mac Changes not Allowed
      expression:
      towhat: Host
      guid: de683aa6-fedf-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: This policy checks that MAC changes are not allowed on vSwitches and
        vLans.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 0a6eb332-fee0-11de-83dd-005056ba5e76
        description: Mac Changes Disabled in vSwitches
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.switches-mac_changes
        towhat: Host
        file_mtime:
        guid: 0a6eb332-fee0-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000028
        notes: This condition verifies that MAC changes are not allowed on vSwitches.
      - name: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
        description: Mac Changes Disabled in vLans
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.lans-mac_changes
        towhat: Host
        file_mtime:
        guid: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000028
        notes: This condition verifies that MAC changes are not allowed on vLans.
    - name: 7cc14778-fe0f-11de-83dd-005056ba5e76
      description: Network - Promiscuous Mode Setting Not Disabled
      expression:
      towhat: Host
      guid: 7cc14778-fe0f-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: Check the Host VLan setting for Promiscuous Mode which should be disabled.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 2045b314-fe58-11de-83dd-005056ba5e76
        description: Check Host vSwitch - Promiscuous Mode Must Not Be Enable
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'true'
                field: Host.switches-allow_promiscuous
        towhat: Host
        file_mtime:
        guid: 2045b314-fe58-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000029
        notes: This condition verifies that vSwitches do not allow Promiscuous mode
          via inheritance.
      - name: 80e5ff5e-fe16-11de-83dd-005056ba5e76
        description: Check Host Port - Promiscuous Mode Must Not Be Enabled
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'true'
                field: Host.lans-computed_allow_promiscuous
        towhat: Host
        file_mtime:
        guid: 80e5ff5e-fe16-11de-83dd-005056ba5e76
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000029
        notes: This condition verifies that vLans do not allow Promiscuous mode via
          inheritance.
    - name: a8e0ef7c-fa48-11de-83ca-005056ba0614
      description: Use sudo aliases
      expression:
      towhat: Host
      guid: a8e0ef7c-fa48-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that user aliases are enabled in the configuration
        of the sudo command.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 99496ebc-fa49-11de-83ca-005056ba0614
        description: Aliases are being used for sudo authorization
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*User_Alias
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/sudoers
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 99496ebc-fa49-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000030
        notes: This condition checks the file /etc/sudoers and verifies that the parameter
          "User_Alias" is defined.
    - name: 4ed279b2-fa55-11de-83ca-005056ba0614
      description: Timekeeping - NTP Service Running
      expression:
      towhat: Host
      guid: 4ed279b2-fa55-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the NTP servers is configured to automatically
        start.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 9a08d21e-fa55-11de-83ca-005056ba0614
        description: Verify NTP is Running
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                INCLUDES:
                  value: '3'
                  field: Host.host_services-enable_run_levels
              search:
                =:
                  value: ntpd
                  field: Host.host_services-name
        towhat: Host
        file_mtime:
        guid: 9a08d21e-fa55-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000031
        notes: This condition verifies that the run level of the service ntpd is set
          to three.
    - name: a6c2a51e-fa57-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers Defined in ntp.conf
      expression:
      towhat: Host
      guid: a6c2a51e-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 servers are defined in the NTP
        configuration.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 03c821bc-fa58-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in ntp.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  value: ! "count = 0\ncontext.each_line { |line|                              #
                    Break up the input by lines\n  count += 1 if line =~ /^[^#]*server\\s+[0-9A-Za-z]+/
                    \  # Increment Count if line matches our regular expression\n}\nreturn
                    true if count &gt;= 3\nreturn false"
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/ntp.conf
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 03c821bc-fa58-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000032
        notes: This condition checks the file /etc/ntp.conf and verifies that a minimum
          of three ntp servers are defined.
    - name: c4396f3a-fa55-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers Defined in hosts
      expression:
      towhat: Host
      guid: c4396f3a-fa55-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 NTP servers are defined in the
        local hosts file.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 2698c39c-fa56-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in hosts File
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  value: ! "count = 0\ncontext.each_line { |line|                              #
                    Break up the input by lines\n  count += 1 if line =~ /^[^#]*NTP/i
                    \  # Increment Count if line matches our regular expression\n}\nreturn
                    true if count &gt;= 3\nreturn false\n"
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/hosts
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 2698c39c-fa56-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000033
        notes: ! 'This conditions checks the file /etc/hosts and veries that there
          are at least 3 uncommented lines that reference ntp servers. The included
          expression can be modified to match the appropriate values for the ntp servers
          for your environment.

'
    - name: 3819638c-fa57-11de-83ca-005056ba0614
      description: Timekeeping - Drift Enabled
      expression:
      towhat: Host
      guid: 3819638c-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that NTP's driftfile support is enabled.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 71fae5da-fa57-11de-83ca-005056ba0614
        description: Verify NTP Uses a Driftfile
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*driftfile\s+\/var\/lib\/ntp\/drift
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/ntp.conf
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 71fae5da-fa57-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000034
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          driftfile parameter exists.
    - name: ebc02cea-fa57-11de-83ca-005056ba0614
      description: Time Keeping - Restrict Access for Machines without Loopback
      expression:
      towhat: Host
      guid: ebc02cea-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only non-loopback machines can access the NTP
        service.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: ddc26260-fa58-11de-83ca-005056ba0614
        description: Access Restricted for Machines without Loopback
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*restrict\s+default\s+kod\s+nomodify\s+notrap
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/ntp.conf
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: ddc26260-fa58-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000035
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          line "restrict default kod nomodify notrap" exists.
    - name: ccadf9fa-fa56-11de-83ca-005056ba0614
      description: Time Keeping - NTP Configured to Use Loopback Adapter
      expression:
      towhat: Host
      guid: ccadf9fa-fa56-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that NTP performs all name resolutions via a loopback
        network.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 2b9bb8b2-fa57-11de-83ca-005056ba0614
        description: NTP Configured to Use Loopback Adapter
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*restrict\s+127\.0\.0\.1
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/ntp.conf
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 2b9bb8b2-fa57-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000036
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          restrict parameter's value is set to 127.0.0.1.
    - name: 4614d62e-fa52-11de-83ca-005056ba0614
      description: Settings - vmkwarning Compress Option
      expression:
      towhat: Host
      guid: 4614d62e-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmkwarning log is compressed by default.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: a51cbaba-fa52-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmkwarning
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: \s+compress
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/logrotate.d/vmkwarning
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: a51cbaba-fa52-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000037
        notes: This condition checks the file /etc/logrotate.d/vmkwarning and verifies
          that the option compress is enabled.
    - name: 6353b57e-fa53-11de-83ca-005056ba0614
      description: Settings - vmksummary Compress Option
      expression:
      towhat: Host
      guid: 6353b57e-fa53-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmksummary log is compressed by default.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 510f7286-fa53-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmksummary
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: \s+compress
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/logrotate.d/vmksummary
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 510f7286-fa53-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000038
        notes: This condition checks the file /etc/logrotate.d/vmksummary and verifies
          that the option compress is enabled.
    - name: 0864fae6-fa54-11de-83ca-005056ba0614
      description: Settings - vmkernel Compress Option
      expression:
      towhat: Host
      guid: 0864fae6-fa54-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmkernel log is compressed by default.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: fe7378be-fa53-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmkernel
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: \s+compress
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/logrotate.d/vmkernel
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: fe7378be-fa53-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000039
        notes: This condition checks the file /etc/logrotate.d/vmkernel and verifies
          that the option compress is enabled.
    - name: 6576a074-fa48-11de-83ca-005056ba0614
      description: Settings - /etc/sudoers
      expression:
      towhat: Host
      guid: 6576a074-fa48-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that sudo is configured to use syslog for logging.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: ade186c6-fa48-11de-83ca-005056ba0614
        description: Verify sudo is Logging via syslog
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*Defaults\s+syslog\=
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/sudoers
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: ade186c6-fa48-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000040
        notes: This condition check the file /etc/sudoers and verifies that the parameter
          "Defaults syslog=" exists.
    - name: c340f524-fa3e-11de-83ca-005056ba0614
      description: Settings - /etc/grub.conf
      expression:
      towhat: Host
      guid: c340f524-fa3e-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a password is required in order to edit the
        server's boot process.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 1f18225a-fa3f-11de-83ca-005056ba0614
        description: Verify /etc/grub.conf Settings
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*password\s\-\-md5
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/grub.conf
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 1f18225a-fa3f-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000041
        notes: This condition check the file /etc/grub.conf and verifies that the
          parameter "password --md5" exists.
    - name: c63b0560-fa45-11de-83ca-005056ba0614
      description: Root Login via SSH should be Disabled
      expression:
      towhat: Host
      guid: c63b0560-fa45-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the root account cannot login to the host via
        SSH.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 4435b6d6-fa46-11de-83ca-005056ba0614
        description: PermitRootLogin = no in sshd_config file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*PermitRootLogin\s+no
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/ssh/sshd_config
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 4435b6d6-fa46-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000042
        notes: This condition checks the file /etc/ssh/sshd_config and verifies that
          the PermitRootLogin parameter's value is set to no.
    - name: 5ce6be9a-fa4c-11de-83ca-005056ba0614
      description: Require users to enter own password - no ROOTPW entry
      expression:
      towhat: Host
      guid: 5ce6be9a-fa4c-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that when the sudo command is used, each user is
        prompted for their password and not the root password.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: a791b882-fa4c-11de-83ca-005056ba0614
        description: ROOTPW does not exist in sudoers file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  value: /^[^#]*ROOTPW/i
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/sudoers
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: a791b882-fa4c-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000043
        notes: This condition check the file /etc/sudoers and verifies that it does
          not contain the word ROOTPW on an uncommented line.
    - name: a128d356-fa36-11de-83ca-005056ba0614
      description: Protect Root File System Filling /tmp
      expression:
      towhat: Host
      guid: a128d356-fa36-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /tmp directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 267dd9de-fa37-11de-83ca-005056ba0614
        description: Protect Root File System Filling  /tmp
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^[^#]*\/tmp
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/fstab
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 267dd9de-fa37-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000044
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /tmp.
    - name: 7ea7db8c-fa46-11de-83ca-005056ba0614
      description: Permissions - /etc/snmp/snmpd.conf
      expression:
      towhat: Host
      guid: 7ea7db8c-fa46-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy ensures that access to SNMP configuration parameters are
        limited to the root user.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: ebb24a50-fa46-11de-83ca-005056ba0614
        description: Permissions - /etc/snmp/snmpd.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  =:
                    value: '0700'
                    field: Host.filesystems-permissions
                search:
                  =:
                    value: /etc/snmp/snmpd.conf
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  =:
                    value: root
                    field: Host.filesystems-owner
                search:
                  =:
                    value: /etc/snmp/snmpd.conf
                    field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: ebb24a50-fa46-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000045
        notes: This condition verifies that the permissions of /etc/snmp/snmpd.conf
          are 0700 and is owned by root.
    - name: 40b796dc-fa50-11de-83ca-005056ba0614
      description: Password Expiration Warning Default
      expression:
      towhat: Host
      guid: 40b796dc-fa50-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies the default setting for password expiration warning.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 0e842bde-fa51-11de-83ca-005056ba0614
        description: Password Expiration Warning Default &gt;= 7days
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*PASS_WARN_AGE\s+([7-9]|[1-9][0-9]+)
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/login.defs
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 0e842bde-fa51-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000046
        notes: This condition checks the file /etc/login.defs and verifies that PASS_WARN_AGE
          parameter's value is set to 7 or greater.
    - name: 2f9fad14-fa4e-11de-83ca-005056ba0614
      description: Password Aging - Default Maximum
      expression:
      towhat: Host
      guid: 2f9fad14-fa4e-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates the ESX host's maximum password age configuration.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: a4a0e740-fa4e-11de-83ca-005056ba0614
        description: Default Maximum Password Age &lt;= 90days
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*PASS_MAX_DAYS\s+([0-9]|[1-8][0-9]|90)
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/login.defs
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: a4a0e740-fa4e-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000047
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MAX_DAYS parameter's value is 90 days or greater.
    - name: 79548666-fa51-11de-83ca-005056ba0614
      description: Limit vmkwarning Size
      expression:
      towhat: Host
      guid: 79548666-fa51-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmkwarning log is limited to a specified size.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 14d35e46-fa52-11de-83ca-005056ba0614
        description: vmkwarning Log Size &lt;= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/logrotate.d/vmkwarning
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 14d35e46-fa52-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000048
        notes: This condition verifies that the file /etc/logrotate.d/vmkwarning is
          configured to limit the associated log to 4096KB.
    - name: c79821fa-fa53-11de-83ca-005056ba0614
      description: Limit vmkernel Size
      expression:
      towhat: Host
      guid: c79821fa-fa53-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmkernel log is limited to a specified size.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: be9722e0-fa53-11de-83ca-005056ba0614
        description: vmkernel Log Size &lt;= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/logrotate.d/vmkernel
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: be9722e0-fa53-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000049
        notes: This condition verifies that the file /etc/logrotate.d/vmkernel is
          configured to limit the associated log to 4096KB.
    - name: 8cecc84c-fa46-11de-83ca-005056ba0614
      description: Limit su Access to root Account
      expression:
      towhat: Host
      guid: 8cecc84c-fa46-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that only members of the group wheel can access
        the su command.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 63b243fc-fa47-11de-83ca-005056ba0614
        description: Only members of wheel group can execute su command
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*auth\s+required\s+.*pam_wheel\.so\s+use_uid
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/pam.d/su
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 63b243fc-fa47-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000050
        notes: This condition validates that the file /etc/pam.d/su contains a variation
          of the string "auth required pam_wheel.so use_uid".
    - name: 2cd1b736-fa52-11de-83ca-005056ba0614
      description: Limit Software and Services Running in Service Console
      expression:
      towhat: Host
      guid: 2cd1b736-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that only an approved list of services are enabled
        at boot time on an ESX host.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: c4c80bfa-fa55-11de-83ca-005056ba0614
        description: Default Services Running in Service Console
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: crond, firewall, gpm, ipmi, irqbalance, mgmt-vmware, microcode_ctl,
                mptctlnode, network, ntpd, pegasus, portmap, random, rawdevices, sshd,
                syslog, vmware, vmware-autostart, vmware-late, vmware-vmkauthd, vmware-vpxa,
                vmware-webAccess, wsman, xinetd
              field: Host-enabled_run_level_3_services
        towhat: Host
        file_mtime:
        guid: c4c80bfa-fa55-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000051
        notes: This conditions validates that a defined list of services are enabled
          with the ESX host is booted with networking support (run level 3). This
          list includes the generic services included in ESX. Additional hardware
          specific services can be added to the expression.
    - name: edaf1082-fa54-11de-83ca-005056ba0614
      description: Firewall - Outgoing NTP Port
      expression:
      towhat: Host
      guid: edaf1082-fa54-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that the Firewall is configured properly for NTP
        support.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 1cb7f0ba-fa55-11de-83ca-005056ba0614
        description: Valid NTP Outgoing UDP Port
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            INCLUDES ANY:
              value: '123'
              field: Host-enabled_udp_outbound_ports
        towhat: Host
        file_mtime:
        guid: 1cb7f0ba-fa55-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000052
        notes: This condition verifies that the outgoing UDP port required by NTP
          (port 123) is open.
    - name: 0f2cc826-fa4b-11de-83ca-005056ba0614
      description: Directory Service Used for Authentication for sudo
      expression:
      towhat: Host
      guid: 0f2cc826-fa4b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that sudo is configured to use a directory for user
        authentication.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 684b2a60-fa4b-11de-83ca-005056ba0614
        description: Directory Service used for sudo authentication
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*auth\s+required\s+.*pam_stack\.so\s+service=system-auth
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/pam.d/sudo
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 684b2a60-fa4b-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000053
        notes: ! 'This condition verifies that the line "auth required pam_stack.so
          service=system-auth" exists in /etc/pam.d/sudo. '
    - name: 4b188948-fa45-11de-83ca-005056ba0614
      description: Settings - SNMP Read Only Access
      expression:
      towhat: Host
      guid: 4b188948-fa45-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that SNMP is configured to only allow read-only
        access.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: e328c720-fa45-11de-83ca-005056ba0614
        description: SNMP Configured for Read-only Access
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    value: ^\s*rocommunity
                    field: Host.filesystems-contents
                search:
                  =:
                    value: /etc/snmp/snmpd.conf
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  REGULAR EXPRESSION DOES NOT MATCH:
                    value: ^\s*rwcommunity
                    field: Host.filesystems-contents
                search:
                  =:
                    value: /etc/snmp/snmpd.conf
                    field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: e328c720-fa45-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000054
        notes: This condition checks the file /etc/snmp/snmpd.conf and verfies that
          the rocommunity parameter is defined and the rwcommunity parameter is not.
    - name: 854d45aa-fa3a-11de-83ca-005056ba0614
      description: Protect Root File System Filling /var/log
      expression:
      towhat: Host
      guid: 854d45aa-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /var/log directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: a84173e2-fa3a-11de-83ca-005056ba0614
        description: Protect Root File System Filling /var/log
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^[^#]*\/var\/log
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/fstab
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: a84173e2-fa3a-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000055
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /var/log.
    - name: fc63df74-fa52-11de-83ca-005056ba0614
      description: Limit vmksummary Size
      expression:
      towhat: Host
      guid: fc63df74-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmksummary log is limited to a specified size.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: def33840-fa52-11de-83ca-005056ba0614
        description: vmksummary Log Size &lt;= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/logrotate.d/vmksummary
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: def33840-fa52-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000056
        notes: This condition verifies that the file /etc/logrotate.d/vmksummary is
          configured to limit the associated log to 4096KB.
    - name: 305e6832-fa51-11de-83ca-005056ba0614
      description: Password Complexity - Minimum Length
      expression:
      towhat: Host
      guid: 305e6832-fa51-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies the minimum password length.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: c0ba559e-fa51-11de-83ca-005056ba0614
        description: Minimum Password Length &gt;= 8
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*PASS_MIN_LEN\s+([8-9]|[1-9][0-9]+)
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/login.defs
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: c0ba559e-fa51-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000057
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MIN_LEN parameter's value  is 8 or greater.
    - name: e6f082ba-fa4c-11de-83ca-005056ba0614
      description: Password checking enabled for sudo
      expression:
      towhat: Host
      guid: e6f082ba-fa4c-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that password checking is enabled for sudo.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 3d2074e2-fa4d-11de-83ca-005056ba0614
        description: NOPASSWD does not exist in sudoers file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  value: /^[^#]*NOPASSWD/i
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/sudoers
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 3d2074e2-fa4d-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000058
        notes: This condition check the file /etc/sudoers and verifies that it does
          not contain the word NOPASSWORD on an uncommented line.
    - name: 32b26f2c-fa4f-11de-83ca-005056ba0614
      description: Password Aging - Default Minimum
      expression:
      towhat: Host
      guid: 32b26f2c-fa4f-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates the ESX host's minimum password age configuration.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 79d39ad4-fa4f-11de-83ca-005056ba0614
        description: Default Minimum Password Age &gt;= 0
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*PASS_MIN_DAYS\s+\d+
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/login.defs
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 79d39ad4-fa4f-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000059
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MIN_DAYS parameter's value is greater than or equal to 0 days.
- MiqPolicySet:
    name: 97c27462-1592-11df-b613-0050568a1ed6
    description: ! 'Compliance: VM'
    set_type: MiqPolicySet
    guid: 97c27462-1592-11df-b613-0050568a1ed6
    read_only:
    set_data:
      :notes: This policy profile validates that a vm meets the standard defined in
        VMWare's security hardening documentation
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 2d6bfc2c-fa3b-11de-83ca-005056ba0614
      description: Limit Log Size
      expression:
      towhat: Vm
      guid: 2d6bfc2c-fa3b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 8b9cf076-fa3b-11de-83ca-005056ba0614
        description: Log Size Limit &lt;= 100KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                &lt;=:
                  value: '100000'
                  field: Vm.advanced_settings-value
              search:
                =:
                  value: log.rotateSize
                  field: Vm.advanced_settings-name
        towhat: Vm
        file_mtime:
        guid: 8b9cf076-fa3b-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000061
        notes:
    - name: f1af8b44-fa3b-11de-83ca-005056ba0614
      description: Limit Number of Log Files
      expression:
      towhat: Vm
      guid: f1af8b44-fa3b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: f2ad72ac-fa3d-11de-83ca-005056ba0614
        description: Number of Log Files to Keep &lt;= 10
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                &lt;=:
                  value: '10'
                  field: Vm.advanced_settings-value
              search:
                =:
                  value: log.keepOld
                  field: Vm.advanced_settings-name
        towhat: Vm
        file_mtime:
        guid: f2ad72ac-fa3d-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000060
        notes:
- MiqPolicySet:
    name: 17fa069a-480b-11df-badc-005056a7121f
    description: ! 'Demo: CPU Reservation'
    set_type: MiqPolicySet
    guid: 17fa069a-480b-11df-badc-005056a7121f
    read_only:
    set_data:
      :notes: This policy profile analyzes a vm's configuration data when it's reconfigured
        an sends an email if the cpu reservation is set to a value greater than 500.
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 2f2a1a1c-4806-11df-badc-005056a7121f
      description: ! 'Analysis: VM Reconfiguration'
      expression:
      towhat: Vm
      guid: 2f2a1a1c-4806-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Performs an analysis on any vm that has been reconfigured
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: {}
      Condition: []
    - name: 8a8f247a-480a-11df-badc-005056a7121f
      description: ! 'Configuration: VM - CPU Reservation &gt; 500Mhz'
      expression:
      towhat: Vm
      guid: 8a8f247a-480a-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Sends an email if CPU reservation is set to a value greater than 500Mhz
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 5189755e-480a-11df-badc-005056a7121f
          description: Alert - CPU Reservation &gt; 500Mhz
          guid: 5189755e-480a-11df-badc-005056a7121f
          action_type: evaluate_alerts
          options:
            :alert_guids:
            - ca26a9c6-4802-11df-badc-005056a7121f
      Condition: []
    - name: 467f80ce-4808-11df-badc-005056a7121f
      description: ! 'Analysis: VM Configuration Only Profile'
      expression:
      towhat: Vm
      guid: 467f80ce-4808-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: ! 'This policy assigns an analysis profile that only gathers vm configuration
        data. Note: the specified action requires that you create an analysis profile
        that only scans vm configuration data. Once it has been created, associate
        it with the specified action'
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_start
          description: VM Analysis Start
          guid: 057b9baa-519c-11e0-8d82-005056af0000
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: b52a86f0-4807-11df-badc-005056a7121f
          description: ! 'Profile: VM configuration only'
          guid: b52a86f0-4807-11df-badc-005056a7121f
          action_type: assign_scan_profile
          options:
            :scan_item_set_name: vm configuration only
      Condition: []
- MiqPolicySet:
    name: 6fb380a4-3b86-11e0-9dc0-005056910001
    description: ! 'Demo: Prevent Cloning of Database VMs '
    set_type: MiqPolicySet
    guid: 6fb380a4-3b86-11e0-9dc0-005056910001
    read_only:
    set_data:
      :notes: This policy prevents any vm with a workload tag of database from being
        cloned
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: Configuration Policy Restrict Cloning SQL Server
      description: ! 'Operational: Prevent Cloning of Database VMs'
      expression:
      towhat: Vm
      guid: 39fdeba0-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: prevents cloning of vms with a workload tag value of database
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: cancel_task
          description: Cancel vCenter Task
          guid: e49bfee6-1e1e-11de-8918-0050568005db
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: SendEmail
          description: SendEmail
          guid: abcf406c-02cd-11de-86d4-005056903dbc
          action_type: email
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :from: evmadmin@manageiq.com
            :to: evm_demo@manageiq.com
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 4468f036-0b6d-11df-bd07-005056a7121f
          description: VM Attribute - Prevent Clone of SQL Server
          guid: 4468f036-0b6d-11df-bd07-005056a7121f
          action_type: set_custom_attribute
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :value: Clone Prevented for SQL Server VM
            :attribute: EVM Policy
      Condition:
      - name: VMs running SQL Server
        description: VMs with Workload - Database
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-function
              value: database
          context_type:
        towhat: Vm
        file_mtime:
        guid: 121ecf62-01c6-11de-a701-005056903dbc
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000064
        notes:
- MiqPolicySet:
    name: 3b818590-2866-11de-af2a-0050568026c2
    description: ! 'Demo: Service Level Resource Allocation'
    set_type: MiqPolicySet
    guid: 3b818590-2866-11de-af2a-0050568026c2
    read_only:
    set_data:
      :notes: This policy demonstrates EVM's ability to check and , if necessary,
        reconfigure a VM's vCPU and Memory configuration based on designated service
        level
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: d16643b6-3905-11de-b6d5-005056a11a54
      description: Service Level Silver - RAM must be 512MB and 1 vCPU - on
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: silver
          - =:
              value: 'on'
              field: Vm-power_state
        context_type:
      towhat: Vm
      guid: d16643b6-3905-11de-b6d5-005056a11a54
      created_by:
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of silver
        has 1 vCPU and 512MB of memory. If not it changes the vm to these values.
        This policy is used on a powered on vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_RAM_512MB
          description: Set VM RAM to 512MB
          guid: bab04cb4-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 512
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_CPU_1
          description: Set VM CPU to 1
          guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '1'
      - qualifier: success
        success_sequence: 4
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_start
          description: Start Virtual Machine
          guid: 55b5a422-3348-11de-bde2-005056a170fa
          action_type: default
          options: {}
      Condition:
      - name: Service Level Validation Silver - Powered Off
        description: Service Level Silver - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                value: 512
                field: Vm.hardware-memory_cpu
            - ! '!=':
                value: 1
                field: Vm.hardware-numvcpus
        towhat: Vm
        file_mtime:
        guid: 531575ae-9b1c-11dd-bbd7-005056ac7d2c
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000068
        notes:
    - name: 4cb4d05c-3909-11de-b6d5-005056a11a54
      description: Service Level Platinum - RAM must be 2GB and 2 vCPUs - on
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: platinum
          - =:
              value: 'on'
              field: Vm-power_state
        context_type:
      towhat: Vm
      guid: 4cb4d05c-3909-11de-b6d5-005056a11a54
      created_by:
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of platinum
        has 2 vCPUs and 2GB of memory. If not it changes the vm to these values. This
        policy is used on a powered on vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_RAM_2GB
          description: Set VM RAM to 2GB
          guid: cf1570b2-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 2048
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_CPU_2
          description: Set VM CPU to 2
          guid: e2c3d64e-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '2'
      - qualifier: success
        success_sequence: 4
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_start
          description: Start Virtual Machine
          guid: 55b5a422-3348-11de-bde2-005056a170fa
          action_type: default
          options: {}
      Condition:
      - name: 34218558-3909-11de-b6d5-005056a11a54
        description: Service Level Platinum - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                value: 2048
                field: Vm.hardware-memory_cpu
            - ! '!=':
                value: 2
                field: Vm.hardware-numvcpus
        towhat: Vm
        file_mtime:
        guid: 34218558-3909-11de-b6d5-005056a11a54
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000070
        notes:
    - name: 7a91f3ac-3908-11de-b6d5-005056a11a54
      description: Service Level Gold - RAM must be 1GB and 1 vCPU - on
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: gold
          - =:
              value: 'on'
              field: Vm-power_state
        context_type:
      towhat: Vm
      guid: 7a91f3ac-3908-11de-b6d5-005056a11a54
      created_by:
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of gold has
        1vCPU and 1GB of memory. If not it changes the vm to these values. This policy
        is used on a powered on vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_RAM_1GB
          description: Set VM RAM to 1GB
          guid: 2d8445f2-9aec-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 1024
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_CPU_1
          description: Set VM CPU to 1
          guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '1'
      - qualifier: success
        success_sequence: 4
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_start
          description: Start Virtual Machine
          guid: 55b5a422-3348-11de-bde2-005056a170fa
          action_type: default
          options: {}
      Condition:
      - name: 1c6ec35e-3908-11de-b6d5-005056a11a54
        description: Service Level Gold - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                value: 1024
                field: Vm.hardware-memory_cpu
            - ! '!=':
                value: 1
                field: Vm.hardware-numvcpus
        towhat: Vm
        file_mtime:
        guid: 1c6ec35e-3908-11de-b6d5-005056a11a54
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000069
        notes:
    - name: Service Level Policy Verify Virtual Hardware - Silver Level
      description: Service Level Silver - RAM must be 512MB and 1 vCPU - off
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: silver
          - =:
              value: 'off'
              field: Vm-power_state
        context_type:
      towhat: Vm
      guid: 3659b8bc-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of silver
        has 1 vCPU and 512MB of memory. If not it changes the vm to these values.
        This policy is used on a powered off vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_CPU_1
          description: Set VM CPU to 1
          guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '1'
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_RAM_512MB
          description: Set VM RAM to 512MB
          guid: bab04cb4-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 512
      Condition:
      - name: Service Level Validation Silver - Powered Off
        description: Service Level Silver - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                value: 512
                field: Vm.hardware-memory_cpu
            - ! '!=':
                value: 1
                field: Vm.hardware-numvcpus
        towhat: Vm
        file_mtime:
        guid: 531575ae-9b1c-11dd-bbd7-005056ac7d2c
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000068
        notes:
    - name: 24b92088-399c-11de-ae27-005056a11a54
      description: Service Level Gold - RAM must be 1GB and 1 vCPU - off
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: gold
          - =:
              value: 'off'
              field: Vm-power_state
        context_type:
      towhat: Vm
      guid: 24b92088-399c-11de-ae27-005056a11a54
      created_by:
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of gold has
        1vCPU and 1GB of memory. If not it changes the vm to these values. This policy
        is used on a powered off vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_RAM_1GB
          description: Set VM RAM to 1GB
          guid: 2d8445f2-9aec-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 1024
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_CPU_1
          description: Set VM CPU to 1
          guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '1'
      Condition:
      - name: 1c6ec35e-3908-11de-b6d5-005056a11a54
        description: Service Level Gold - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                value: 1024
                field: Vm.hardware-memory_cpu
            - ! '!=':
                value: 1
                field: Vm.hardware-numvcpus
        towhat: Vm
        file_mtime:
        guid: 1c6ec35e-3908-11de-b6d5-005056a11a54
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000069
        notes:
    - name: b265c970-3908-11de-b6d5-005056a11a54
      description: Service Level Platinum - RAM must be 2GB and 2 vCPUs - off
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: platinum
          - =:
              value: 'off'
              field: Vm-power_state
        context_type:
      towhat: Vm
      guid: b265c970-3908-11de-b6d5-005056a11a54
      created_by:
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of platinum
        has 2 vCPUs and 2GB of memory. If not it changes the vm to these values. This
        policy is used on a powered off vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_RAM_2GB
          description: Set VM RAM to 2GB
          guid: cf1570b2-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 2048
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: VM_CPU_2
          description: Set VM CPU to 2
          guid: e2c3d64e-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '2'
      Condition:
      - name: 34218558-3909-11de-b6d5-005056a11a54
        description: Service Level Platinum - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                value: 2048
                field: Vm.hardware-memory_cpu
            - ! '!=':
                value: 2
                field: Vm.hardware-numvcpus
        towhat: Vm
        file_mtime:
        guid: 34218558-3909-11de-b6d5-005056a11a54
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000070
        notes:
- MiqPolicySet:
    name: fc164798-3b81-11e0-9dc0-005056910001
    description: ! 'Demo: Windows Mandatory Patch'
    set_type: MiqPolicySet
    guid: fc164798-3b81-11e0-9dc0-005056910001
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: c5d44cb2-4734-11df-b577-005056a7121f
      description: ! 'Patch: MS10-008 Required'
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            tag: Vm.managed-environment
            value: prod
        context_type:
      towhat: Vm
      guid: c5d44cb2-4734-11df-b577-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Prevents a VM that does not have MS10-008 installed from running in the
        virtual environment. It's scope limits it to vms tagged as production
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: SendEmail
          description: SendEmail
          guid: abcf406c-02cd-11de-86d4-005056903dbc
          action_type: email
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :from: evmadmin@manageiq.com
            :to: evm_demo@manageiq.com
      - qualifier: failure
        failure_sequence: 3
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 722d25cc-56dc-11df-bb16-005056a7121f
          description: VM Attribute - Fails patch policy
          guid: 722d25cc-56dc-11df-bb16-005056a7121f
          action_type: set_custom_attribute
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :value: Failed Windows Required Patch Policy
            :attribute: EVM Policy
      Condition:
      - name: a3089008-4734-11df-b577-005056a7121f
        description: Verify KB978262 is installed
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              value: KB978262
              field: Vm.patches-name
          context_type:
        towhat: Vm
        file_mtime:
        guid: a3089008-4734-11df-b577-005056a7121f
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000071
        notes:
- MiqPolicySet:
    name: 3be240d8-2866-11de-af2a-0050568026c2
    description: ! 'Mandatory: Provisioning and Retirement'
    set_type: MiqPolicySet
    guid: 3be240d8-2866-11de-af2a-0050568026c2
    read_only:
    set_data:
      :notes: ! 'This policy profile is REQUIRED if EVM is being used to Provision
        or Retire vms. It must be entitled to the desired management systems. Note:
        this policy profile will potentially result in the removal of a vm from the
        management system upon retirement if the associated VM Retirement statemachine
        [/Factory/StateMachine/VMRetirement] in the the Automate model is configured
        to delete vms. It is not configured for vm deletion out-of-the-box.'
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: Automation Policy - Scope VM Retired Response Execute Automation Model
      description: ! 'Operational: Vm Retired'
      expression:
      towhat: Vm
      guid: 397700ae-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: This policy raises an automation event when a vm retirement event is
        raised
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_retired
          description: VM Retired
          guid: e363d8aa-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: e7da3b7a-1139-11e1-9333-005056af009e
          action_type: default
          options: {}
      Condition: []
    - name: Automation Policy - Scope VM Retirement Warning,  ResponseExecute Automation
        Model
      description: ! 'Operational: Retirement Warning'
      expression:
      towhat: Vm
      guid: 39621392-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: This policy raises an automation event when a retirement warning event
        is raised
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_retire_warn
          description: VM Retirement Warning
          guid: 97c85330-fe93-11dd-b5e1-005056903dbc
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: e7da3b7a-1139-11e1-9333-005056af009e
          action_type: default
          options: {}
      Condition: []
    - name: 427a4378-6519-11df-b637-005056a435be
      description: ! 'Analysis: Post Provisioning'
      expression:
      towhat: Vm
      guid: 427a4378-6519-11df-b637-005056a435be
      created_by: admin
      updated_by: admin
      notes: This policy triggers a vm analysis of any newly provisioned VM
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_provisioned
          description: VM Provision Complete
          guid: 2a17a20a-3e8e-11df-9fe2-005056a435be
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: {}
      Condition: []
- MiqPolicySet:
    name: 63aaa3aa-53fa-11e0-babf-00505688000a
    description: ! 'Operational: Prevent Cloning of Database VMs'
    set_type: MiqPolicySet
    guid: 63aaa3aa-53fa-11e0-babf-00505688000a
    read_only:
    set_data:
      :notes: This policy profile prevents database vms from being cloned. Database
        vms are defined as those that have a workload tag value of database
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: Configuration Policy Restrict Cloning SQL Server
      description: ! 'Operational: Prevent Cloning of Database VMs'
      expression:
      towhat: Vm
      guid: 39fdeba0-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: prevents cloning of vms with a workload tag value of database
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: cancel_task
          description: Cancel vCenter Task
          guid: e49bfee6-1e1e-11de-8918-0050568005db
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: SendEmail
          description: SendEmail
          guid: abcf406c-02cd-11de-86d4-005056903dbc
          action_type: email
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :from: evmadmin@manageiq.com
            :to: evm_demo@manageiq.com
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 4468f036-0b6d-11df-bd07-005056a7121f
          description: VM Attribute - Prevent Clone of SQL Server
          guid: 4468f036-0b6d-11df-bd07-005056a7121f
          action_type: set_custom_attribute
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :value: Clone Prevented for SQL Server VM
            :attribute: EVM Policy
      Condition:
      - name: VMs running SQL Server
        description: VMs with Workload - Database
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-function
              value: database
          context_type:
        towhat: Vm
        file_mtime:
        guid: 121ecf62-01c6-11de-a701-005056903dbc
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000064
        notes:
- MiqPolicySet:
    name: 97fe0866-b8e5-11e2-87c6-001a4a034c7a
    description: RHEL + KVM
    set_type: MiqPolicySet
    guid: 97fe0866-b8e5-11e2-87c6-001a4a034c7a
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: c63b0560-fa45-11de-83ca-005056ba0614
      description: Root Login via SSH should be Disabled
      expression:
      towhat: Host
      guid: c63b0560-fa45-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the root account cannot login to the host via
        SSH.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 4435b6d6-fa46-11de-83ca-005056ba0614
        description: PermitRootLogin = no in sshd_config file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*PermitRootLogin\s+no
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/ssh/sshd_config
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 4435b6d6-fa46-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000042
        notes: This condition checks the file /etc/ssh/sshd_config and verifies that
          the PermitRootLogin parameter's value is set to no.
    - name: af2d74ea-fa39-11de-83ca-005056ba0614
      description: Firewall - Incoming Security Level
      expression:
      towhat: Host
      guid: af2d74ea-fa39-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only a defined set of incoming TCP and UDP
        Ports are open.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: b4a0843a-fa43-11de-83ca-005056ba0614
        description: Valid Incoming UDP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '427'
              field: Host-enabled_udp_inbound_ports
        towhat: Host
        file_mtime:
        guid: b4a0843a-fa43-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000021
        notes: This condition verifies that the only open incoming UDP port is 427.
      - name: 03529e9e-f961-11de-9e9d-0050568a07c7
        description: Valid Incoming TCP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '902,80,443,427,5989,22,5988'
              field: Host-enabled_tcp_inbound_ports
        towhat: Host
        file_mtime:
        guid: 03529e9e-f961-11de-9e9d-0050568a07c7
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000021
        notes: This condition verifies that the only open incoming TCP ports are 22,80,427,443,902,5988,and
          5989.
    - name: 04db603c-fa3a-11de-83ca-005056ba0614
      description: Firewall - Outgoing Security Level
      expression:
      towhat: Host
      guid: 04db603c-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only a defined set of outgoing TCP and UDP
        Ports are open.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: f0afd7d6-fa3a-11de-83ca-005056ba0614
        description: Valid Outgoing TCP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '902,427,443,27000,27010'
              field: Host-enabled_tcp_outbound_ports
        towhat: Host
        file_mtime:
        guid: f0afd7d6-fa3a-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000020
        notes: This condition verifies that the only open outgoing TCP ports are 427,443,902,27000,
          and 27010.
      - name: 1778fb28-fa44-11de-83ca-005056ba0614
        description: Valid Outgoing UDP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '427,123,902'
              field: Host-enabled_udp_outbound_ports
        towhat: Host
        file_mtime:
        guid: 1778fb28-fa44-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000020
        notes: This condition verifies that the only open outgoing UDP ports are 123,427,
          and 902.
    - name: 8cecc84c-fa46-11de-83ca-005056ba0614
      description: Limit su Access to root Account
      expression:
      towhat: Host
      guid: 8cecc84c-fa46-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that only members of the group wheel can access
        the su command.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 63b243fc-fa47-11de-83ca-005056ba0614
        description: Only members of wheel group can execute su command
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*auth\s+required\s+.*pam_wheel\.so\s+use_uid
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/pam.d/su
                  field: Host.filesystems-name
        towhat: Host
        file_mtime:
        guid: 63b243fc-fa47-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000050
        notes: This condition validates that the file /etc/pam.d/su contains a variation
          of the string "auth required pam_wheel.so use_uid".
    - name: 4ed279b2-fa55-11de-83ca-005056ba0614
      description: Timekeeping - NTP Service Running
      expression:
      towhat: Host
      guid: 4ed279b2-fa55-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the NTP servers is configured to automatically
        start.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: {}
      Condition:
      - name: 9a08d21e-fa55-11de-83ca-005056ba0614
        description: Verify NTP is Running
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                INCLUDES:
                  value: '3'
                  field: Host.host_services-enable_run_levels
              search:
                =:
                  value: ntpd
                  field: Host.host_services-name
        towhat: Host
        file_mtime:
        guid: 9a08d21e-fa55-11de-83ca-005056ba0614
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000031
        notes: This condition verifies that the run level of the service ntpd is set
          to three.
- MiqPolicySet:
    name: 51149d78-cb15-11e3-b1c5-001a4a0f459e
    description: Resolv.conf
    set_type: MiqPolicySet
    guid: 51149d78-cb15-11e3-b1c5-001a4a0f459e
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: e3f6428c-a85a-11e3-9c44-001a4a0f459e
      description: Settings - /etc/resolv.conf
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            search:
              =:
                field: Vm.filesystems-name
                value: resolv.conf
            checkall:
              =:
                field: Vm.filesystems-contents_available
                value: 'true'
        context_type:
      towhat: Vm
      guid: e3f6428c-a85a-11e3-9c44-001a4a0f459e
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        success_synchronous: true
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: log
          description: Generate log message
          guid: 04771f80-431c-11e3-91d5-001a4a0f459e
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        success_synchronous: true
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: c26b7988-a860-11e3-9c44-001a4a0f459e
          description: resolv.conf
          guid: c26b7988-a860-11e3-9c44-001a4a0f459e
          action_type: custom_automation
          options:
            :ae_request: resolvsend
            :ae_message: create
      - qualifier: failure
        failure_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: log
          description: Generate log message
          guid: 04771f80-431c-11e3-91d5-001a4a0f459e
          action_type: default
          options: {}
      Condition: []
- MiqPolicySet:
    name: 5a7d53b4-53f9-11e0-babf-00505688000a
    description: ! 'Snapshot Management: Delete Based On Count'
    set_type: MiqPolicySet
    guid: 5a7d53b4-53f9-11e0-babf-00505688000a
    read_only:
    set_data:
      :notes: This policy profile deletes the most recent snapshot when more that
        2 snapshots exists
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 994efe7e-18e6-11e0-88b4-005056a7184a
      description: ! 'Snapshots: Delete based on Count'
      expression:
      towhat: Vm
      guid: 994efe7e-18e6-11e0-88b4-005056a7184a
      created_by: admin
      updated_by: admin
      notes: This policy deletes the most recent snapshot when more that 2 snapshots
        exists
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_snapshot_complete
          description: VM Snapshot Create Complete
          guid: 7eb82802-135e-11e0-8706-005056a7184a
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: delete_most_recent_snapshot
          description: Delete Most Recent Snapshot
          guid: 7f6e2f8a-135e-11e0-8706-005056a7184a
          action_type: default
          options: {}
      Condition:
      - name: 992035fc-18e7-11e0-88b4-005056a7184a
        description: Check for more than 2 snapshots
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '&gt;':
              value: '2'
              field: Vm-v_total_snapshots
          context_type:
        towhat: Vm
        file_mtime:
        guid: 992035fc-18e7-11e0-88b4-005056a7184a
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000075
        notes: Checks to see if more than 2 snapshots exist
- MiqPolicySet:
    name: 05b51354-53fd-11e0-babf-00505688000a
    description: Standards
    set_type: MiqPolicySet
    guid: 05b51354-53fd-11e0-babf-00505688000a
    read_only:
    set_data:
      :notes: This policy profile is an example of creation of a single profile that
        contains all policies that should be enforced on all objects in the environment.
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: Configuration Policy Restrict Cloning SQL Server
      description: ! 'Operational: Prevent Cloning of Database VMs'
      expression:
      towhat: Vm
      guid: 39fdeba0-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: prevents cloning of vms with a workload tag value of database
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: cancel_task
          description: Cancel vCenter Task
          guid: e49bfee6-1e1e-11de-8918-0050568005db
          action_type: default
          options: {}
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: SendEmail
          description: SendEmail
          guid: abcf406c-02cd-11de-86d4-005056903dbc
          action_type: email
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :from: evmadmin@manageiq.com
            :to: evm_demo@manageiq.com
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 4468f036-0b6d-11df-bd07-005056a7121f
          description: VM Attribute - Prevent Clone of SQL Server
          guid: 4468f036-0b6d-11df-bd07-005056a7121f
          action_type: set_custom_attribute
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :value: Clone Prevented for SQL Server VM
            :attribute: EVM Policy
      Condition:
      - name: VMs running SQL Server
        description: VMs with Workload - Database
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-function
              value: database
          context_type:
        towhat: Vm
        file_mtime:
        guid: 121ecf62-01c6-11de-a701-005056903dbc
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000064
        notes:
    - name: 994efe7e-18e6-11e0-88b4-005056a7184a
      description: ! 'Snapshots: Delete based on Count'
      expression:
      towhat: Vm
      guid: 994efe7e-18e6-11e0-88b4-005056a7184a
      created_by: admin
      updated_by: admin
      notes: This policy deletes the most recent snapshot when more that 2 snapshots
        exists
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_snapshot_complete
          description: VM Snapshot Create Complete
          guid: 7eb82802-135e-11e0-8706-005056a7184a
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: delete_most_recent_snapshot
          description: Delete Most Recent Snapshot
          guid: 7f6e2f8a-135e-11e0-8706-005056a7184a
          action_type: default
          options: {}
      Condition:
      - name: 992035fc-18e7-11e0-88b4-005056a7184a
        description: Check for more than 2 snapshots
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '&gt;':
              value: '2'
              field: Vm-v_total_snapshots
          context_type:
        towhat: Vm
        file_mtime:
        guid: 992035fc-18e7-11e0-88b4-005056a7184a
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000075
        notes: Checks to see if more than 2 snapshots exist
    - name: Automation Policy - Scope VM Retirement Warning,  ResponseExecute Automation
        Model
      description: ! 'Operational: Retirement Warning'
      expression:
      towhat: Vm
      guid: 39621392-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: This policy raises an automation event when a retirement warning event
        is raised
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_retire_warn
          description: VM Retirement Warning
          guid: 97c85330-fe93-11dd-b5e1-005056903dbc
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: e7da3b7a-1139-11e1-9333-005056af009e
          action_type: default
          options: {}
      Condition: []
    - name: Automation Policy - Scope VM Retired Response Execute Automation Model
      description: ! 'Operational: Vm Retired'
      expression:
      towhat: Vm
      guid: 397700ae-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: This policy raises an automation event when a vm retirement event is
        raised
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_retired
          description: VM Retired
          guid: e363d8aa-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: e7da3b7a-1139-11e1-9333-005056af009e
          action_type: default
          options: {}
      Condition: []
    - name: 427a4378-6519-11df-b637-005056a435be
      description: ! 'Analysis: Post Provisioning'
      expression:
      towhat: Vm
      guid: 427a4378-6519-11df-b637-005056a435be
      created_by: admin
      updated_by: admin
      notes: This policy triggers a vm analysis of any newly provisioned VM
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_provisioned
          description: VM Provision Complete
          guid: 2a17a20a-3e8e-11df-9fe2-005056a435be
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: {}
      Condition: []
    - name: 0c2517d8-1ea2-11e0-8e71-005056910000
      description: ! 'Tag: VM Inherit Cluster Location Tag'
      expression:
      towhat: Vm
      guid: 0c2517d8-1ea2-11e0-8e71-005056910000
      created_by: admin
      updated_by: admin
      notes: This policy allows a vm to inherit the location tag of it's parent cluster
        on creation or completion of analysis
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 60e5d690-1ea2-11e0-8e71-005056910000
          description: ! 'Tag: Inherit Cluster Location Tag'
          guid: 60e5d690-1ea2-11e0-8e71-005056910000
          action_type: inherit_parent_tags
          options:
            :parent_type: ems_cluster
            :cats:
            - location
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 60e5d690-1ea2-11e0-8e71-005056910000
          description: ! 'Tag: Inherit Cluster Location Tag'
          guid: 60e5d690-1ea2-11e0-8e71-005056910000
          action_type: inherit_parent_tags
          options:
            :parent_type: ems_cluster
            :cats:
            - location
      Condition: []
    - name: ! 'Do Not Analyze '
      description: ! 'Analysis: Prevent Analysis of Selected VMs'
      expression:
      towhat: Vm
      guid: 3a7959c0-2866-11de-af2a-0050568026c2
      created_by:
      updated_by: admin
      notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not
        Analyze '
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: request_vm_scan
          description: VM Analysis Request
          guid: e3292c46-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: {}
      Condition:
      - name: Do Not Analyze
        description: VM classified as DO_NOT_ANALYZE
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-exclusions
              value: do_not_analyze
          context_type:
        towhat: Vm
        file_mtime:
        guid: 39ff4444-08e2-11de-829f-005056a164b2
        filename:
        applies_to_exp:
        miq_policy_id: 10000000000001
        notes:
    - name: b968f0a0-3d2e-11df-a7e9-005056a40709
      description: ! 'Tag: VM that Requires Analysis'
      expression:
      towhat: Vm
      guid: b968f0a0-3d2e-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reset
          description: VM Reset
          guid: 4c1b8a3a-37c0-11df-b567-005056a40709
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      Condition: []
    - name: 2f2a1a1c-4806-11df-badc-005056a7121f
      description: ! 'Analysis: VM Reconfiguration'
      expression:
      towhat: Vm
      guid: 2f2a1a1c-4806-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Performs an analysis on any vm that has been reconfigured
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: {}
      Condition: []
    - name: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      description: ! 'Tag: VM on Successful Analysis'
      expression:
      towhat: Vm
      guid: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: cd2f3222-3d2c-11df-a7e9-005056a40709
          description: Tag VM after Successful Analysis
          guid: cd2f3222-3d2c-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_success
      Condition: []
    - name: 07cea762-3d1b-11df-a7e9-005056a40709
      description: ! 'Tag: VM if Analysis not successful'
      expression:
      towhat: Vm
      guid: 07cea762-3d1b-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_abort
          description: VM Analysis Failure
          guid: 4c48a6fa-37c0-11df-b567-005056a40709
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: fc7f2dde-3d22-11df-a7e9-005056a40709
          description: Tag VM that Fails Analysis
          guid: fc7f2dde-3d22-11df-a7e9-005056a40709
          action_type: tag
          options:
            :variables:
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            - :value: ''
              :oid: ''
              :var_type: &lt;None&gt;
            :tags:
            - /managed/operations/analysis_failed
      Condition: []
    - name: 782068f8-44ee-11e0-99a6-00505688000a
      description: ! 'Analysis: VDI Login'
      expression:
      towhat: Vm
      guid: 782068f8-44ee-11e0-99a6-00505688000a
      created_by: admin
      updated_by: admin
      notes: This policy triggers an analysis of a VDI session when a user logs in
        to that session
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_vdi_login_session
          description: VDI Login Session
          guid: 15fc3cce-448a-11e0-9ad1-00505688000a
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: {}
      Condition: []
- MiqPolicySet:
    name: fbc1c9bc-53f9-11e0-babf-00505688000a
    description: ! 'Tag Management: Inheritance Policy'
    set_type: MiqPolicySet
    guid: fbc1c9bc-53f9-11e0-babf-00505688000a
    read_only:
    set_data:
      :notes: This policy profile contains policies that enforce Host and VM inheritence
        of parent cluster tags.
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 0c2517d8-1ea2-11e0-8e71-005056910000
      description: ! 'Tag: VM Inherit Cluster Location Tag'
      expression:
      towhat: Vm
      guid: 0c2517d8-1ea2-11e0-8e71-005056910000
      created_by: admin
      updated_by: admin
      notes: This policy allows a vm to inherit the location tag of it's parent cluster
        on creation or completion of analysis
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 60e5d690-1ea2-11e0-8e71-005056910000
          description: ! 'Tag: Inherit Cluster Location Tag'
          guid: 60e5d690-1ea2-11e0-8e71-005056910000
          action_type: inherit_parent_tags
          options:
            :parent_type: ems_cluster
            :cats:
            - location
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: f7b8361e-1139-11e1-9333-005056af009e
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: 60e5d690-1ea2-11e0-8e71-005056910000
          description: ! 'Tag: Inherit Cluster Location Tag'
          guid: 60e5d690-1ea2-11e0-8e71-005056910000
          action_type: inherit_parent_tags
          options:
            :parent_type: ems_cluster
            :cats:
            - location
      Condition: []
- MiqPolicySet:
    name: bc33dd42-c01d-11e3-b785-001a4a0f459e
    description: VM retirement test
    set_type: MiqPolicySet
    guid: bc33dd42-c01d-11e3-b785-001a4a0f459e
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: b218c83c-c01c-11e3-b785-001a4a0f459e
      description: MyNew VM Control Policy
      expression:
      towhat: Vm
      guid: b218c83c-c01c-11e3-b785-001a4a0f459e
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        success_synchronous: true
        MiqEvent:
          name: vm_retired
          description: VM Retired
          guid: e363d8aa-1e1e-11de-8918-0050568005db
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: e7da3b7a-1139-11e1-9333-005056af009e
          action_type: default
          options: {}
      Condition: []
- MiqPolicySet:
    name: 4a554d7c-21b4-11e2-a38c-0050568b19a3
    description: VM-Operation Policies
    set_type: MiqPolicySet
    guid: 4a554d7c-21b4-11e2-a38c-0050568b19a3
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: 7408efa8-21b3-11e2-a38c-0050568b19a3
      description: Power-Off Virtual Machines
      expression:
      towhat: Vm
      guid: 7408efa8-21b3-11e2-a38c-0050568b19a3
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: 37f2da3e-21a8-11e2-b47a-0050568b19a3
          action_type: default
          options: {}
      Condition:
      - name: d514b2fa-21b3-11e2-a38c-0050568b19a3
        description: VM with Workload Tag Messaging
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            !binary "Q09OVEFJTlM=":
              !binary "dGFn": Vm.managed-function
              !binary "dmFsdWU=": messaging
          context_type:
        towhat: Vm
        file_mtime:
        guid: d514b2fa-21b3-11e2-a38c-0050568b19a3
        filename:
        applies_to_exp:
        miq_policy_id:
        notes:
- MiqPolicySet:
    name: 99a57bb8-e15e-11e1-acfa-005056b25af6
    description: poweron
    set_type: MiqPolicySet
    guid: 99a57bb8-e15e-11e1-acfa-005056b25af6
    read_only:
    set_data:
    mode: control
    owner_type:
    owner_id:
    MiqPolicy:
    - name: d4640a18-e15d-11e1-acfa-005056b25af6
      description: powervm
      expression:
      towhat: Vm
      guid: d4640a18-e15d-11e1-acfa-005056b25af6
      created_by: admin
      updated_by: admin
      notes:
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: 404b4630-21a8-11e2-b47a-0050568b19a3
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: b0138b70-e15d-11e1-8744-005056b25af6
          description: powerVM
          guid: b0138b70-e15d-11e1-8744-005056b25af6
          action_type: custom_automation
          options:
            :ae_message: create
            :ae_request: powerVM
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_poweroff
          description: VM Power Off
          guid: 48beeadc-ae7c-11e1-a76f-005056b25af6
          event_type: Default
          definition:
          default:
          enabled:
        MiqAction:
          name: b0138b70-e15d-11e1-8744-005056b25af6
          description: powerVM
          guid: b0138b70-e15d-11e1-8744-005056b25af6
          action_type: custom_automation
          options:
            :ae_message: create
            :ae_request: powerVM
      Condition: []</pre></div><div class="section" title="3.15.5. Alerts.yaml"><div class="titlepage"><div><div><h3 class="title"><a id="_alerts_yaml"></a>3.15.5. Alerts.yaml</h3></div></div></div><p>Link: <a class="ulink" href="../cloudforms/Control_Import/Alerts.yaml" target="_top">Alerts.yaml</a></p><p>Source:</p><pre class="screen">---
- MiqAlert:
    guid: d59185a4-40bc-11de-bd12-005056a170fa
    description: CPU Ready &gt; 4000 ms for more than 10 min
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: realtime_performance
      :options:
        :operator: ! '&gt;'
        :perf_column: cpu_ready_delta_summation
        :value_threshold: '4000'
        :rt_time_threshold: 600
    responds_to_events: vm_perf_complete
    enabled:
- MiqAlert:
    guid: 20d93374-fde1-11e1-a360-005056b25af6
    description: CPU Usage &gt; 50
    options:
      :notifications:
        :delay_next_evaluation: 600
        :evm_event: {}
        :automate:
          :event_name: alert_cpu
    db: Vm
    expression:
      :eval_method: realtime_performance
      :mode: internal
      :options:
        :perf_column: cpu_usage_rate_average
        :operator: ! '&gt;'
        :value_threshold: '50'
        :trend_direction: none
        :trend_steepness:
        :debug_trace: 'false'
        :rt_time_threshold: 60
    responds_to_events: vm_perf_complete
    enabled: true
- MiqAlert:
    guid: 5bfdef56-13d2-11e2-a735-005056b057a8
    description: CPU Usage Exceeds 90% For More Than 1 Min
    options:
      :notifications:
        :delay_next_evaluation: 600
        :snmp:
          :host:
          - 192.168.255.26
          :trap_id: 1.3.6.1.4.1.33482.3
          :snmp_version: v2
          :variables:
          - :oid: description
            :var_type: OctetString
            :value: Virtual Machine
          - :oid: category
            :var_type: OctetString
            :value: Perfomance
          - :oid: Message
            :var_type: OctetString
            :value: ${cause.description}
          - :oid: object
            :var_type: OctetString
            :value: Name:${object.name}
          - :oid: location
            :var_type: OctetString
            :value: Datastore:${object.path}
          - :oid: platform
            :var_type: OctetString
            :value: OS:${object.platform}
          - :oid: url
            :var_type: OctetString
            :value: http://10.10.1.200/VM/${object.id}
          - :oid: source
            :var_type: OctetString
            :value: EVM:${object.ems}
          - :oid: custom1
            :var_type: OctetString
            :value: Created:${object.created_on} Retires:${retires_on}
          - :oid: custom2
            :var_type: OctetString
            :value: ! 'Cluster:${object.ems_cluster_name} Host: ${object.host_name}'
    db: Vm
    expression:
      :eval_method: realtime_performance
      :mode: internal
      :options:
        :value_threshold: '90'
        :perf_column: v_pct_cpu_used_delta_summation
        :trend_steepness:
        :rt_time_threshold: 60
        :trend_direction: none
        :operator: ! '&gt;'
        :debug_trace: 'false'
    responds_to_events: vm_perf_complete
    enabled: true
- MiqAlert:
    guid: 59174666-cfed-11e2-a54c-000c2980bea6
    description: CloudFLEX
    options:
      :notifications:
        :delay_next_evaluation: 120
        :evm_event: {}
        :automate:
          :event_name: CloudFLEX_EVENT
    db: Vm
    expression:
      :eval_method: realtime_performance
      :mode: !binary |-
        aW50ZXJuYWw=
      :options:
        :perf_column: v_pct_cpu_used_delta_summation
        :operator: !binary |-
          Pg==
        :value_threshold: '50'
        :trend_direction: !binary |-
          bm9uZQ==
        :trend_steepness:
        :debug_trace: !binary |-
          ZmFsc2U=
        :rt_time_threshold: 120
    responds_to_events: vm_perf_complete
    enabled: true
- MiqAlert:
    guid: eb88f942-c23e-11de-a3be-000c290de4f9
    description: Cluster DRS not enabled
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: EmsCluster
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: 'false'
          field: EmsCluster-drs_enabled
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 196868de-c23f-11de-a3be-000c290de4f9
    description: Cluster HA not enabled
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: EmsCluster
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: 'false'
          field: EmsCluster-ha_enabled
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 82f853b0-bf36-11de-b3b4-000c290de4f9
    description: Datacenter VMs &gt; 10
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Storage
    expression: !ruby/object:MiqExpression
      exp:
        ! '&gt;':
          value: 10
          field: Storage-v_total_vms
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 655cccda-6ae5-11e0-bdef-005056a461b8
    description: Datastore Free Space &lt;= 10%
    options:
      :notifications:
        :snmp:
          :variables:
          - :value: ! 'MIQ Datatstore Alert: DEMO'
            :oid: category
            :var_type: OctetString
          - :value: Datastore Free Space &lt;= 10%
            :oid: message
            :var_type: OctetString
          :host:
          - 204.130.60.75
          :trap_id: critical
          :snmp_version: v2
        :delay_next_evaluation: 86400
        :email:
          :from: ''
          :to:
          - cloud_ops@miq.net
        :evm_event: {}
    db: Storage
    expression: !ruby/object:MiqExpression
      exp:
        &lt;=:
          value: '10'
          field: Storage-v_free_space_percent_of_total
      context_type:
    responds_to_events: _hourly_timer_
    enabled: true
- MiqAlert:
    guid: f0782622-fa6c-11e0-98ad-005056be005b
    description: EVM Server High App Disk Usage
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: MiqServer
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: evm_server_app_disk_high_usage
    enabled: true
- MiqAlert:
    guid: 50b6ae6e-fa6d-11e0-a117-005056be005b
    description: EVM Server High DB Disk Usage
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: MiqServer
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: evm_server_db_disk_high_usage
    enabled: true
- MiqAlert:
    guid: 6f0f695a-fa6d-11e0-a117-005056be005b
    description: EVM Server High Log Disk Usage
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: MiqServer
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: evm_server_log_disk_high_usage
    enabled: true
- MiqAlert:
    guid: 8ef83828-fa6d-11e0-98ad-005056be005b
    description: EVM Server High System Disk Usage
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: MiqServer
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: evm_server_system_disk_high_usage
    enabled: true
- MiqAlert:
    guid: 3bfdde58-fa6c-11e0-a117-005056be005b
    description: EVM Server Not Responding
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: MiqServer
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: evm_server_not_responding
    enabled: true
- MiqAlert:
    guid: cdf91470-fa6d-11e0-a117-005056be005b
    description: EVM Server Started
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: MiqServer
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: evm_server_start
    enabled: true
- MiqAlert:
    guid: fc2ae066-44b8-11de-900a-005056a170fa
    description: Host  Event Log Error - Failed to validate VM IP address
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Host
    expression:
      :mode: internal
      :eval_method: hostd_log_threshold
      :options:
        :event_log_message_filter_type: INCLUDES
        :event_log_source: VmMisc
        :freq_threshold: '2'
        :event_log_message_filter_value: Failed to validate VM IP address
        :time_threshold: 86400
    responds_to_events: host_scan_complete
    enabled:
- MiqAlert:
    guid: 0bd6ac74-fa70-11e0-a117-005056be005b
    description: Host Credentials Authentication Error
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: Host
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: host_auth_error
    enabled: true
- MiqAlert:
    guid: 3599fa6e-f9d7-11e0-a117-005056be005b
    description: Host Credentials are Invalid
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: Host
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: host_auth_invalid
    enabled: true
- MiqAlert:
    guid: 9bc0d572-40bd-11de-bd12-005056a170fa
    description: Host Datastore &lt; 5% of Free Space
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Host
    expression: !ruby/object:MiqExpression
      exp:
        FIND:
          checkany:
            ! '&gt;':
              value: 95
              field: Host.storages-v_used_space_percent_of_total
          search:
            IS NOT NULL:
              field: Host.storages-name
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 8a6d32a8-44b8-11de-900a-005056a170fa
    description: ! 'Host Event Log Error - Memory Exceed Soft Limit '
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Host
    expression:
      :mode: internal
      :eval_method: hostd_log_threshold
      :options:
        :event_log_message_filter_type: INCLUDES
        :event_log_source: Memory checker
        :freq_threshold: '2'
        :event_log_message_filter_value: exceeds soft limit
        :event_log_level: warn
        :time_threshold: 86400
    responds_to_events: host_scan_complete
    enabled:
- MiqAlert:
    guid: 561d023c-bf36-11de-b3b4-000c290de4f9
    description: Host VMs &gt;10
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Host
    expression: !ruby/object:MiqExpression
      exp:
        ! '&gt;':
          value: 10
          field: Host-v_total_vms
    responds_to_events:
    enabled:
- MiqAlert:
    guid: a6c34cee-94f3-11df-92e9-0050569a006f
    description: Max - Allocated RAM per VM
    options:
      :notifications:
        :delay_next_evaluation: 3600
        :evm_event: {}
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        ! '&gt;':
          value: '255'
          field: Vm-mem_cpu
      context_type:
    responds_to_events: vm_discover
    enabled: true
- MiqAlert:
    guid: ddfd7df4-950e-11df-b1e3-0050568a6293
    description: Max - Hosts per Cluster
    options:
      :notifications:
        :delay_next_evaluation: 3600
        :evm_event: {}
    db: EmsCluster
    expression: !ruby/object:MiqExpression
      exp:
        ! '&gt;':
          count: EmsCluster.hosts
          value: '32'
      context_type:
    responds_to_events: host_connect
    enabled: true
- MiqAlert:
    guid: 7129b8d8-978d-11df-8cd7-0050569a4433
    description: Max - vCPU per Core &gt;20
    options:
      :notifications:
        :delay_next_evaluation: 3600
        :evm_event: {}
    db: Host
    expression: !ruby/object:MiqExpression
      exp:
        ! '&gt;':
          value: '20'
          field: Host.ems_cluster-v_cpu_vr_ratio
      context_type:
    responds_to_events: host_connect
    enabled: true
- MiqAlert:
    guid: 2f4e5e06-94f3-11df-92e9-0050569a006f
    description: Max - vCpus per VM
    options:
      :notifications:
        :delay_next_evaluation: 3600
        :evm_event: {}
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        ! '&gt;':
          value: '8'
          field: Vm.hardware-numvcpus
      context_type:
    responds_to_events: vm_discover
    enabled: true
- MiqAlert:
    guid: dab5b816-f789-11e1-9144-005056b25af6
    description: Test - VM Analysis Complete
    options:
      :notifications:
        :delay_next_evaluation: 300
        :email:
          :to:
          - scottfisher1@gmail.com
        :evm_event: {}
    db: Vm
    expression:
      :eval_method: nothing
      :mode: internal
      :options: {}
    responds_to_events: vm_scan_complete
    enabled: true
- MiqAlert:
    guid: 391d87fc-fa70-11e0-98ad-005056be005b
    description: VC Authentication Error
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: ExtManagementSystem
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: ems_auth_error
    enabled: true
- MiqAlert:
    guid: 576aabca-f9d7-11e0-a117-005056be005b
    description: VC Credentials are Invalid
    options:
      :notifications:
        :delay_next_evaluation: 14400
        :evm_event: {}
    db: ExtManagementSystem
    expression:
      :mode: internal
      :eval_method: nothing
      :options: {}
    responds_to_events: ems_auth_invalid
    enabled: true
- MiqAlert:
    guid: 58e8a372-bff9-11de-b3b4-000c290de4f9
    description: VM CD Drive or Floppy Connected
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        or:
        - FIND:
            checkall:
              STARTS WITH:
                value: 'true'
                field: Vm.hardware.disks-start_connected
            search:
              INCLUDES:
                value: cdrom
                field: Vm.hardware.disks-device_type
        - FIND:
            checkall:
              INCLUDES:
                value: 'true'
                field: Vm.hardware.disks-start_connected
            search:
              INCLUDES:
                value: floppy
                field: Vm.hardware.disks-device_type
    responds_to_events:
    enabled:
- MiqAlert:
    guid: ce2f8846-44a5-11de-b543-005056a170fa
    description: VM CPU count was decreased
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: reconfigured_hardware_value
      :options:
        :operator: Decreased
        :hdw_attr: :numvcpus
    responds_to_events: vm_reconfigure
    enabled:
- MiqAlert:
    guid: c2fc477a-44a5-11de-b543-005056a170fa
    description: VM CPU count was increased
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: reconfigured_hardware_value
      :options:
        :operator: Increased
        :hdw_attr: :numvcpus
    responds_to_events: vm_reconfigure
    enabled:
- MiqAlert:
    guid: 4077943a-c240-11de-a3be-000c290de4f9
    description: VM Environment Tag &lt;&gt; Datastore Environment Tag
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-environment
            value: prod
        - not:
            CONTAINS:
              tag: Vm.storage.managed-environment
              value: prod
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 89db0be8-c240-11de-a3be-000c290de4f9
    description: VM Environment Tag &lt;&gt; Host Environment Tag
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-environment
            value: prod
        - not:
            CONTAINS:
              tag: Vm.host.managed-environment
              value: prod
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 731da3b2-40bc-11de-bd12-005056a170fa
    description: ! 'VM Guest C: Drive &lt; 10% Free'
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - =:
            value: windows
            field: Vm-platform
        - FIND:
            checkall:
              &lt;:
                value: 10
                field: Vm.hardware.volumes-free_space_percent
            search:
              =:
                value: ! 'C:'
                field: Vm.hardware.volumes-name
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 1bb81254-44a6-11de-b543-005056a170fa
    description: VM Guest Windows Event Log Error - NtpClient
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: event_log_threshold
      :options:
        :event_log_message_filter_type: INCLUDES
        :freq_threshold: '1'
        :event_log_message_filter_value: NtpClient
        :event_log_level: error
        :time_threshold: 86400
    responds_to_events: vm_scan_complete
    enabled:
- MiqAlert:
    guid: f8b870d0-c23d-11de-a3be-000c290de4f9
    description: VM Memory Balloon &gt; 250 in last 10 min
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: realtime_performance
      :options:
        :operator: ! '&gt;'
        :perf_column: mem_vmmemctl_absolute_average
        :value_threshold: '250'
        :rt_time_threshold: 600
    responds_to_events: vm_perf_complete
    enabled:
- MiqAlert:
    guid: fbe4b5ee-447e-11de-aaba-005056a170fa
    description: VM Memory was decreased
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: reconfigured_hardware_value
      :options:
        :operator: Decreased
        :hdw_attr: memory_cpu
    responds_to_events: vm_reconfigure
    enabled:
- MiqAlert:
    guid: e750cdcc-447c-11de-aaba-005056a170fa
    description: VM Memory was increased
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: reconfigured_hardware_value
      :options:
        :operator: Increased
        :hdw_attr: memory_cpu
    responds_to_events: vm_reconfigure
    enabled:
- MiqAlert:
    guid: 3cfbb5ce-40be-11de-bd12-005056a170fa
    description: VM Migration &gt; 1 in last 30 min
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: event_threshold
      :options:
        :event_types:
        - RelocateVM_Task_Complete
        :freq_threshold: '2'
        :time_threshold: 1800
    responds_to_events: ! '["RelocateVM_Task_Complete"]'
    enabled:
- MiqAlert:
    guid: fb73af80-40bd-11de-bd12-005056a170fa
    description: VM Power On &gt; 2 in last 15 min
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: event_threshold
      :options:
        :event_types:
        - PowerOnVM_Task_Complete
        :freq_threshold: '2'
        :time_threshold: 900
    responds_to_events: ! '["PowerOnVM_Task_Complete"]'
    enabled:
- MiqAlert:
    guid: fdee2784-bf2c-11de-b3b4-000c290de4f9
    description: VM Silver and CPU &gt; 1
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: silver
        - ! '&gt;':
            value: 1
            field: Vm.hardware-numvcpus
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 9b61fd9e-bf35-11de-b3b4-000c290de4f9
    description: VM Silver and RAM &gt; 2 GB
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: silver
        - ! '&gt;':
            value: 2048
            field: Vm.hardware-memory_cpu
    responds_to_events:
    enabled:
- MiqAlert:
    guid: 5cd2b880-be53-11de-8d65-000c290de4f9
    description: VM Unregistered
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - IS EMPTY:
            value: ''
            field: Vm.host-name
        - IS NOT EMPTY:
            field: Vm.storage-name
    responds_to_events:
    enabled:
- MiqAlert:
    guid: a9532172-44a5-11de-b543-005056a170fa
    description: VM VMotion &gt; 1 in last 30 min
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Vm
    expression:
      :mode: internal
      :eval_method: event_threshold
      :options:
        :event_types:
        - MigrateVM_Task
        :freq_threshold: '1'
        :time_threshold: 1800
    responds_to_events: ! '["MigrateVM_Task"]'
    enabled:
- MiqAlert:
    guid: 5709f346-05a5-11e1-9288-005056880000
    description: VM with CPU Ready &gt; 2% for 2mins
    options:
      :notifications:
        :delay_next_evaluation: 600
        :automate:
          :event_name: VM_Alert_CPU_Ready
        :evm_event: {}
    db: Vm
    expression:
      :mode: internal
      :eval_method: realtime_performance
      :options:
        :trend_direction: none
        :operator: ! '&gt;'
        :value_threshold: '2'
        :perf_column: v_pct_cpu_ready_delta_summation
        :debug_trace: 'false'
        :trend_steepness:
        :rt_time_threshold: 120
    responds_to_events: vm_perf_complete
    enabled: true
- MiqAlert:
    guid: 8261bf0a-be54-11de-8d65-000c290de4f9
    description: VMs on local storage
    options:
      :notifications:
        :email:
          :from: ''
          :to:
          - alert@manageiq.com
    db: Storage
    expression: !ruby/object:MiqExpression
      exp:
        ! '!=':
          value: 1
          field: Storage-v_total_hosts
    responds_to_events:
    enabled:</pre></div></div><div class="section" title="3.16. Database Backup Procedure"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_database_backup_procedure"></a>3.16. Database Backup Procedure</h2></div></div></div><p>There are two way to perform backups.</p><p>1) RECOMMENDED: This method is done through the Web UI and allows you to set up schedules and to have the backups be on an NFS or Samba share.</p><p>2) Manually through the DB Appliance SSH session</p><div class="section" title="3.16.1. Web UI: Single Run Database Backup"><div class="titlepage"><div><div><h3 class="title"><a id="_web_ui_single_run_database_backup"></a>3.16.1. Web UI: Single Run Database Backup</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Go to Configure &gt; Configuration &gt; Diagnostics (Left hand navigation menu) &gt; Select Region (i.e. Region 10) &gt; Click on Database Tab
</li><li class="listitem">
in the Database Backup Settings enter the following:
</li></ul></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="212pt" /><col width="212pt" /></colgroup><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Type:</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Network File System</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>URI: nfs://</p></td><td style="" align="left" valign="top"><p>c3pudrnas1:/drnas/cloudforms</p></td></tr></tbody></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click on Submit
</li><li class="listitem">
Click OK in the pop-up "Are you sure you want to Run a Database Backup Now?"
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/database/image1.png" alt="../cloudforms/database/image1.png" /></span></p></div><div class="section" title="3.16.2. Web UI: Scheduled Database Backup"><div class="titlepage"><div><div><h3 class="title"><a id="_web_ui_scheduled_database_backup"></a>3.16.2. Web UI: Scheduled Database Backup</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Go to Configure &gt; Configuration &gt; Settings &gt; Select Schedules within the Left Hand Menu
</li><li class="listitem">
Fill out the settings as show in the image
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/database/image2.png" alt="../cloudforms/database/image2.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click Add
</li></ul></div></div><div class="section" title="3.16.3. SSH: Manual Database Backup"><div class="titlepage"><div><div><h3 class="title"><a id="_ssh_manual_database_backup"></a>3.16.3. SSH: Manual Database Backup</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
SSH into the appliance
</li><li class="listitem">
switch to postgres user
</li></ul></div><pre class="screen">su - postgres</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Run backup command
</li></ul></div><pre class="screen">pg_dump vmdb_production | gzip &gt; /tmp/postgres_db_backup.gz</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
To restore
</li></ul></div><pre class="screen">cat /tmp/postgres_db_backup.gz | gunzip | psql vmdb_production</pre></div></div><div class="section" title="3.17. Member Groups"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_member_groups"></a>3.17. Member Groups</h2></div></div></div><div class="section" title="3.17.1. Creating/Importing Group from LDAP/Active Directory"><div class="titlepage"><div><div><h3 class="title"><a id="_creating_importing_group_from_ldap_active_directory"></a>3.17.1. Creating/Importing Group from LDAP/Active Directory</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Go to Configure &gt; Configuration &gt; Access Control &gt; Click on Groups
</li><li class="listitem">
Click on the Configuration Button &gt; Select Add New Group
</li><li class="listitem">
In the Group Information enter the following:
</li></ul></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="212pt" /><col width="212pt" /></colgroup><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Description:</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>&lt;Name of LDAP Group&gt;</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>Role:</p></td><td style="" align="left" valign="top"><p>&lt;Select appropiate Role that was created&gt;</p></td></tr></tbody></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Select Filters for this group on the right.
</li><li class="listitem">
Click on Save
</li></ul></div><div class="important" title="Important" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="./images/icons/important.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The filters selected is what will determine what objects the user in this group will be able to see.  Example:  If the user is part of Department A, and you select "Department &gt; Department A" this user will only EVER see any objects that are tagged with the "Department A" tag.</p></td></tr></table></div><p>Example:</p><p><span class="inlinemediaobject"><img src="../cloudforms/LDAP/user_groups.png" alt="../cloudforms/LDAP/user_groups.png" /></span></p><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>You may also leave the Description Blank and then check the "(Look Up LDAP Groups)" check-box and in the "LDAP Group Look Up" section enter a User to Look up and use your LDAP user / password to retrieve all of the groups this member is a part of.  Then select from the Drop Down in "Group Information" with the according LDAP/AD Group that you want to create.   Once the group is select it will automatically replace the contents of the "Description" Field.  After this is done, select the according Filters on the right side.</p></td></tr></table></div></div><div class="section" title="3.17.2. Adding Smart Management Tag to Group"><div class="titlepage"><div><div><h3 class="title"><a id="_adding_smart_management_tag_to_group"></a>3.17.2. Adding Smart Management Tag to Group</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Select the Group that was previously created
</li><li class="listitem">
Click on Policy
</li><li class="listitem">
Click on "Edit Premier, Inc’s Tags for this Group"
</li><li class="listitem">
in the "Select a customer tag to assign" select Department, then select the appropiate Department
</li><li class="listitem">
in the "Select a customer tag to assign" select Cost Center, then select the appropiate Cost Center
</li></ul></div><p>Example:</p><p><span class="inlinemediaobject"><img src="../cloudforms/LDAP/group_tags.png" alt="../cloudforms/LDAP/group_tags.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click Save
</li></ul></div></div><div class="section" title="3.17.3. Groups created during Engagement"><div class="titlepage"><div><div><h3 class="title"><a id="_groups_created_during_engagement"></a>3.17.3. Groups created during Engagement</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; border-left: 2px solid #527bbd; border-right: 2px solid #527bbd; "><colgroup><col width="70pt" /><col width="70pt" /><col width="70pt" /><col width="70pt" /><col width="70pt" /><col width="70pt" /></colgroup><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Group Name</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Role</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Tag: Cost Center</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Tag: Department</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Filters</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Notes</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Unix Admins</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Premier-Admin</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Unix Team</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Unix Team</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>None</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>No Tags or Filters are created in order to assure the admins can see ALL resources</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>ITS Unix Admins</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Premier-Admin</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Unix Team</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>Unix Team</p></td><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>None</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>No Tags or Filters are created in order to assure the admins can see ALL resources</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>ITS Server Team</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>Premier-Developer</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>Department A</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>Department A</p></td><td style="border-right: 1px solid ; " align="left" valign="top"><p>Department A</p></td><td style="" align="left" valign="top"><p>This will only allow this group to view only objects/resources tagged with Department A</p></td></tr></tbody></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
NOTE: The Smart Management Tags added to groups will make it so that when these users in these groups provision any Instances/VM’s it will automatically tag the Instances/VM’s with the provided tags
</li></ul></div></div></div><div class="section" title="3.18. Tag Taxonomy"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_tag_taxonomy"></a>3.18. Tag Taxonomy</h2></div></div></div><div class="section" title="3.18.1. Environment"><div class="titlepage"><div><div><h3 class="title"><a id="_environment"></a>3.18.1. Environment</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>dev</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Development</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>preprod</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>PreProd</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>prod</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Production</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>qa</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>QA</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>test</p></td><td style="" align="left" valign="top"><p>Test</p></td></tr></tbody></table></div></div><div class="section" title="3.18.2. Locations"><div class="titlepage"><div><div><h3 class="title"><a id="_locations"></a>3.18.2. Locations</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>Atlanta</p></td><td style="" align="left" valign="top"><p>Atlanta</p></td></tr></tbody></table></div></div><div class="section" title="3.18.3. Owners"><div class="titlepage"><div><div><h3 class="title"><a id="_owners"></a>3.18.3. Owners</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>developers</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Developers</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>engineer</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Engineer</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>unixteam</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Unix Team</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>windowsteam</p></td><td style="" align="left" valign="top"><p>Windows Team</p></td></tr></tbody></table></div></div><div class="section" title="3.18.4. Provisioning Scope"><div class="titlepage"><div><div><h3 class="title"><a id="_provisioning_scope"></a>3.18.4. Provisioning Scope</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>all</p></td><td style="" align="left" valign="top"><p>All</p></td></tr></tbody></table></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Additional Provisioning Scopes to be added at a later time</p></td></tr></table></div></div><div class="section" title="3.18.5. Storage Types"><div class="titlepage"><div><div><h3 class="title"><a id="_storage_types"></a>3.18.5. Storage Types</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>tier1</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Tier 1</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>tier2</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Tier 2</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>tier3</p></td><td style="" align="left" valign="top"><p>Tier 3</p></td></tr></tbody></table></div></div><div class="section" title="3.18.6. Cost Center"><div class="titlepage"><div><div><h3 class="title"><a id="_cost_center"></a>3.18.6. Cost Center</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>database_team</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Database Team</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>department_a</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Department A</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>department_b</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Department B</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>department_c</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Department C</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>engineering</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Engineering</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>finance</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Financial Services</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>hr</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Human Resources</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>infrastructure</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Infrastructure</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>marketing</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Marketing</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>network_team</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Network Team</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>unix_team</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Unix Team</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>windows_team</p></td><td style="" align="left" valign="top"><p>Windows Team</p></td></tr></tbody></table></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Additional Cost Center to be added at a later time</p></td></tr></table></div></div><div class="section" title="3.18.7. Department"><div class="titlepage"><div><div><h3 class="title"><a id="_department"></a>3.18.7. Department</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>database_team</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Database Team</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>department_a</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Department A</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>department_b</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Department B</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>department_c</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Department C</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>engineering</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Engineering</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>finance</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Financial Services</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>hr</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Human Resources</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>infrastructure</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Infrastructure</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>marketing</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Marketing</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>network_team</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Network Team</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>unix_team</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Unix Team</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>windows_team</p></td><td style="" align="left" valign="top"><p>Windows Team</p></td></tr></tbody></table></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Additional Departments to be added at a later time</p></td></tr></table></div></div><div class="section" title="3.18.8. Workload"><div class="titlepage"><div><div><h3 class="title"><a id="_workload"></a>3.18.8. Workload</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>active_directory</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Active Directory Server</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>application_servers</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Application Servers</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>cognos</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Cognos</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>database</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Database</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>db2_server</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>IBM DB2</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>desktop</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Desktop</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>dhcp</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>DHCP Server</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>evm_appliance</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>EVM Appliance</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>hadoop</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Hadoop</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>infrastructure</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Virtual Infrastructure Management</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>jboss_server</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>JBOSS Server</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>messaging</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Messaging</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>oracle_server</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Oracle Database</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>proxy_server</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Proxy Server</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>security</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Security</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>web_server</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Web Server</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>websphere_server</p></td><td style="" align="left" valign="top"><p>Websphere</p></td></tr></tbody></table></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Additional Cost Center to be added at a later time</p></td></tr></table></div></div><div class="section" title="3.18.9. Service Level"><div class="titlepage"><div><div><h3 class="title"><a id="_service_level"></a>3.18.9. Service Level</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>gold</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Gold</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>platinum</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Platinum</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>silver</p></td><td style="" align="left" valign="top"><p>Silver</p></td></tr></tbody></table></div></div><div class="section" title="3.18.10. Auto Approve - Max CPU"><div class="titlepage"><div><div><h3 class="title"><a id="_auto_approve_max_cpu"></a>3.18.10. Auto Approve - Max CPU</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>1</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>2</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>2</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>3</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>3</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>4</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>4</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>5</p></td><td style="" align="left" valign="top"><p>5</p></td></tr></tbody></table></div></div><div class="section" title="3.18.11. Auto Approve - Max Memory"><div class="titlepage"><div><div><h3 class="title"><a id="_auto_approve_max_memory"></a>3.18.11. Auto Approve - Max Memory</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>1024</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>1GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>2048</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>2GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>4096</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>4GB</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>8192</p></td><td style="" align="left" valign="top"><p>8GB</p></td></tr></tbody></table></div></div><div class="section" title="3.18.12. Auto Approve - Retirement Days"><div class="titlepage"><div><div><h3 class="title"><a id="_auto_approve_retirement_days"></a>3.18.12. Auto Approve - Retirement Days</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>30</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>30</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>60</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>60</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>90</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>90</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>180</p></td><td style="" align="left" valign="top"><p>180</p></td></tr></tbody></table></div></div><div class="section" title="3.18.13. Auto Approve - Max VM"><div class="titlepage"><div><div><h3 class="title"><a id="_auto_approve_max_vm"></a>3.18.13. Auto Approve - Max VM</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>1</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>2</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>2</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>3</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>3</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>4</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>4</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>5</p></td><td style="" align="left" valign="top"><p>5</p></td></tr></tbody></table></div></div><div class="section" title="3.18.14. Quota - Max Memory"><div class="titlepage"><div><div><h3 class="title"><a id="_quota_max_memory"></a>3.18.14. Quota - Max Memory</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>1024</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>1GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>2048</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>2GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>4096</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>4GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>8192</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>8GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10240</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>10GB</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>16384</p></td><td style="" align="left" valign="top"><p>16GB</p></td></tr></tbody></table></div></div><div class="section" title="3.18.15. Quota - Max Storage"><div class="titlepage"><div><div><h3 class="title"><a id="_quota_max_storage"></a>3.18.15. Quota - Max Storage</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>10GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>20</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>20GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>40</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>40GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>80</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>80GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>100</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>100GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>200</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>200GB</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>400</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>400GB</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>1000</p></td><td style="" align="left" valign="top"><p>1TB</p></td></tr></tbody></table></div></div><div class="section" title="3.18.16. Quota - Max CPU"><div class="titlepage"><div><div><h3 class="title"><a id="_quota_max_cpu"></a>3.18.16. Quota - Max CPU</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 2px solid #527bbd; border-bottom: 2px solid #527bbd; "><colgroup><col width="85pt" /><col width="85pt" /></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"> Name                        </th><th style="border-bottom: 1px solid ; " align="left" valign="top">   Display</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>1</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>2</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>2</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>3</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>3</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>4</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>4</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>5</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>5</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>10</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>10</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>20</p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>20</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p>30</p></td><td style="" align="left" valign="top"><p>30</p></td></tr></tbody></table></div></div></div><div class="section" title="3.19. Service Catalog"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_service_catalog"></a>3.19. Service Catalog</h2></div></div></div><div class="section" title="3.19.1. Create new Catalogs"><div class="titlepage"><div><div><h3 class="title"><a id="_create_new_catalogs"></a>3.19.1. Create new Catalogs</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Go to Services &gt; Catalog &gt; Click on "Catalogs" menu on the left hand side
</li><li class="listitem">
Click the "Configuration" Button
</li><li class="listitem">
Select "Add a New Catalog"
</li><li class="listitem">
Enter the Name of the Catalog
</li><li class="listitem">
Enter the Description of the Catalog
</li></ul></div></div><div class="section" title="3.19.2. Create New Catalog Item"><div class="titlepage"><div><div><h3 class="title"><a id="_create_new_catalog_item"></a>3.19.2. Create New Catalog Item</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Go to Services &gt; Catalog &gt; Click on "Catalog Items" menu on the left hand side
</li><li class="listitem">
Select the Catalog that was previously created
</li><li class="listitem">
Click the "Configuration" Button
</li><li class="listitem">
Select "Add a New Catalog Item"
</li><li class="listitem"><p class="simpara">
Should bring you to the "Basic Info" Tab
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Choose the Catalog Item Type, i.e. Openstack
</li></ul></div></li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item1.png" alt="../cloudforms/Catalogs/catalog_item1.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Enter the Name and Description and Check the "Display in Catalog"
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item2.png" alt="../cloudforms/Catalogs/catalog_item2.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Once the rest of the view is expanded Select the Catalog. i.e. 001-Dev
</li><li class="listitem">
Select the Dialog i.e. Basic VM
</li><li class="listitem">
Provisioning Entry Point (NS/Cls/Inst): /Factory/StateMachines/ServiceProvision_Template/CatalogItemInitialization
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item3.png" alt="../cloudforms/Catalogs/catalog_item3.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click Apply
</li><li class="listitem">
Retirement Entry Point (NS/Cls/Inst): /Factory/StateMachines/ServiceRetirement/Default
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item4.png" alt="../cloudforms/Catalogs/catalog_item4.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Click Apply
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Click on the "Request Info" Tab
</li></ul></div></li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item5.png" alt="../cloudforms/Catalogs/catalog_item5.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Request Info: Catalog
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Select Name of the Template (i.e. rhel6)
</li><li class="listitem">
Enter Instance Name "changeme" (note: this will be changed later using the Service Dialog, just leave it as changeme
</li></ul></div></li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item6.png" alt="../cloudforms/Catalogs/catalog_item6.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Request Info: Click on the Environment Tab
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Placement Options: Availability Zones: <span class="strong"><strong>nova</strong></span>
</li><li class="listitem">
Placement Options: Cloud Network: <span class="strong"><strong>publicnet</strong></span>
</li></ul></div></li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item7.png" alt="../cloudforms/Catalogs/catalog_item7.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Request Info: Click on the Properties Tab
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Properties: Instance Type: i.e. m1.medium
</li><li class="listitem">
Properties: Guest Access Key Pair: devops
</li></ul></div></li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item8.png" alt="../cloudforms/Catalogs/catalog_item8.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Request Info: Click on the Schedule Tab
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Schedule: Time until Retirement: i.e. Indefinite
</li></ul></div></li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item9.png" alt="../cloudforms/Catalogs/catalog_item9.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click Add
</li></ul></div></div><div class="section" title="3.19.3. Change the Catalog Item Custom Image"><div class="titlepage"><div><div><h3 class="title"><a id="_change_the_catalog_item_custom_image"></a>3.19.3. Change the Catalog Item Custom Image</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Select the Catalog Item to upload a custom image to
</li><li class="listitem">
Click on Browse and select Image to use
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item10.png" alt="../cloudforms/Catalogs/catalog_item10.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Now you will see the custom image for the Catalog Item be updated
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item11.png" alt="../cloudforms/Catalogs/catalog_item11.png" /></span></p></div><div class="section" title="3.19.4. Create New Catalog Bundle"><div class="titlepage"><div><div><h3 class="title"><a id="_create_new_catalog_bundle"></a>3.19.4. Create New Catalog Bundle</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Go to Services &gt; Catalog &gt; Click on "Catalog Items" menu on the left hand side
</li><li class="listitem">
Select the Catalog that was previously created
</li><li class="listitem">
Click the "Configuration" Button
</li><li class="listitem">
Select "Add a New Catalog Bundle"
</li><li class="listitem"><p class="simpara">
Should bring you to the "Basic Info" Tab
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Enter the Name and Description and Check the "Display in Catalog"
</li></ul></div></li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item12.png" alt="../cloudforms/Catalogs/catalog_item12.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Once the rest of the view is expanded Select the Catalog. i.e. 001-Dev
</li><li class="listitem">
Select the Dialog &lt;Blank&gt;
</li></ul></div><div class="important" title="Important" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="./images/icons/important.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>You can select another Dialog, but you have to make sure it is for a Bundle and not a single Item)</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Provisioning Entry Point (NS/Cls/Inst): /Factory/StateMachines/ServiceProvision_Template/CatalogBundleInitialization
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item13.png" alt="../cloudforms/Catalogs/catalog_item13.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click Apply
</li><li class="listitem">
Retirement Entry Point (NS/Cls/Inst): /Factory/StateMachines/ServiceRetirement/Default
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item4.png" alt="../cloudforms/Catalogs/catalog_item4.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click Apply
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item14.png" alt="../cloudforms/Catalogs/catalog_item14.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Click on the "Resources" Tab
</li></ul></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item15.png" alt="../cloudforms/Catalogs/catalog_item15.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Select an existing Catalog Item Resource (i.e. RHEL 6.4 - Small)
</li><li class="listitem">
Select an additional Catalog Item Resource (i.e. RHEL 6.4 - Medium)
</li><li class="listitem">
Repeat the previous 2 steps as many times as needed for all of the resources required for this bundle
</li><li class="listitem">
If needed, modify the Action Order or Provision Order:
</li></ul></div><div class="note" title="Note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="./images/icons/note.png" /></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Provision Order will only worry about in which order it will actually provision the instance/vm.  The Action Order is done once the provisioning is completed it will then perform the action specified in that order.  Example:  You can have the same Provision Order, but only care about the order that things are powered on.</p></td></tr></table></div><p><span class="inlinemediaobject"><img src="../cloudforms/Catalogs/catalog_item16.png" alt="../cloudforms/Catalogs/catalog_item16.png" /></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
In the above screenshot, "RHEL 6.4 - Small" will power on before "RHEL 6.4 - Medium"
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
Click Add
</li></ul></div></li></ul></div></div></div><div class="section" title="3.20. Cloudforms: Appendix"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_cloudforms_appendix"></a>3.20. Cloudforms: Appendix</h2></div></div></div><div class="section" title="3.20.1. Datastore Import File: namespace_MCICOM.xml"><div class="titlepage"><div><div><h3 class="title"><a id="_datastore_import_file_ulink_url_cloudforms_automate_backups_namespace_mcicom_xml_namespace_mcicom_xml_ulink"></a>3.20.1. Datastore Import File: <a class="ulink" href="../cloudforms/automate_backups/namespace_MCICOM.xml" target="_top">namespace_MCICOM.xml</a></h3></div></div></div><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;MiqAeDatastore version="1.0"&gt;
  &lt;MiqAeClass name="Rapid_Clone" namespace="MCICOM/StateMachines"&gt;
    &lt;MiqAeSchema&gt;
      &lt;MiqAeField name="Execute_Rapid_Clone" substitute="true" aetype="state" datatype="string" priority="1" message="create"&gt;
/MCICOM/Integration/RapidClone/Execute_Rapid_Clone      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="Email_Owner" substitute="true" aetype="state" datatype="string" priority="2" message="create"&gt;
/MCICOM/Integration/RapidClone/Rapid_Clone_Email_Complete      &lt;/MiqAeField&gt;
    &lt;/MiqAeSchema&gt;
  &lt;/MiqAeClass&gt;
  &lt;MiqAeClass name="RailsRunner" namespace="MCICOM/Integration" display_name="RailsRunner"&gt;
    &lt;MiqAeMethod name="customspecprep" language="ruby" scope="instance" location="inline" display_name="CustomSpecPrep"&gt;&lt;![CDATA[$evm.object['rails_ruby_code'] = &lt;&lt;EOX.chomp
require 'json'

STDOUT.puts JSON.dump(CustomSpec.all.collect do |cs|
  details = cs.customspec_info_details.collect do |csd|
    csd.attributes.select { |k| ['id', 'name', 'ems_id'].include?(k) }
  end
  cs.attributes.select { |k| ['id', 'name', 'ems_id'].include?(k) }.merge('customspec_info_details' =&gt; details)
end)
EOX

$evm.log('info', "Prepaired Ruby: [#{evm.object['rails_ruby_code']}]")]]&gt;    &lt;/MiqAeMethod&gt;
    &lt;MiqAeSchema&gt;
      &lt;MiqAeField name="PrepairRailsCode" substitute="true" aetype="method" datatype="string" priority="1" message="create"&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeSchema&gt;
    &lt;MiqAeInstance name="CustomSpec" display_name="CustomSpec"&gt;
      &lt;MiqAeField name="PrepairRailsCode"&gt;
CustomSpecPrep      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
  &lt;/MiqAeClass&gt;
  &lt;MiqAeClass name="RapidClone" namespace="MCICOM/Integration"&gt;
    &lt;MiqAeMethod name="Dialog_Destination_Folder" language="ruby" scope="instance" location="inline"&gt;&lt;![CDATA[###################################
    #
    # EVM Automate Method: Dialog_Destination_Folder
    #
    # Notes: Dialog_Destination_Folder
    #
    ###################################
begin
  @method = 'Dialog_Destination_Folder'
  $evm.log("info", "#{@method} - EVM Automate Method Started")

  # Turn of verbose logging
  @debug = true

  vm = $evm.root['vm']
  ems = vm.ext_management_system
  folder_array = []
  folder_array &lt;&lt; [nil,nil]
  folders = ems.ems_folders.each {|ef|
    val = []
   # $evm.log("info", "#{@method} - #{ef.inspect}")
    if ef.is_datacenter == false &amp;&amp; ef.name != "Datacenters" &amp;&amp; ef.name != "host" &amp;&amp; ef.name != "vm"
      val &lt;&lt; "#{ef.name}"
      val &lt;&lt; "#{ef.ems_ref}"
      folder_array &lt;&lt; val
    end
  }

  list_values = {
      'sort_by' =&gt; :none,
      'data_type' =&gt; :string,
      'required' =&gt; :false,
      'values' =&gt; folder_array
  }

  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; display drop-down: #{list_values}")
  list_values.each {|k,v| $evm.object[k] = v }

  #
  # Exit method
  #
  $evm.log("info", "#{@method} - EVM Automate Method Ended")
  exit MIQ_OK

    #
    # Set Ruby rescue behavior
    #
rescue =&gt; err
  $evm.log("error", "#{@method} - [#{err}]\n#{err.backtrace.join("\n")}")
  exit MIQ_ABORT
end
]]&gt;    &lt;/MiqAeMethod&gt;
    &lt;MiqAeMethod name="Dialog_Storage_Controller" language="ruby" scope="instance" location="inline"&gt;&lt;![CDATA[###################################
#
# EVM Automate Method: Dialog_Storage_Controller
#
# Notes: Populate Dialog_Storage_Controller
#
###################################
begin
  @method = 'Dialog_Storage_Controller'
  $evm.log("info", "#{@method} - EVM Automate Method Started")

  # Turn of verbose logging
  @debug = true

  dialog_hash = { "netapp02a (Default)" =&gt; "10.2.100.19", "netapp02a" =&gt; "10.2.100.19", "netapp02b" =&gt; "10.2.100.20", "netapp03a" =&gt; "10.2.100.21" }
  dialog_field = $evm.object
  dialog_field["sort_by"] = "none"
  dialog_field["data_type"] = "string"
  dialog_field["required"] = "true"
  dialog_field["values"] = dialog_hash
  dialog_field["default_value"] = "netapp02a"

  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; display drop-down: #{dialog_hash.inspect}")

  #
  # Exit method
  #
  $evm.log("info", "#{@method} - EVM Automate Method Ended")
  exit MIQ_OK

    #
    # Set Ruby rescue behavior
    #
rescue =&gt; err
  $evm.log("error", "#{@method} - [#{err}]\n#{err.backtrace.join("\n")}")
  exit MIQ_ABORT
end]]&gt;    &lt;/MiqAeMethod&gt;
    &lt;MiqAeMethod name="Dialog_VM_Sizing" language="ruby" scope="instance" location="inline"&gt;&lt;![CDATA[###################################
#
# EVM Automate Method: Dialog_VM_Sizing
#
# Notes: Populate Dialog_VM_Sizing CPU and Memory
#
###################################
begin
  @method = 'Dialog_VM_Sizing'
  $evm.log("info", "#{@method} - EVM Automate Method Started")

  # Turn of verbose logging
  @debug = true

  @action = nil
  @action ||= $evm.object['action']

  vm = $evm.root['vm']

  @vm_memory_cpu = vm.hardware['memory_cpu']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_memory_cpu: #{@vm_memory_cpu}")

  @vm_numvcpus = vm.hardware['numvcpus']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_numvcpus: #{@vm_numvcpus}")

  case @action
    when "memory"
      mem_val = 1024
      vm_mem = @vm_memory_cpu.to_i / 1024
      mem_array = []
      default_val = [nil,nil]
      mem_array &lt;&lt; default_val
      for n in 1..16
        $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; mem_val: #{mem_val}, mem_array: #{mem_array}")
        val = []
        val &lt;&lt; "#{n}"
        val &lt;&lt; mem_val.to_i
        mem_array &lt;&lt; val
        mem_val = mem_val.to_i + 1024
      end
      list_values = {
          'sort_by' =&gt; :none,
          'data_type' =&gt; :string,
          'required' =&gt; :true,
          'values' =&gt; mem_array
      }

      $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; display drop-down: #{list_values}")
      list_values.each {|k,v| $evm.object[k] = v }

    when "cpu"
      cpu_array = []
      default_val = [nil,nil]
      cpu_array &lt;&lt; default_val
      for n in 1..12
        val = []
        val &lt;&lt; n
        val &lt;&lt; n
        cpu_array &lt;&lt; val
      end

      list_values = {
          'sort_by' =&gt; :none,
          'data_type' =&gt; :integer,
          'required' =&gt; :true,
          'values' =&gt; cpu_array
      }
      $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; display drop-down: #{list_values}")
      list_values.each {|k,v| $evm.object[k] = v }


  end

  #
  # Exit method
  #
  $evm.log("info", "#{@method} - EVM Automate Method Ended")
  exit MIQ_OK

    #
    # Set Ruby rescue behavior
    #
rescue =&gt; err
  $evm.log("error", "#{@method} - [#{err}]\n#{err.backtrace.join("\n")}")
  exit MIQ_ABORT
end]]&gt;    &lt;/MiqAeMethod&gt;
    &lt;MiqAeMethod name="Execute_Rapid_Clone" language="ruby" scope="instance" location="inline"&gt;&lt;![CDATA[###################################
#
# EVM Automate Method: Execute_Rapid_Clone
#
#
#
###################################
begin
  @method = 'Execute_Rapid_Clone'
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; Started")

  #########################
  # Method: dumpRoot
  # Description: Dump Root information
  ##########################
  def dumpRoot
    $evm.log("info", "#{@method} - Root:&lt;$evm.root&gt; Begin Attributes")
    $evm.root.attributes.sort.each { |k, v| $evm.log("info", "#{@method} - Root:&lt;$evm.root&gt; Attributes - #{k}: #{v}")}
    $evm.log("info", "#{@method} - Root:&lt;$evm.root&gt; End Attributes")
    $evm.log("info", "")
  end

  # dump root object attributes
  dumpRoot

  #########################
  # add required gems
  ##########################
  require 'savon'
  require 'nokogiri'
  require 'httpclient'
  HTTPI.adapter = :httpclient

  #########################
  # Gather up instance object variables
  ##########################
  @servername = nil
  @servername ||= $evm.object['servername']

  @username = nil
  @username ||= $evm.object['username']

  @password = nil
  @password ||= $evm.object.decrypt('password')

  controller_ip = nil
  controller_ip ||= $evm.object['controller_ip']

  controller_username = nil
  controller_username ||= $evm.object['controller_username']

  controller_password = nil
  controller_password ||= $evm.object.decrypt('controller_password')

  @netapp_url = "https://#{@servername.to_s}:8143/kamino/public/api?wsdl"

  #########################
  # Gather up VM object variables
  ##########################
  vm = $evm.root['vm']
  @vm_name = vm.attributes['name']
  @vm_location = vm.attributes['location']
  @vm_vendor = vm.attributes['vendor']
  @vm_host_id = vm.attributes['host_id']
  @vm_ems_ref = vm.attributes['ems_ref']
  @vm_type = vm.attributes['type']
  @vm_storage_name = vm.storage['name']
  @vm_storage_ems_ref = vm.storage['ems_ref']
  @vm_v_ems_cluster_name = vm.ems_cluster_name
  @vm_v_parent_blue_folder_1_name = vm.parent_blue_folder_1_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; @vm_v_parent_blue_folder_1_name.inspect: #{@vm_v_parent_blue_folder_1_name.inspect}")

  @vm_v_parent_blue_folder_2_name = vm.parent_blue_folder_2_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; @vm_v_parent_blue_folder_2_name.inspect: #{@vm_v_parent_blue_folder_2_name.inspect}")

  @vm_v_parent_blue_folder_3_name = vm.parent_blue_folder_3_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; @vm_v_parent_blue_folder_3_name.inspect: #{@vm_v_parent_blue_folder_3_name.inspect}")

  @vm_v_parent_blue_folder_4_name = vm.parent_blue_folder_4_name
  @vm_v_parent_blue_folder_5_name = vm.parent_blue_folder_5_name
  @vm_v_parent_blue_folder_6_name = vm.parent_blue_folder_6_name
  @vm_v_parent_blue_folder_7_name = vm.parent_blue_folder_7_name
  @vm_v_parent_blue_folder_8_name = vm.parent_blue_folder_8_name
  @vm_v_owning_datacenter = vm.v_owning_datacenter
  @vm_v_parent_blue_folder_9_name = vm.parent_blue_folder_9_name
  @vm_v_storage_name = vm.storage_name

  #########################
  # Method: getObjectRef
  # Query the NetApp API with real object name to get VMware Object Reference Names
  ##########################
  def getObjectRef(netapp_url, servername, username, password, arg_name, arg_type)
    #########################
    # Savon Configuration
    ##########################
    Savon.configure do |config|
      config.log = false
#      config.log_level = :info
#      config.pretty_print_xml = true
    end

    client = Savon::Client.new do |wsdl, http, wsse|
      wsdl.document = "#{netapp_url}"
      wsdl.endpoint = "#{netapp_url}"
      http.auth.ssl.verify_mode = :none
    end
    response = client.request "ser:getMoref" do
      soap.namespaces.merge!({
                                 "xmlns:soapenv" =&gt; "http://schemas.xmlsoap.org/soap/envelope/",
                                 "xmlns:ser" =&gt; "http://server.kamino.netapp.com/"
                             })
      soap.header = {}
      soap.body = { 'arg0' =&gt; "#{arg_name}", 'arg1' =&gt; "#{arg_type}", 'arg2' =&gt; { 'serviceUrl' =&gt; "https://#{servername.to_s}/sdk", 'vcPassword' =&gt; "#{password.to_s}", 'vcUser' =&gt; "#{username.to_s}" } }
    end
    response_hash = response.to_hash[:get_moref_response]
    ref_obj = "#{response_hash[:return]}"
    return ref_obj
  end

  #########################
  # Method: getObjectRef
  # Query the NetApp API with real object name to get VMware Object Reference Names
  ##########################
  def getVmFiles(netapp_url, servername, username, password, arg_name)
    #########################
    # Savon Configuration
    ##########################
    Savon.configure do |config|
      config.log = false
#      config.log_level = :info
#      config.pretty_print_xml = true
    end

    client = Savon::Client.new do |wsdl, http, wsse|
      wsdl.document = "#{netapp_url}"
      wsdl.endpoint = "#{netapp_url}"
      http.auth.ssl.verify_mode = :none
    end
    response = client.request "ser:getVmFiles" do
      soap.namespaces.merge!({
                                 "xmlns:soapenv" =&gt; "http://schemas.xmlsoap.org/soap/envelope/",
                                 "xmlns:ser" =&gt; "http://server.kamino.netapp.com/"
                             })
      soap.header = {}
      soap.body = { 'arg0' =&gt; "#{arg_name}", 'arg1' =&gt; { 'serviceUrl' =&gt; "https://#{servername.to_s}/sdk", 'vcPassword' =&gt; "#{password.to_s}", 'vcUser' =&gt; "#{username.to_s}" } }
    end

    $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; response.to_hash.inspect: #{response.to_hash.inspect}")

    response_hash = response.to_hash[:get_vm_files_response]
    $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; response_hash.inspect: #{response_hash.inspect}")

    file_array = []
    response_hash[:return].each { |v|
      file_hash = {}
      file_hash['source_path'] = v[:source_path].to_s
      file_hash['mor'] =  v[:dest_datastore_spec][:mor].to_s
      file_hash['num_datastores'] =  v[:dest_datastore_spec][:num_datastores].to_s
      file_hash['storage_service'] =  v[:dest_datastore_spec][:storage_service].to_s
      file_hash['thin_provision'] =  v[:dest_datastore_spec][:thin_provision].to_s
      file_hash['vol_auto_grow'] =  v[:dest_datastore_spec][:vol_auto_grow].to_s
      file_hash['wrapper_vol'] =  v[:dest_datastore_spec][:wrapper_vol].to_s
      file_array.push(file_hash)
    }

    $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; file_array.inspect: #{file_array.inspect}")

    return file_array
  end

  #########################
  # Get Source VM Files locations
  ##########################
  @vm_files = getVmFiles(@netapp_url, @servername, @username, @password, "VirtualMachine:#{@vm_ems_ref}")
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_files.inspect: #{@vm_files.inspect}")
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_files.class: #{@vm_files.class}")

  #########################
  # Get VMware object References
  ##########################
  @vm_object = getObjectRef(@netapp_url, @servername, @username, @password, "#{@vm_name}", "VirtualMachine")
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_object: #{@vm_object.inspect}")

  dialog_clone_destination = getObjectRef(@netapp_url, @servername, @username, @password, "#{@vm_v_owning_datacenter}", "Datacenter")
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; dialog_clone_destination: #{dialog_clone_destination}")

  dialog_clone_vm_folder = getObjectRef(@netapp_url, @servername, @username, @password, "templates", "Folder")
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; dialog_clone_destination: #{dialog_clone_destination}")


  #########################
  # Get vars from dialogs
  ##########################
  dialog_clone_name = $evm.root.attributes['dialog_clone_name']

  if $evm.root.attributes['dialog_clone_name'] == 1
    dialog_power_on = 'true'
  else
    dialog_power_on = 'false'
  end

  dialog_destination_folder = $evm.root.attributes['dialog_destination_folder']
  dialog_vm_cpu = $evm.root.attributes['dialog_vm_cpu']
  dialog_memory_size = $evm.root.attributes['dialog_memory_size']

  dialog_number_of_clones = $evm.root.attributes['dialog_number_of_clones']
  dialog_starting_clone_number = $evm.root.attributes['dialog_starting_clone_number']
  dialog_clone_number_increment = $evm.root.attributes['dialog_clone_number_increment']

  #########################
  # Create XML Message for the API
  ##########################
  builder = Nokogiri::XML::Builder.new do |xml|
    xml.arg0 {
      xml.cloneSpec {
        xml.containerMoref "#{dialog_clone_destination.to_s}"
      }
      xml.serviceUrl "https://#{@servername.to_s}/sdk"
      xml.vcPassword "#{@password.to_s}"
      xml.vcUser "#{@username.to_s}"
    }
  end
  puts builder.doc.root.to_xml

  #########################
  # Create Number of Clones entries
  ##########################
  count = 0
  increment = dialog_starting_clone_number.to_i
  while count &lt; dialog_number_of_clones.to_i do
    if dialog_number_of_clones == 1
      clone_name = "#{dialog_clone_name.to_s}"
    else
      clone_name = "#{dialog_clone_name.to_s}#{increment.to_s}"
    end
    clones = Nokogiri::XML::Builder.new do |xml|
      xml.clones {
        xml.entry {
          xml.key "#{clone_name.to_s}"
          xml.value {
            xml.powerOn "#{dialog_power_on.to_s}"
          }
        }
      }
    end
    puts clones.doc.root.to_xml
    builder.doc.root.at('cloneSpec').add_child(clones.doc.root)
    count +=1
    increment += dialog_clone_number_increment.to_i
  end

  @vm_files.each { |k|
    $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; @vm_files.each: #{k.inspect}")

    xml_files = Nokogiri::XML::Builder.new do |xml|
      xml.files {
        xml.destDatastoreSpec {
          xml.controller {
            xml.ipAddress "#{controller_ip.to_s}"
            xml.password "#{controller_password.to_s}"
            xml.ssl "false"
            xml.username "#{controller_username.to_s}"
          }
          xml.mor "#{k['mor'].to_s}"
          xml.numDatastores k['num_datastores'].to_s
          xml.thinProvision k['thin_provision'].to_s
          xml.volAutoGrow k['vol_auto_grow'].to_s
          xml.wrapperVol k['wrapper_vol'].to_s
        }
        xml.sourcePath "#{k['source_path'].to_s}"
      }
    end
    puts xml_files.doc.root.to_xml

    # Add this files section to the the end of cloneSpec
    builder.doc.root.at('cloneSpec').add_child(xml_files.doc.root)
  }

  unless dialog_destination_folder.nil?
    # Add Destination Folder to the the end of cloneSpec
    destVmFolderMoref = Nokogiri::XML::Builder.new do |xml|
      xml.destVmFolderMoref "Folder:#{dialog_destination_folder.to_s}"
    end
    builder.doc.root.at('cloneSpec').add_child(destVmFolderMoref.doc.root)
  end

  # Add numberCPU to the the end of cloneSpec
  numberCPU = Nokogiri::XML::Builder.new do |xml|
    xml.numberCPU dialog_vm_cpu.to_s
  end
  builder.doc.root.at('cloneSpec').add_child(numberCPU.doc.root)

  # Add Memory to the the end of cloneSpec
  memMB = Nokogiri::XML::Builder.new do |xml|
    xml.memMB dialog_memory_size.to_s
  end
  builder.doc.root.at('cloneSpec').add_child(memMB.doc.root)

  # Add templateMoref to the the end of cloneSpec
  templateMoref = Nokogiri::XML::Builder.new do |xml|
    xml.templateMoref "#{@vm_object.to_s}"
  end
  builder.doc.root.at('cloneSpec').add_child(templateMoref.doc.root)

  #########################
  # Setup client connection to API
  ##########################
  client = Savon::Client.new do |wsdl, http, wsse|
    wsdl.document = "#{@netapp_url}"
    wsdl.endpoint = "#{@netapp_url}"
    http.auth.ssl.verify_mode = :none
  end

  #########################
  # Send message to API
  ##########################
  response = client.request "ser:createClones" do
    soap.namespaces.merge!({
                               "xmlns:soapenv" =&gt; "http://schemas.xmlsoap.org/soap/envelope/",
                               "xmlns:ser" =&gt; "http://server.kamino.netapp.com/"
                           })
    soap.header = {}
    soap.body = builder.doc.root.to_xml
  end

  #########################
  # Convert response to hash
  ##########################
  response_hash = response.to_hash
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; #{response_hash.inspect}")

  #
  # Exit method
  #
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; Ended")
  exit MIQ_OK

    #
    # Set Ruby rescue behavior
    #
rescue =&gt; err
  $evm.log("error", "&lt;#{@method}&gt;: [#{err}]\n#{err.backtrace.join("\n")}")
  exit MIQ_STOP
end]]&gt;    &lt;/MiqAeMethod&gt;
    &lt;MiqAeMethod name="GetVMinfo" language="ruby" scope="instance" location="inline"&gt;&lt;![CDATA[###################################
#
# EVM Automate Method: GetVMinfo
#
# Notes: Dump the objects in storage to the automation.log
#
###################################
begin
  @method = 'GetVMinfo'
  $evm.log("info", "#{@method} - EVM Automate Method Started")

  #########################
  # add required gems
  ##########################
  require 'savon'
  require 'nokogiri'
  require 'httpclient'
  HTTPI.adapter = :httpclient

  # Turn of verbose logging
  @debug = true

  @servername = nil
  @servername ||= $evm.object['servername']

  @username = nil
  @username ||= $evm.object['username']

  @password = nil
  @password ||= $evm.object.decrypt('password')

  controller_ip = nil
  controller_ip ||= $evm.object['controller_ip']

  controller_username = nil
  controller_username ||= $evm.object['controller_username']

  controller_password = nil
  controller_password ||= $evm.object.decrypt('controller_password')

  @netapp_url = "https://#{@servername.to_s}:8143/kamino/public/api?wsdl"

  vm = $evm.root['vm']

  @vm_name = vm.attributes['name']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_name: #{@vm_name}")


  @vm_location = vm.attributes['location']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_location: #{@vm_location}")


  @vm_vendor = vm.attributes['vendor']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_vendor: #{@vm_vendor}")


  @vm_host_id = vm.attributes['host_id']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_host_id: #{@vm_host_id}")


  @vm_ems_ref = vm.attributes['ems_ref']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_ems_ref: #{@vm_ems_ref}")


  @vm_type = vm.attributes['type']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_type: #{@vm_type}")


  @vm_memory_cpu = vm.hardware['memory_cpu']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_memory_cpu: #{@vm_memory_cpu}")


  @vm_numvcpus = vm.hardware['numvcpus']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_numvcpus: #{@vm_numvcpus}")


  @vm_storage_name = vm.storage['name']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_storage_name: #{@vm_storage_name}")


  @vm_storage_ems_ref = vm.storage['ems_ref']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_storage_ems_ref: #{@vm_storage_ems_ref}")


  @vm_v_ems_cluster_name = vm.ems_cluster_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_ems_cluster_name: #{@vm_v_ems_cluster_name}")


  @vm_v_parent_blue_folder_1_name = vm.parent_blue_folder_1_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_1_name: #{@vm_v_parent_blue_folder_1_name}")


  @vm_v_parent_blue_folder_2_name = vm.parent_blue_folder_2_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_2_name: #{@vm_v_parent_blue_folder_2_name}")


  @vm_v_parent_blue_folder_3_name = vm.parent_blue_folder_3_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_3_name: #{@vm_v_parent_blue_folder_3_name}")


  @vm_v_parent_blue_folder_4_name = vm.parent_blue_folder_4_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_4_name: #{@vm_v_parent_blue_folder_4_name}")


  @vm_v_parent_blue_folder_5_name = vm.parent_blue_folder_5_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_5_name: #{@vm_v_parent_blue_folder_5_name}")


  @vm_v_parent_blue_folder_6_name = vm.parent_blue_folder_6_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_6_name: #{@vm_v_parent_blue_folder_6_name}")


  @vm_v_parent_blue_folder_7_name = vm.parent_blue_folder_7_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_7_name: #{@vm_v_parent_blue_folder_7_name}")


  @vm_v_parent_blue_folder_8_name = vm.parent_blue_folder_8_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_8_name: #{@vm_v_parent_blue_folder_8_name}")


  @vm_v_parent_blue_folder_9_name = vm.parent_blue_folder_9_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_parent_blue_folder_9_name: #{@vm_v_parent_blue_folder_9_name}")


  @vm_v_storage_name = vm.storage_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_v_storage_name: #{@vm_v_storage_name}")


  dialog_vm_snapshots = {}
  if vm.v_total_snapshots &gt; 0
    vm.snapshots.each do |ss|
      dialog_vm_snapshots[ss.ems_ref] = "#{ss.name}"
    end
    $evm.log("info","========= VM Snapshot Name: #{dialog_vm_snapshots.inspect}")
  end


  #########################
  # Method: getObjectRef
  # Query the NetApp API with real object name to get VMware Object Reference Names
  ##########################
  def getVmFiles(netapp_url, servername, username, password, arg_name)
    #########################
    # Savon Configuration
    ##########################
#    Savon.configure do |config|
#      config.log = false
#      config.log_level = :info
#      config.pretty_print_xml = true
#    end

    client = Savon::Client.new do |wsdl, http, wsse|
      wsdl.document = "#{netapp_url}"
      wsdl.endpoint = "#{netapp_url}"
      http.auth.ssl.verify_mode = :none
    end
    response = client.request "ser:getVmFiles" do
      soap.namespaces.merge!({
                                 "xmlns:soapenv" =&gt; "http://schemas.xmlsoap.org/soap/envelope/",
                                 "xmlns:ser" =&gt; "http://server.kamino.netapp.com/"
                             })
      soap.header = {}
      soap.body = { 'arg0' =&gt; "#{arg_name}", 'arg1' =&gt; { 'serviceUrl' =&gt; "https://#{servername.to_s}/sdk", 'vcPassword' =&gt; "#{password.to_s}", 'vcUser' =&gt; "#{username.to_s}" } }
    end

    $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; response.to_hash.inspect: #{response.to_hash.inspect}")

    response_hash = response.to_hash[:get_vm_files_response]
    $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; response_hash.inspect: #{response_hash.inspect}")

    ret_obj = "#{response_hash[:return]}"
    $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; ret_obj.inspect: #{ret_obj.inspect}")

    $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; ret_obj.class: #{ret_obj.class}")

    file_array = []
    file_hash = {}
    response_hash[:return].each { |k|
      source_path = k[:source_path].to_s
      file_hash['source_path'] = source_path
      $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; k[:source_path].inspect: #{k[:source_path].inspect}")

      mor = k[:dest_datastore_spec][:mor].to_s
      file_hash['mor'] = mor
      $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; k[:dest_datastore_spec][:mor].inspect: #{k[:dest_datastore_spec][:mor].inspect}")
      file_array &lt;&lt; file_hash
    }

    return file_array
    #puts ref_obj
    #return ref_obj
  end

  #########################
  # Get VMware object References
  ##########################
  @vm_files = getVmFiles(@netapp_url, @servername, @username, @password, "VirtualMachine:#{@vm_ems_ref}")
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_files: #{@vm_files.inspect}")

  #
  # Exit method
  #
  $evm.log("info", "#{@method} - EVM Automate Method Ended")
  exit MIQ_OK

    #
    # Set Ruby rescue behavior
    #
rescue =&gt; err
  $evm.log("error", "#{@method} - [#{err}]\n#{err.backtrace.join("\n")}")
  exit MIQ_ABORT
end]]&gt;    &lt;/MiqAeMethod&gt;
    &lt;MiqAeMethod name="Retrieve_Clone_Source" language="ruby" scope="instance" location="inline"&gt;&lt;![CDATA[###################################
#
# EVM Automate Method: Retrieve_Clone_Source
#
# Notes: Populate Clone Source
#
###################################
begin
  # Turn of verbose logging
  @debug = true

  @action = nil
  @action ||= $evm.object['action']

  @method = 'Retrieve_Clone_Source'
  $evm.log("info", "#{@method}: #{@action} - EVM Automate Method Started")

  vm = $evm.root['vm']

  @vm_name = vm.attributes['name']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt;: #{@action} vm_name: #{@vm_name}")

  @vm_ems_ref = vm.attributes['ems_ref']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt;: #{@action} vm_ems_ref: #{@vm_ems_ref}")

  @vm_location = vm.attributes['location']
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt;: #{@action} vm_location: #{@vm_location}")

  @vm_v_storage_name = vm.storage_name
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt;: #{@action} vm_v_storage_name: #{@vm_v_storage_name}")

  dialog_clone_source = "VirtualMachine:#{@vm_ems_ref}"
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt;: #{@action} dialog_clone_source: #{dialog_clone_source}")

  dialog_clone_source_path = "[#{@vm_v_storage_name}]#{@vm_location}"
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt;: #{@action} dialog_clone_source_path: #{dialog_clone_source_path}")

  case @action
    when "clone_source"
      list_values = {
          'sort_by' =&gt; :none,
          'data_type' =&gt; :string,
          'required' =&gt; :true,
          'values' =&gt; [[nil,nil],["#{@vm_name}", "#{dialog_clone_source}"]],
      }

      $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt;: #{@action} display drop-down: #{list_values}")
      list_values.each {|k,v| $evm.object[k] = v }

    when "clone_source_path"
      list_values = {
          'sort_by' =&gt; :none,
          'data_type' =&gt; :string,
          'required' =&gt; :true,
          'values' =&gt; [[nil,nil],["#{dialog_clone_source_path}", "#{dialog_clone_source_path}"]],
      }
      $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt;: #{@action} display drop-down: #{list_values}")
      list_values.each {|k,v| $evm.object[k] = v }

  end

  #
  # Exit method
  #
  $evm.log("info", "#{@method} - EVM Automate Method Ended")
  exit MIQ_OK

    #
    # Set Ruby rescue behavior
    #
rescue =&gt; err
  $evm.log("error", "#{@method} - [#{err}]\n#{err.backtrace.join("\n")}")
  exit MIQ_ABORT
end]]&gt;    &lt;/MiqAeMethod&gt;
    &lt;MiqAeMethod name="Retrieve_Object" language="ruby" scope="instance" location="inline"&gt;&lt;![CDATA[###################################
#
# EVM Automate Method: Execute_Rapid_Clone
#
#
#
###################################
begin
  @method = 'Execute_Rapid_Clone'
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; Started")

  #########################
  #
  # Method: dumpRoot
  # Description: Dump Root information
  #
  ##########################
  def dumpRoot
    $evm.log("info", "#{@method} - Root:&lt;$evm.root&gt; Begin Attributes")
    $evm.root.attributes.sort.each { |k, v| $evm.log("info", "#{@method} - Root:&lt;$evm.root&gt; Attributes - #{k}: #{v}")}
    $evm.log("info", "#{@method} - Root:&lt;$evm.root&gt; End Attributes")
    $evm.log("info", "")
  end

  # dump root object attributes
  dumpRoot

  require 'savon'
  require 'httpclient'
  HTTPI.adapter = :httpclient
  HTTPI.log = false

  @servername = 'mcimgmt1.mcis.usmc.mil'
  @username = 'MCIS\jose'
  @password = 'Password1234!@#$'

  def getObjectRef(servername, username, password, arg_name, arg_type)
    Savon.configure do |config|
      config.log = false
      config.log_level = :info
      config.pretty_print_xml = true
    end

    client = Savon::Client.new do |wsdl, http, wsse|
      wsdl.document = "https://#{@servername.to_s}:8143/kamino/public/api?wsdl"
      wsdl.endpoint = "https://#{@servername.to_s}:8143/kamino/public/api?wsdl"
      http.auth.ssl.verify_mode = :none
    end

    response = client.request "ser:getMoref" do
      soap.namespaces.merge!({
         "xmlns:soapenv" =&gt; "http://schemas.xmlsoap.org/soap/envelope/",
         "xmlns:ser" =&gt; "http://server.kamino.netapp.com/"
      })
      soap.header = {}
      soap.body = { 'arg0' =&gt; "#{arg_name}", 'arg1' =&gt; "#{arg_type}", 'arg2' =&gt; { 'serviceUrl' =&gt; "https://#{servername.to_s}/sdk", 'vcPassword' =&gt; "#{password.to_s}", 'vcUser' =&gt; "#{username.to_s}" } }
    end

    response_hash = response.to_hash[:get_moref_response]

    ref_obj = "#{response_hash[:return]}"

    return ref_obj
  end

  vm_object = getObjectRef(@servername, @username, @password, "w2k8r2-jump-template-20140506", "VirtualMachine")
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; vm_object: #{vm_object.inspect}")

  #
  # Exit method
  #
  $evm.log("info", "===== EVM Automate Method: &lt;#{@method}&gt; Ended")
  exit MIQ_OK

    #
    # Set Ruby rescue behavior
    #
rescue =&gt; err
  $evm.log("error", "&lt;#{@method}&gt;: [#{err}]\n#{err.backtrace.join("\n")}")
  exit MIQ_STOP
end]]&gt;    &lt;/MiqAeMethod&gt;
    &lt;MiqAeSchema&gt;
      &lt;MiqAeField name="servername" substitute="true" aetype="attribute" datatype="string" priority="1" message="create"&gt;
mcimgmt1.mcis.usmc.mil      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username" substitute="true" aetype="attribute" datatype="string" priority="2" message="create"&gt;
MCIS\jose      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password" substitute="true" aetype="attribute" datatype="password" priority="3" message="create"&gt;
v1:{+YT9r2mlxaPyr4RY+dWrlN3HuBkVZ3ePnvGDT48NTsE=}      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_ip" substitute="true" aetype="attribute" datatype="string" priority="4" message="create"&gt;
10.2.100.19      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_username" substitute="true" aetype="attribute" datatype="string" priority="5" message="create"&gt;
vsc.netapp.svc      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_password" substitute="true" aetype="attribute" datatype="password" priority="6" message="create"&gt;
v1:{dbXYedjKxZEGfxtiGNbFgciiC1YEyCca1wR3X8FkC0c=}      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action" substitute="true" aetype="attribute" datatype="string" priority="7" message="create"&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1" substitute="true" aetype="method" datatype="string" priority="8" message="create"&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2" substitute="true" aetype="method" datatype="string" priority="9" message="create"&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeSchema&gt;
    &lt;MiqAeInstance name="Dialog_Destination_Folder"&gt;
      &lt;MiqAeField name="servername"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_ip"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1"&gt;
Dialog_Destination_Folder      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
    &lt;MiqAeInstance name="Dialog_Storage_Controller"&gt;
      &lt;MiqAeField name="servername"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_ip"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1"&gt;
Dialog_Storage_Controller      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
    &lt;MiqAeInstance name="Dialog_VM_Sizing_CPU"&gt;
      &lt;MiqAeField name="servername"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_ip"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action"&gt;
cpu      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1"&gt;
Dialog_VM_Sizing      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
    &lt;MiqAeInstance name="Dialog_VM_Sizing_Memory"&gt;
      &lt;MiqAeField name="servername"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_ip"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action"&gt;
memory      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1"&gt;
Dialog_VM_Sizing      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
    &lt;MiqAeInstance name="Execute_Rapid_Clone"&gt;
      &lt;MiqAeField name="servername"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1"&gt;
Execute_Rapid_Clone      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
    &lt;MiqAeInstance name="GetVMinfo"&gt;
      &lt;MiqAeField name="servername"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_ip"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1"&gt;
GetVMinfo      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
    &lt;MiqAeInstance name="Rapid_Clone_Email_Complete"&gt;
      &lt;MiqAeField name="servername"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_ip"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="controller_password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1"&gt;
Rapid_Clone_Email_Complete      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
    &lt;MiqAeInstance name="Retrieve_Storage_Controller"&gt;
      &lt;MiqAeField name="servername"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="username"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="password"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="action"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method1"&gt;
Retrieve_Storage_Controller      &lt;/MiqAeField&gt;
      &lt;MiqAeField name="method2"&gt;
        &lt;![CDATA[]]&gt;
      &lt;/MiqAeField&gt;
    &lt;/MiqAeInstance&gt;
  &lt;/MiqAeClass&gt;
&lt;/MiqAeDatastore&gt;</pre></div></div></div></div></body></html>
